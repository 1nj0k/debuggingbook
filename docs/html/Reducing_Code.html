<!-- A html document -->
<!-- 
with standard nbconvert css layout
with standard nbconvert input/output content
standard html tag wrapping
with mathjax loaded
with jupyter wigets
 caption and label elements according to ipub meta tags  
with fuzzingbook adaptations -->None
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /><title>Second Project - The Debugging Book</title>

<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
    </style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true }
    }
});
</script>
<!-- End of mathjax configuration --><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<!--[if IE lte 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<style type="text/css">
.ipyfigure { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipyfigure>div { flex:1; }
.ipytable { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipytable>div { flex:1; }

</style>

<link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,500,700|Raleway:300|Source+Code+Pro|Open+Sans' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<meta property="og:url" content="https://www.debuggingbook.org/html/Reducing_Code.html" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Second Project - The Debugging Book" />
<meta property="og:description" content="In this project, you will implement a debugging reducer able to reduce a Python program containing a specific property down to a syntactically correct Python program that only contains said property.To do this, you will be given several Python parsers checking for specific properties as well as Python programs containing these properties.The time frame for this project is 2 weeks, and the Deadline is January 15th 23:59." />
<meta property="og:image" content="https://www.debuggingbook.org/html/PICS/wordcloud.png" />

<meta name="twitter:dnt" content="on">

<link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon.png">

<meta name="msapplication-TileColor" content="#B03A2E">
<meta name="msapplication-config" content="favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">

<meta name="viewport" content="width=device-width, initial-scale=1"></head>
 <body>

    <script>
    var close_menus = function() {
        /* doesn't work yet - AZ
        console.log("Closing menus")
        var cssmenu = document.getElementById("cssmenu")
        var all_items = cssmenu.getElementsByTagName("li");
        var i;
        for (i = 0; i < all_items.length; i++) {
            item = all_items[i];
            // console.log("<li>: ")
            // console.log(item.innerHTML);
            var j;
            var all_ul = item.getElementsByTagName("ul");
            for (j = 0; j < all_ul.length; j++) {
                console.log("<ul>: ")
                console.log(all_ul[j].innerHTML);
                all_ul[j].style.display = "none";
            }
            var all_ol = item.getElementsByTagName("ol");
            for (j = 0; j < all_ol.length; j++) {
                console.log("<ol>: ")
                console.log(all_ol[j].innerHTML);
                all_ol[j].style.display = "none";
            }
        }
        */
    };

    $( document ).ready( close_menus );

    // Let navbar fade away when scrolling down
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
        var currentScrollPos = window.pageYOffset;
        if (currentScrollPos > 10 && currentScrollPos > prevScrollpos) {
            // Hide navbar
            var cssmenu = document.getElementById("cssmenu")
            cssmenu.style.opacity = 0;

            // When scrolling, also close all sub-menus
            close_menus();
        }
        else {
            // Make navbar visible
            document.getElementById("cssmenu").style.opacity = 1;
        }
        prevScrollpos = currentScrollPos;
    };
    </script>
    
<nav>
<div id="cssmenu">
  <ul>
     <li class="has-sub"><a href="#"><span title="The Debugging Book"><i class="fa fa-fw fa-bars"></i> </span><span class="menu_1">The Debugging Book</span></a>
        <ol>
           
<li><a href="https://www.debuggingbook.org/"><span class="part_number"><i class="fa fa-fw fa-home"></i></span> About this book</a></li>
<li><a href="https://www.debuggingbook.org/html/00_Table_of_Contents.html"><i class="fa fa-fw fa-sitemap"></i></span> Sitemap</a></li>
<li class="has-sub"><a href="01_Intro.html" class="chapters"><span class="part_number">I</span> Whetting Your Appetite <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tours.html">Tours through the Book</a></li>
<li><a href="Intro_Debugging.html">Introduction to Debugging</a></li>
</ul><li class="has-sub"><a href="02_Observing.html" class="chapters"><span class="part_number">II</span> Observing Executions <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracer.html">Tracing Executions</a></li>
<li><a href="Debugger.html">How Debuggers Work</a></li>
<li><a href="Assertions.html">Asserting Expectations</a></li>
</ul><li class="has-sub"><a href="03_Dependencies.html" class="chapters"><span class="part_number">III</span> Flows and Dependencies <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Slicer.html">Tracking Failure Origins</a></li>
</ul><li class="has-sub"><a href="04_Reducing.html" class="chapters"><span class="part_number">IV</span> Reducing Failure Causes <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="DeltaDebugger.html">Reducing Failure-Inducing Inputs</a></li>
<li><a href="ChangeDebugger.html">Isolating Failure-Inducing Changes</a></li>
</ul><li class="has-sub"><a href="05_Abstracting.html" class="chapters"><span class="part_number">V</span> Abstracting Failures <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="StatisticalDebugger.html">Statistical Debugging</a></li>
<li><a href="DynamicInvariants.html">Mining Function Specifications</a></li>
<li><a href="DDSetDebugger.html">Generalizing Failure Circumstances</a></li>
<li><a href="PerformanceDebugger.html">Debugging Performance Issues</a></li>
</ul><li class="has-sub"><a href="06_Repairing.html" class="chapters"><span class="part_number">VI</span> Automatic Repair <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Repairer.html">Repairing Code Automatically</a></li>
</ul><li class="has-sub"><a href="07_In_the_Large.html" class="chapters"><span class="part_number">VII</span> Debugging in the Large <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracking.html">Tracking Bugs</a></li>
<li><a href="ChangeCounter.html">Where the Bugs are <strong class="new_chapter">&bull;</strong></a></li>
</ul><li class="has-sub"><a href="99_Appendices.html" class="chapters">Appendices <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="ExpectError.html">Error Handling</a></li>
<li><a href="Timer.html">Timer</a></li>
<li><a href="ClassDiagram.html">Class Diagrams</a></li>
<li><a href="StackInspector.html">Inspecting Call Stacks</a></li>
</ul>
           <li><a href="https://www.debuggingbook.org/html/00_Index.html">Index (beta)</a></i></li>
        </ol>
     </li>
     <li class="has-sub"><a href="#"><span title="Second Project"><i class="fa fa-fw fa-list-ul"></i></span> <span class="menu_2">Second Project</span></a>
           <ul><li class="has-sub"><a href="#Description">&nbsp;&bull;&nbsp;&nbsp; Description</a>
<ul><li class="has-sub"><a href="#Parsing-Python--">Parsing Python  </a>
</li><li class="has-sub"><a href="#Reducing-Python">Reducing Python</a>
</li><li class="has-sub"><a href="#Implementing-a-Reducing-Debugger">Implementing a Reducing Debugger</a>
</ul></li><li class="has-sub"><a href="#Implementation">&nbsp;&bull;&nbsp;&nbsp; Implementation</a>
</li><li class="has-sub"><a href="#Evaluation">&nbsp;&bull;&nbsp;&nbsp; Evaluation</a>
<ul><li class="has-sub"><a href="#Parsers">Parsers</a>
</li><li class="has-sub"><a href="#Input-Programs">Input Programs</a>
</li><li class="has-sub"><a href="#Testing-Infrastructure">Testing Infrastructure</a>
</ul></li><li class="has-sub"><a href="#Grading">&nbsp;&bull;&nbsp;&nbsp; Grading</a>
<ul><li class="has-sub"><a href="#Must-have-Features">Must-have Features</a>
</li><li class="has-sub"><a href="#May-have-Features">May-have Features</a>
</ul></li></ul></li>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Resources"><i class="fa fa-fw fa-cube"></i> </span><span class="menu_3">Resources</span></a>
     <ul>
     <li><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/notebooks/Reducing_Code.ipynb" target="_blank" class="edit_as_notebook"><i class="fa fa-fw fa-edit"></i> Edit as Notebook</a></li>
     <li><a href="https://www.debuggingbook.org/slides/Reducing_Code.slides.html" target="_blank"><i class="fa fa-fw fa-video-camera"></i> View Slides</a></li>
     <li><a href="https://www.debuggingbook.org/code/Reducing_Code.py"><i class="fa fa-fw fa-download"></i> Download Code (.py)</a></li>
     <li><a href="https://www.debuggingbook.org/notebooks/Reducing_Code.ipynb"><i class="fa fa-fw fa-download"></i> Download Notebook (.ipynb)</a></li>
     <li><a href="https://www.debuggingbook.org/dist/debuggingbook-code.zip"><i class="fa fa-fw fa-cube"></i> All Code (.zip)</a></li>
     <li><a href="https://www.debuggingbook.org/dist/debuggingbook-notebooks.zip"><i class="fa fa-fw fa-cube"></i> All Notebooks (.zip)</a></li>
     <li><a href="https://github.com/uds-se/debuggingbook/" target="_blank"><i class="fa fa-fw fa-github"></i> Project Page</a></li>
     <li><a href="ReleaseNotes.html" target="_blank"><i class="fa fa-fw fa-calendar"></i> Release Notes</a></li>
     </ul>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Share"><i class="fa fa-fw fa-comments"></i> </span> <span class="menu_4">Share</span></a>
        <ul>
            <li><a href="https://twitter.com/intent/tweet?text=I%20just%20read%20%22Second%20Project%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fReducing_Code.html" target="popup" 
onclick="window.open('https://twitter.com/intent/tweet?text=I%20just%20read%20%22Second%20Project%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fReducing_Code.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-twitter"></i> Share on Twitter</a>
            <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fReducing_Code.html" target="popup" 
onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fReducing_Code.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-facebook"></i> Share on Facebook</a>
            <li><a href="mailto:?subject=Second%20Project&body=I%20just%20read%20%22Second%20Project%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fhtml%2fReducing_Code.html"><i class="fa fa-fw fa-envelope"></i> Share by Email</a>
            <li><a href="#citation" id="cite" onclick="revealCitation()"><i class="fa fa-fw fa-mortar-board"></i> Cite</a>
        </ul>
     </li>
     <li class="has-sub"><a href="#"><span title="Help"><i class="fa fa-fw fa-question-circle"></i></span> <span class="menu_5">Help</span></a>
        <ul>
          <li><a href="https://www.debuggingbook.org/#Troubleshooting"><i class="fa fa-fw fa-wrench"></i> Troubleshooting</a></li>
          <li><a href="https://docs.python.org/3/tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Python Tutorial</a>
          <li><a href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Jupyter Notebook Tutorial</a>
          <li><a href="https://github.com/uds-se/debuggingbook/issues/" target="_blank"><i class="fa fa-fw fa-commenting"></i> Report an Issue</a></li>
        </ul>
     </li>
  </ul>
</div>
</nav>

    <article>
   <div tabindex="-1" id="notebook" class="border-box-sizing">
     <div class="container" id="notebook-container">

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="Second-Project">Second Project<a class="anchor-link" href="#Second-Project">&#182;</a></h1></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In this project, you will implement a debugging reducer able to reduce a Python program containing a specific property down to a syntactically correct Python program that <em>only</em> contains said property.
To do this, you will be given several Python parsers checking for specific properties as well as Python programs containing these properties.</p>
<p>The time frame for this project is <strong>2 weeks</strong>, and the Deadline is <strong>January 15th 23:59</strong>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/inspect.html" class="import" target="_blank">inspect</a></span>
<span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/ast.html" class="import" target="_blank">ast</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">show_ast</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="ExpectError.html" class="import" target="_blank">ExpectError</a></span> <span class="kn">import</span> <span class="n">ExpectError</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Description">Description<a class="anchor-link" href="#Description">&#182;</a></h2><p>Imagine we want to create a new compiler for Python programs which transforms the code into a binary executable.
To this end, at first we need to implement a parser that parses a given program into a set of individual statements which can then be converted to the bytecode.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Parsing-Python">Parsing Python<a class="anchor-link" href="#Parsing-Python">&#182;</a></h3><p>If we want to parse a programming language like Python, it makes sense to parse the code into an abstract syntax tree (AST) and work with the AST from this point onward.
The reason we might want to do this, is to preserve the syntactic integrity of our program.
Let's start with parsing a simple Python function (<code>foo</code>) into an AST using <code>ast.parse()</code> and printing it.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>  
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether a and b are true</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We take a string representation of <code>foo()</code>...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>def foo(a, b):    # type: ignore
    &#34;&#34;&#34;
    Checks whether a and b are true
    &#34;&#34;&#34;
    if a and b:
        return 1
    return 0
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>...and convert it to the AST:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source_ast</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="n">show_ast</span><span class="p">(</span><span class="n">source_ast</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="524pt" height="332pt" viewBox="0.00 0.00 524.00 332.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 328)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-328 520,-328 520,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="163.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">FunctionDef</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="44" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;foo&quot;</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M208,-287C208,-287 137.35,-271.35 83,-252 79.94,-250.91 76.78,-249.69 73.64,-248.42"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="start" x="100" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arguments</text>
</g>
<!-- 0&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>0--2</title>
<path fill="none" stroke="black" d="M208,-287C208,-287 181.34,-267.19 160.92,-252.03"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="start" x="234.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 0&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>0--7</title>
<path fill="none" stroke="black" d="M208,-287C208,-287 221.33,-267.19 231.54,-252.03"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="start" x="371.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 0&#45;&#45;19 -->
<g id="edge19" class="edge">
<title>0--19</title>
<path fill="none" stroke="black" d="M208,-287C208,-287 308.85,-259.25 363.21,-244.3"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="start" x="27" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>2--3</title>
<path fill="none" stroke="black" d="M124,-215C124,-215 91.6,-194.94 67.04,-179.74"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="start" x="99" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>2--5</title>
<path fill="none" stroke="black" d="M124,-215C124,-215 119.43,-195.19 115.93,-180.03"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="27" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;a&quot;</text>
</g>
<!-- 3&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>3--4</title>
<path fill="none" stroke="black" d="M36.79,-143.7C34.77,-132.85 32.18,-118.92 30.18,-108.1"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="99" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;b&quot;</text>
</g>
<!-- 5&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>5--6</title>
<path fill="none" stroke="black" d="M108.79,-143.7C106.77,-132.85 104.18,-118.92 102.18,-108.1"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="start" x="217.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 7&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>7--8</title>
<path fill="none" stroke="black" d="M253,-215C253,-215 249.19,-195.19 246.27,-180.03"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="start" x="335.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 7&#45;&#45;16 -->
<g id="edge16" class="edge">
<title>7--16</title>
<path fill="none" stroke="black" d="M253,-215C253,-215 295.72,-194.43 327.42,-179.17"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="171" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 8&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>8--9</title>
<path fill="none" stroke="black" d="M243,-143C243,-143 215.57,-123.19 194.58,-108.03"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="start" x="226" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 8&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>8--10</title>
<path fill="none" stroke="black" d="M243,-143C243,-143 243,-123.19 243,-108.03"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="start" x="298" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 8&#45;&#45;13 -->
<g id="edge13" class="edge">
<title>8--13</title>
<path fill="none" stroke="black" d="M243,-143C243,-143 270.43,-123.19 291.42,-108.03"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="171" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;a&quot;</text>
</g>
<!-- 10&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>10--11</title>
<path fill="none" stroke="black" d="M235,-71C235,-71 210.62,-51.19 191.96,-36.03"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="243" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 10&#45;&#45;12 -->
<g id="edge12" class="edge">
<title>10--12</title>
<path fill="none" stroke="black" d="M235,-71C235,-71 238.05,-51.19 240.38,-36.03"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="315" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;b&quot;</text>
</g>
<!-- 13&#45;&#45;14 -->
<g id="edge14" class="edge">
<title>13--14</title>
<path fill="none" stroke="black" d="M323,-71C323,-71 319.95,-51.19 317.62,-36.03"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="387" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 13&#45;&#45;15 -->
<g id="edge15" class="edge">
<title>13--15</title>
<path fill="none" stroke="black" d="M323,-71C323,-71 347.38,-51.19 366.04,-36.03"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="start" x="368" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 16&#45;&#45;17 -->
<g id="edge17" class="edge">
<title>16--17</title>
<path fill="none" stroke="black" d="M371.13,-143.7C377.49,-132.85 385.65,-118.92 391.98,-108.1"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="459" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">1</text>
</g>
<!-- 17&#45;&#45;18 -->
<g id="edge18" class="edge">
<title>17--18</title>
<path fill="none" stroke="black" d="M416.09,-71.7C424.93,-60.85 436.27,-46.92 445.07,-36.1"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="start" x="438" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 19&#45;&#45;20 -->
<g id="edge20" class="edge">
<title>19--20</title>
<path fill="none" stroke="black" d="M415.54,-215.7C427.16,-204.85 442.09,-190.92 453.67,-180.1"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="middle" x="489" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">0</text>
</g>
<!-- 20&#45;&#45;21 -->
<g id="edge21" class="edge">
<title>20--21</title>
<path fill="none" stroke="black" d="M476.2,-143.7C478.84,-132.85 482.22,-118.92 484.85,-108.1"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can see how the code is structured by inspecting the AST shown above.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To learn the structure of an AST, have a look at the <a href="http://docs.python.org/3/library/ast">official Python <code>ast</code> reference</a> for a list of AST nodes and their attributes.
This reference is complete, but a bit terse; the <a href="https://greentreesnakes.readthedocs.io/en/latest/manipulating.html">"Green Tree Snakes missing Python AST docs"</a> provide a good manual on how to modify the tree.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we want to inspect certain elements of the source code, we can now use the <code>ast.NodeVisitor</code> to visit every node in the AST.
This can be done by extending this class and implementing <em>visit-methods</em> for each type of node in the tree we want to inspect.<br>
So, let's implement a parser that first parses the source code into an AST and then visits each node one after another.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SimpleParser</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple parser printing all nodes in order</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        When the parse function is called, we parse the source code</span>
<span class="sd">        into a tree and then start visiting all nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_FunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Return</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">arg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_BoolOp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">BoolOp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Using this <code>SimpleParser</code>, we can visit each node and print the node object itself.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SimpleParser</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;ast.FunctionDef object at 0x1056e7dc0&gt;
&lt;ast.arguments object at 0x1056e7d90&gt;
&lt;ast.arg object at 0x1056e7d60&gt;
&lt;ast.arg object at 0x1056e7d30&gt;
&lt;ast.Constant object at 0x1056e7e50&gt;
&lt;ast.If object at 0x1056e7e20&gt;
&lt;ast.BoolOp object at 0x1056e7eb0&gt;
&lt;ast.Name object at 0x1056e7df0&gt;
&lt;ast.Name object at 0x1056e7070&gt;
&lt;ast.Return object at 0x1056e7c40&gt;
&lt;ast.Constant object at 0x1056e7c10&gt;
&lt;ast.Return object at 0x1056e7bb0&gt;
&lt;ast.Constant object at 0x1056e7fd0&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now imagine, instead of just parsing the input and printing each node, we start to process the information present in each node.
To notify the user if anything breaks, we introduce a <code>ParserException</code> that is thrown when we encounter a parsing error.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ParserException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For instance, let's consider our parser has troubles processing boolean operators.
We simulate this behavior by extending our parser to throw an exception whenever it encounters a <code>BoolOp</code> node.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SimpleParserPlus</span><span class="p">(</span><span class="n">SimpleParser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple parser printing all nodes in order until it reaches a BoolOp</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">visit_BoolOp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">BoolOp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If a BoolOp is encountered, we throw an exception</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">ParserException</span><span class="p">(</span><span class="s2">&quot;Something went wrong&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">SimpleParserPlus</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;ast.FunctionDef object at 0x1056e7c10&gt;
&lt;ast.arguments object at 0x1056e7f70&gt;
&lt;ast.arg object at 0x1056e7b80&gt;
&lt;ast.arg object at 0x1056e7760&gt;
&lt;ast.Constant object at 0x1056e78e0&gt;
&lt;ast.If object at 0x1056e7340&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/257518062.py&#34;, line 2, in &lt;module&gt;
    SimpleParserPlus().parse(source)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2922974276.py&#34;, line 12, in parse
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2922974276.py&#34;, line 16, in visit_FunctionDef
    self.generic_visit(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2922974276.py&#34;, line 24, in visit_If
    self.generic_visit(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1656391407.py&#34;, line 10, in visit_BoolOp
    raise ParserException(&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As we can see here, as soon as we encounter a boolean operation, an exception is thrown.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Reducing-Python">Reducing Python<a class="anchor-link" href="#Reducing-Python">&#182;</a></h3><p>Let's get back to our <code>SimpleParserPlus</code> example. This parser parses Python code into an AST and then iterates over all nodes. When it reaches a boolean operation, it encounters an error and crashes.<br>
Of course our example is a very small and artificial one. Furthermore, the input triggering our bug is rather small as well.
However, in reality a similar situation might present itself to you but with a far less obvious error and a far larger input that causes it.
In this case, instead of using the entire input, one might want to reduce the input down to only those parts actually causing the error.<br>
But how do we do that?<br>
We could, for instance, randomly remove some parts of the program.
However, this would likely produce syntactically invalid Python code and hence prevent the parser from reaching the desired code location.
So instead of just removing random parts of the code itself, we will manipulate the AST to preserve the correct syntax.</p>
<p>How do we manipulate an AST produced by <code>ast.parse</code>? We can make use of the <code>ast.NodeTransformer</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeReducer</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">NodeTransformer</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">visit_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instead of the `if` node return just its condition</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Apply other transformations to the children first</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># We create an expression around the node test</span>
        <span class="n">new_node</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">test</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_node</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>ast.NodeTransformer</code> again uses the visitor pattern to walk over all nodes.
This time, however, we change the resulting AST. In our case, if we encounter an <em>if-statement</em> we only return the condition.</p>
<p>(Keep in mind, <code>NodeReducer</code> changes the ast in place, so if you want to preserve the original tree, you need to copy it with <code>copy.deepcopy(tree)</code>)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">NodeReducer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">source_ast</span><span class="p">)</span>
<span class="n">show_ast</span><span class="p">(</span><span class="n">source_ast</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="449pt" height="332pt" viewBox="0.00 0.00 448.50 332.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 328)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-328 444.5,-328 444.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="135" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">FunctionDef</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="29.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;foo&quot;</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M181.5,-287C181.5,-287 117.78,-270.31 68.5,-252 65.45,-250.87 62.3,-249.62 59.17,-248.34"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="start" x="85.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arguments</text>
</g>
<!-- 0&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>0--2</title>
<path fill="none" stroke="black" d="M181.5,-287C181.5,-287 159.41,-267.19 142.49,-252.03"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="start" x="223.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Expr</text>
</g>
<!-- 0&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>0--7</title>
<path fill="none" stroke="black" d="M181.5,-287C181.5,-287 203.97,-267.19 221.18,-252.03"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="start" x="327" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 0&#45;&#45;16 -->
<g id="edge16" class="edge">
<title>0--16</title>
<path fill="none" stroke="black" d="M181.5,-287C181.5,-287 268.88,-260.43 318.72,-245.27"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="start" x="32.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>2--3</title>
<path fill="none" stroke="black" d="M114.5,-215C114.5,-215 88.22,-195.19 68.09,-180.03"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="start" x="104.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>2--5</title>
<path fill="none" stroke="black" d="M114.5,-215C114.5,-215 115.64,-195.19 116.52,-180.03"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="42.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;a&quot;</text>
</g>
<!-- 3&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>3--4</title>
<path fill="none" stroke="black" d="M44.76,-143.7C44.29,-132.85 43.7,-118.92 43.23,-108.1"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="114.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;b&quot;</text>
</g>
<!-- 5&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>5--6</title>
<path fill="none" stroke="black" d="M116.76,-143.7C116.29,-132.85 115.7,-118.92 115.23,-108.1"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="start" x="228" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 7&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>7--8</title>
<path fill="none" stroke="black" d="M243.71,-215.7C245.73,-204.85 248.32,-190.92 250.32,-180.1"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="middle" x="186.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 8&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>8--9</title>
<path fill="none" stroke="black" d="M254.5,-143C254.5,-143 228.6,-123.19 208.77,-108.03"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="start" x="241.5" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 8&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>8--10</title>
<path fill="none" stroke="black" d="M254.5,-143C254.5,-143 256.02,-123.19 257.19,-108.03"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="start" x="313.5" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 8&#45;&#45;13 -->
<g id="edge13" class="edge">
<title>8--13</title>
<path fill="none" stroke="black" d="M254.5,-143C254.5,-143 283.45,-123.19 305.61,-108.03"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="186.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;a&quot;</text>
</g>
<!-- 10&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>10--11</title>
<path fill="none" stroke="black" d="M250.5,-71C250.5,-71 226.12,-51.19 207.46,-36.03"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="258.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 10&#45;&#45;12 -->
<g id="edge12" class="edge">
<title>10--12</title>
<path fill="none" stroke="black" d="M250.5,-71C250.5,-71 253.55,-51.19 255.88,-36.03"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="330.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;b&quot;</text>
</g>
<!-- 13&#45;&#45;14 -->
<g id="edge14" class="edge">
<title>13--14</title>
<path fill="none" stroke="black" d="M338.5,-71C338.5,-71 335.45,-51.19 333.12,-36.03"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="middle" x="402.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 13&#45;&#45;15 -->
<g id="edge15" class="edge">
<title>13--15</title>
<path fill="none" stroke="black" d="M338.5,-71C338.5,-71 362.88,-51.19 381.54,-36.03"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="start" x="364.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 16&#45;&#45;17 -->
<g id="edge17" class="edge">
<title>16--17</title>
<path fill="none" stroke="black" d="M363.87,-215.7C371,-204.85 380.15,-190.92 387.26,-180.1"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="middle" x="402.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">0</text>
</g>
<!-- 17&#45;&#45;18 -->
<g id="edge18" class="edge">
<title>17--18</title>
<path fill="none" stroke="black" d="M399.49,-143.7C400.11,-132.85 400.9,-118.92 401.52,-108.1"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As you can see, after running the <code>NodeReducer</code> there is no longer an <em>if-statement</em>, but only its condition.
A more sophisticated NodeReducer is presented in the <a href="https://www.debuggingbook.org/beta/html/DeltaDebugger.html">Reducing Failure-Inducing Inputs chapter</a> in the debugging book.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To learn the structure of an AST, have a look at the <a href="http://docs.python.org/3/library/ast">official Python <code>ast</code> reference</a> for a list of AST nodes and their attributes. This reference is complete, but a bit terse; the <a href="https://greentreesnakes.readthedocs.io/en/latest/manipulating.html">"Green Tree Snakes missing Python AST docs"</a> provide a good manual on how to modify the tree.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Pro tip</strong>: You can learn the expected structure of any Python fragment by invoking <code>ast.dump()</code> on any (parsed) AST.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">demo_ast</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">if a == b:</span>
<span class="s1">    c = d</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">demo_ast</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Module(
    body=[
        If(
            test=Compare(
                left=Name(id=&#39;a&#39;, ctx=Load()),
                ops=[
                    Eq()],
                comparators=[
                    Name(id=&#39;b&#39;, ctx=Load())]),
            body=[
                Assign(
                    targets=[
                        Name(id=&#39;c&#39;, ctx=Store())],
                    value=Name(id=&#39;d&#39;, ctx=Load()))],
            orelse=[])],
    type_ignores=[])
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The nice thing is that this not only reveals the AST structure, it also tells you how to construct it. If you take the very structure as produced by <code>ast.dump()</code> and evaluate it, you obtain the same syntax tree.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/ast.html" class="import" target="_blank">ast</a></span> <span class="kn">import</span> <span class="n">Module</span><span class="p">,</span> <span class="n">If</span><span class="p">,</span> <span class="n">Compare</span><span class="p">,</span> <span class="n">Load</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Assign</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Store</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ast_from_scratch</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span>
    <span class="n">body</span><span class="o">=</span><span class="p">[</span>
        <span class="n">If</span><span class="p">(</span>
            <span class="n">test</span><span class="o">=</span><span class="n">Compare</span><span class="p">(</span>
                <span class="n">left</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()),</span>
                <span class="n">ops</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">Eq</span><span class="p">()],</span>
                <span class="n">comparators</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">())]),</span>
            <span class="n">body</span><span class="o">=</span><span class="p">[</span>
                <span class="n">Assign</span><span class="p">(</span>
                    <span class="n">targets</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Store</span><span class="p">())],</span>
                    <span class="n">value</span><span class="o">=</span><span class="n">Name</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">Load</span><span class="p">()))],</span>
            <span class="n">orelse</span><span class="o">=</span><span class="p">[])],</span>
    <span class="n">type_ignores</span><span class="o">=</span><span class="p">[])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>You need to invoke <code>ast.fix_missing_locations()</code> to add line numbers and other location info that would be normally added during parsing...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ast_from_scratch</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">fix_missing_locations</span><span class="p">(</span><span class="n">ast_from_scratch</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... and with this, you're all set:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">ast_from_scratch</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>if a == b:
    c = d
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Hence, if you do not know what kind of AST fragment to produce, just</p>
<ol>
<li>parse its text with <code>ast.parse()</code> </li>
<li>study the expression produced by <code>ast.dump()</code>, and</li>
<li>build it from the same expression, using <code>ast.fix_missing_locations()</code> and <code>ast.unparse()</code></li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Implementing-a-Reducing-Debugger">Implementing a Reducing Debugger<a class="anchor-link" href="#Implementing-a-Reducing-Debugger">&#182;</a></h3><p>Having seen how one can access and transform AST structures using a <code>NodeReducer</code> in Python, we can now use that knowledge to implement a <code>ReducingDebugger</code>
capable of reducing the failure inducing Python code down to only that parts of the code that actually triggers the failure.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ReducingDebugger</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">SimpleParser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        We initialize the DebuggingReducer with a parser,</span>
<span class="sd">        as this is needed to verify whether the failure </span>
<span class="sd">        is still triggered after the code transformation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_reducer</span> <span class="o">=</span> <span class="n">NodeReducer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function takes some Python code as string, reduces</span>
<span class="sd">        it using the NodeReducer defined earlier and returns the </span>
<span class="sd">        reduced program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Parse the code to a tree</span>
        <span class="n">code_ast</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">code</span><span class="p">)</span>

        <span class="c1"># Use the visit-method of the NodeReducer to reduce if nodes down to their condition</span>
        <span class="n">new_code_ast</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_reducer</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">code_ast</span><span class="p">)</span>

        <span class="c1"># After we&#39;ve updated nodes, we need to fix the tree</span>
        <span class="n">ast</span><span class="o">.</span><span class="n">fix_missing_locations</span><span class="p">(</span><span class="n">new_code_ast</span><span class="p">)</span>

        <span class="c1"># Generate code from the reduced tree</span>
        <span class="n">new_code</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">new_code_ast</span><span class="p">)</span>

        <span class="c1"># Test, whether the error is still triggered by the reduced code</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">new_code</span><span class="p">)</span>
            <span class="c1"># No exception is thrown. This means the new_code does not </span>
            <span class="c1"># trigger an error anymore. Therefore, we failed in</span>
            <span class="c1"># reduction and return the initial code.</span>
            <span class="k">return</span> <span class="n">code</span>
        <span class="k">except</span> <span class="n">ParserException</span><span class="p">:</span>
            <span class="c1"># The error is still triggered. Return the reduced code</span>
            <span class="k">return</span> <span class="n">new_code</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>ReducingDebugger</code> implemented above takes some Python code as an input and replaces all if-statements with their conditions.
Then, it checks whether the newly generated code still triggers the error. If not, it returns the initial code. If the exception is still triggered, it returns the reduced code.
Let's apply it to the source code of our <code>foo</code> function:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reducing_debugger</span> <span class="o">=</span> <span class="n">ReducingDebugger</span><span class="p">(</span><span class="n">SimpleParserPlus</span><span class="p">())</span>
<span class="n">new_source</span> <span class="o">=</span> <span class="n">reducing_debugger</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;ast.FunctionDef object at 0x1056e78e0&gt;
&lt;ast.arguments object at 0x1056e7f10&gt;
&lt;ast.arg object at 0x1056e71c0&gt;
&lt;ast.arg object at 0x1056e7a60&gt;
&lt;ast.Constant object at 0x1056e71f0&gt;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">new_source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>def foo(a, b):
    &#34;&#34;&#34;
    Checks whether a and b are true
    &#34;&#34;&#34;
    a and b
    return 0
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">SimpleParserPlus</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">new_source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;ast.FunctionDef object at 0x1056e71c0&gt;
&lt;ast.arguments object at 0x1056e7f10&gt;
&lt;ast.arg object at 0x1056e7d30&gt;
&lt;ast.arg object at 0x1056e7070&gt;
&lt;ast.Constant object at 0x1056e7310&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/3561000985.py&#34;, line 2, in &lt;module&gt;
    SimpleParserPlus().parse(new_source)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2922974276.py&#34;, line 12, in parse
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2922974276.py&#34;, line 16, in visit_FunctionDef
    self.generic_visit(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1656391407.py&#34;, line 10, in visit_BoolOp
    raise ParserException(&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As we can see, our <code>ReducingDebugger</code> reduces the original function to a smaller input, while still preserving the property of the code that triggers the same error as before.
However, this reducer is very simple: it applies only one transformation to all <code>if</code> nodes at once.
Instead, one can consider various transformations of the same node as well as transformations of various node types and apply them one by one (or in batches) to gradually reduce the code.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Keep in mind, that the changes should be made in a way that the code is still accepted by a regular Python interpreter.
Besides, the goal is to obtain a minimal program that still triggers the error.
So, your debugging reducer should not simply reduce all possible nodes, but also regularly check whether the reduced code still triggers the failure.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Therefore, you are required to implement certain modifications that can be done to the AST. In general, these transformations can be one of the following:</p>
<ol>
<li>Delete a node,</li>
<li>Substitute a node with the new node (e.g., <em>pass</em> node),</li>
<li>Substitute a node with all of its children,</li>
<li>Substitute a node with one of its children.</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>More detailed, one can consider, for instance:</p>
<ol>
<li>Replacing a <code>BoolOp</code> node by <code>True</code>.</li>
<li>Replacing a <code>BoolOp</code> node by <code>False</code>.</li>
<li>Replacing a <code>BoolOp</code> node by its left operand.</li>
<li>Replacing a <code>BoolOp</code> node by its right operand.</li>
<li>Replacing an <code>If</code> node by its "then" body.</li>
<li>Replacing an <code>If</code> node by its condition.</li>
<li>Replacing an <code>If</code> node by its "else" body.</li>
<li>Replacing all instances of a variable by a constant.</li>
<li>Replacing expressions by a constant.</li>
<li>etc.</li>
</ol>
<p>Please, refer to the <a href="http://docs.python.org/3/library/ast">official Python <code>ast</code> reference</a> for a full list of node types.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Implementation">Implementation<a class="anchor-link" href="#Implementation">&#182;</a></h2><p>To succeed in this project, you need to complete the <code>MyReducer</code> class.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MyReducer</span><span class="p">(</span><span class="n">ReducingDebugger</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># TODO: implement this!</span>
        <span class="k">return</span> <span class="n">code</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To this end, you will need to extend the <code>NodeReducer</code> with additional transformations and implement a reducer strategy
which collects all possible transformations and applies them to the AST until it is exhaustively minimized.
Feel free to make your own implementation or extend the <code>DeltaDebugger</code> from the <a href="https://www.debuggingbook.org/beta/html/DeltaDebugger.html">Reducing Failure-Inducing Inputs chapter</a> with
the proper strategy.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Evaluation">Evaluation<a class="anchor-link" href="#Evaluation">&#182;</a></h2><p>We evaluate your project based on public as well as secret tests. In this section, we present <strong>five</strong> different Python parsers as well as <strong>five</strong> Python input programs, which should be minified.
These parsers check for a specific property in the code and fail the execution if the property exists. The input programs and parsers in this section make up the public test cases.
If you pass all of those tests <strong>without hardcoding the modifications</strong> you are guaranteed to score 15 points in this project. You can get more points for passing secret tests.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Parsers">Parsers<a class="anchor-link" href="#Parsers">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Parser</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The base class for a parser&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">parse_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;The input was successfully parsed.&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>Parser</code> is the base class for a parser from which all other parsers are derived. It works the same way as the <code>SimpleParser</code> introduced earlier.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's define a couple of parsers which model a failure during processing of a certain code feature.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Parser1</span><span class="p">(</span><span class="n">Parser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Contains a boolean operation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">visit_BoolOp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">BoolOp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ParserException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Something went wrong&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we feed this parser with an input program which contains a boolean operation, it fails:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parser1</span> <span class="o">=</span> <span class="n">Parser1</span><span class="p">()</span>
<span class="n">input_program</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">a = True and False&#39;&#39;&#39;</span>
<span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">parser1</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">input_program</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2806337694.py&#34;, line 5, in &lt;module&gt;
    parser1.parse(input_program)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 9, in parse
    self.parse_tree(tree)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 5, in parse_tree
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2980862917.py&#34;, line 7, in visit_BoolOp
    raise ParserException(f&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In contrast to the above, an input program <em>without</em> a boolean operation is parsed correctly.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parser1</span> <span class="o">=</span> <span class="n">Parser1</span><span class="p">()</span>
<span class="n">input_program</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">a = 1</span>
<span class="s1">b = True</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">parser1</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">input_program</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;The input was successfully parsed.&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The other parsers are</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Parser2</span><span class="p">(</span><span class="n">Parser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fails if an input program contains `if` statement</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">visit_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ParserException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Something went wrong&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parser2</span> <span class="o">=</span> <span class="n">Parser2</span><span class="p">()</span>
<span class="n">input_program</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">if a:</span>
<span class="s1">    b = 1</span>
<span class="s1">else:</span>
<span class="s1">    b = 2</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">parser2</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">input_program</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1476831468.py&#34;, line 9, in &lt;module&gt;
    parser2.parse(input_program)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 9, in parse
    self.parse_tree(tree)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 5, in parse_tree
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1684278366.py&#34;, line 6, in visit_If
    raise ParserException(f&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Parser3</span><span class="p">(</span><span class="n">Parser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fails if an input program contains a special unicode character</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">check_unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">==</span> <span class="sa">u</span><span class="s1">&#39;</span><span class="se">\u0426</span><span class="s1">&#39;</span>

    <span class="k">def</span> <span class="nf">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Assign</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Constant</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_unicode</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ParserException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Something went wrong&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parser3</span> <span class="o">=</span> <span class="n">Parser3</span><span class="p">()</span>
<span class="n">input_program</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">a = u&#39;</span><span class="se">\u0426</span><span class="s1">&#39;</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="n">ParserException</span><span class="p">):</span>
    <span class="n">parser3</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">input_program</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/951683174.py&#34;, line 6, in &lt;module&gt;
    parser3.parse(input_program)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 9, in parse
    self.parse_tree(tree)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 5, in parse_tree
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2904791116.py&#34;, line 15, in generic_visit
    super().generic_visit(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2904791116.py&#34;, line 20, in visit_Assign
    self.generic_visit(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2904791116.py&#34;, line 15, in generic_visit
    super().generic_visit(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2904791116.py&#34;, line 26, in visit_Constant
    raise ParserException(f&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Parser4</span><span class="p">(</span><span class="n">Parser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fails if an input program contains a variable which is not defined</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ParserException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Something went wrong&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Assign</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assignment</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parser4</span> <span class="o">=</span> <span class="n">Parser4</span><span class="p">()</span>
<span class="n">input_program</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">a = 1</span>
<span class="s1">b = c</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="n">ParserException</span><span class="p">):</span>
    <span class="n">parser4</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">input_program</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1261297070.py&#34;, line 7, in &lt;module&gt;
    parser4.parse(input_program)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 9, in parse
    self.parse_tree(tree)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 5, in parse_tree
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/3413124393.py&#34;, line 13, in generic_visit
    super().generic_visit(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/3413124393.py&#34;, line 28, in visit_Assign
    self.generic_visit(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/3413124393.py&#34;, line 13, in generic_visit
    super().generic_visit(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/3413124393.py&#34;, line 23, in visit_Name
    raise ParserException(f&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Parser5</span><span class="p">(</span><span class="n">Parser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fails if an input program contains a list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">visit_List</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ParserException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Something went wrong&quot;</span><span class="p">)</span> 
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parser5</span> <span class="o">=</span> <span class="n">Parser5</span><span class="p">()</span>
<span class="n">input_program</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">a = {x * 2 for x in map(int, [&#39;1&#39;, &#39;2&#39;, &#39;3&#39;])}</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="n">ParserException</span><span class="p">):</span>
    <span class="n">parser5</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">input_program</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/3158638464.py&#34;, line 6, in &lt;module&gt;
    parser5.parse(input_program)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 9, in parse
    self.parse_tree(tree)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 5, in parse_tree
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/4175947920.py&#34;, line 7, in visit_List
    raise ParserException(f&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For secret tests we may use other parsers crafted in the same way.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Input-Programs">Input Programs<a class="anchor-link" href="#Input-Programs">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now we present five public tests.
Each test case implements a <code>get_original()</code> method that returns an input program which your reducer should minify.
It also has a <code>parser</code> field which stores a parser used for a respective input program.
Besides, <code>get_minimized()</code> method provides a reference solution.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Test1</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">Parser1</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_original</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">def original():</span>
<span class="s1">    a = True</span>
<span class="s1">    b = not False</span>
<span class="s1">    c = 30</span>
<span class="s1">    for i in range(c):</span>
<span class="s1">        if i == 15:</span>
<span class="s1">            if a and b:</span>
<span class="s1">                return 1</span>
<span class="s1">    return 0</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">True and True&#39;&#39;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Test2</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">Parser2</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_original</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">def original():</span>
<span class="s1">    a = True</span>
<span class="s1">    b = not False</span>
<span class="s1">    c = 30</span>
<span class="s1">    for i in range(c):</span>
<span class="s1">        if i == 15:</span>
<span class="s1">            if a and b:</span>
<span class="s1">                return 1</span>
<span class="s1">    return 0</span>
<span class="s1">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">if True:</span>
<span class="s1">    return</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Test3</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">Parser3</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_original</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">def original():</span>
<span class="s1">    a = 1</span>
<span class="s1">    b = a</span>
<span class="s1">    c = a - b</span>
<span class="s1">    if c &lt; a:</span>
<span class="s1">        d = &#39;&#39;</span>
<span class="s1">        while a == b:</span>
<span class="s1">            d = u&#39;</span><span class="se">\u0426</span><span class="s1">&#39;</span>
<span class="s1">            a += 1</span>
<span class="s1">        return d</span>
<span class="s1">    return &#39;&#39;</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">d = u&#39;</span><span class="se">\u0426</span><span class="s1">&#39;</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Test4</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">Parser4</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">get_original</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">def original():</span>
<span class="s1">    a = 1</span>
<span class="s1">    b = a</span>
<span class="s1">    c = a - b</span>
<span class="s1">    if c &lt; a:</span>
<span class="s1">        while a == b:</span>
<span class="s1">            a += 1</span>
<span class="s1">        return d</span>
<span class="s1">    return &#39;&#39;</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">d</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Test5</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">Parser5</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_original</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">def original():</span>
<span class="s1">    a = 1</span>
<span class="s1">    b = 0</span>
<span class="s1">    while True:</span>
<span class="s1">        if a &lt; b:</span>
<span class="s1">            return [1, 2, 3]</span>
<span class="s1">        else:</span>
<span class="s1">            return []</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">[]</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For instance, let's take the input program of <code>Test1</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">Test1</span><span class="p">()</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">get_original</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
def original():
    a = True
    b = not False
    c = 30
    for i in range(c):
        if i == 15:
            if a and b:
                return 1
    return 0
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And parse it with the provided parser:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">test</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1292946598.py&#34;, line 2, in &lt;module&gt;
    test.parser.parse(source)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 9, in parse
    self.parse_tree(tree)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/1737200860.py&#34;, line 5, in parse_tree
    self.visit(tree)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 415, in generic_visit
    self.visit(item)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 417, in generic_visit
    self.visit(value)
  File &#34;/Users/zeller/.pyenv/versions/3.9.7/lib/python3.9/ast.py&#34;, line 407, in visit
    return visitor(node)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_97807/2980862917.py&#34;, line 7, in visit_BoolOp
    raise ParserException(f&#34;Something went wrong&#34;)
ParserException: Something went wrong (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The parser failed.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Testing-Infrastructure">Testing Infrastructure<a class="anchor-link" href="#Testing-Infrastructure">&#182;</a></h3><p>The following section introduces the testing infrastructure, which is used to assess your performance in the project. Passing all tests will be enough to complete the project successfully.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We are not going to directly compare a minimized program with the reference solution (as two strings). Instead, we again transform the code into AST and count the number of nodes in both trees.
If the difference between them is lower than a <code>THRESHOLD</code> (and a parser still produces an error), the test is passed.
To count the number of nodes in the AST, we need a helper class <code>NodeCounter</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeCounter</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This node counter is used to assess</span>
<span class="sd">    the amount of reductions performed by your reducer.</span>
<span class="sd">    It counts the number of nodes in the AST.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_nodes</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The AST of the input program is as follows:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_ast</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of nodes is </span><span class="si">{</span><span class="n">NodeCounter</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1629pt" height="476pt" viewBox="0.00 0.00 1629.00 476.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 472)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-472 1625,-472 1625,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="400.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">FunctionDef</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="149" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;original&quot;</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M448,-431C448,-431 313.98,-418.46 209,-396 205.93,-395.34 202.79,-394.62 199.62,-393.85"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="middle" x="264" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">arguments</text>
</g>
<!-- 0&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>0--2</title>
<path fill="none" stroke="black" d="M448,-431C448,-431 376.05,-412.55 319,-396 316.12,-395.16 313.16,-394.29 310.18,-393.4"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="start" x="336.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>0--3</title>
<path fill="none" stroke="black" d="M448,-431C448,-431 415.24,-411.19 390.16,-396.03"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="start" x="421.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>0--9</title>
<path fill="none" stroke="black" d="M448,-431C448,-431 447.62,-411.19 447.33,-396.03"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="start" x="578.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;17 -->
<g id="edge17" class="edge">
<title>0--17</title>
<path fill="none" stroke="black" d="M448,-431C448,-431 524.27,-405.58 570.15,-390.28"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="start" x="894" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">For</text>
</g>
<!-- 0&#45;&#45;23 -->
<g id="edge23" class="edge">
<title>0--23</title>
<path fill="none" stroke="black" d="M448,-431C448,-431 780.85,-393.29 879.66,-382.1"/>
</g>
<!-- 54 -->
<g id="node55" class="node">
<title>54</title>
<text text-anchor="start" x="1151.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 0&#45;&#45;54 -->
<g id="edge54" class="edge">
<title>0--54</title>
<path fill="none" stroke="black" d="M448,-431C448,-431 723.02,-411.77 943,-396 1014.3,-390.89 1097.82,-384.8 1143.29,-381.47"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="start" x="85" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 3&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>3--4</title>
<path fill="none" stroke="black" d="M328,-364C328,-364 323.15,-361.38 319,-360 251.09,-337.36 231.35,-341.76 162,-324 151.2,-321.23 139.37,-317.94 129.1,-314.99"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="start" x="179" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 3&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>3--7</title>
<path fill="none" stroke="black" d="M328,-364C328,-364 281.38,-340.89 247.5,-324.1"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="middle" x="27" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;a&quot;</text>
</g>
<!-- 4&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>4--5</title>
<path fill="none" stroke="black" d="M94,-287C94,-287 68.48,-267.19 48.94,-252.03"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="middle" x="102" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 4&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>4--6</title>
<path fill="none" stroke="black" d="M94,-287C94,-287 97.05,-267.19 99.38,-252.03"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="177" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">True</text>
</g>
<!-- 7&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>7--8</title>
<path fill="none" stroke="black" d="M204.1,-287.7C198.52,-276.85 191.36,-262.92 185.8,-252.1"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="start" x="307" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 9&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>9--10</title>
<path fill="none" stroke="black" d="M437,-359C437,-359 384.5,-334.84 351.07,-319.46"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="start" x="417.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 9&#45;&#45;13 -->
<g id="edge13" class="edge">
<title>9--13</title>
<path fill="none" stroke="black" d="M437,-359C437,-359 440.81,-339.19 443.73,-324.03"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="middle" x="249" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;b&quot;</text>
</g>
<!-- 10&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>10--11</title>
<path fill="none" stroke="black" d="M316,-287C316,-287 290.48,-267.19 270.94,-252.03"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="middle" x="324" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 10&#45;&#45;12 -->
<g id="edge12" class="edge">
<title>10--12</title>
<path fill="none" stroke="black" d="M316,-287C316,-287 319.05,-267.19 321.38,-252.03"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="399" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 13&#45;&#45;14 -->
<g id="edge14" class="edge">
<title>13--14</title>
<path fill="none" stroke="black" d="M446,-287C446,-287 428.1,-267.19 414.39,-252.03"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="start" x="452" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 13&#45;&#45;15 -->
<g id="edge15" class="edge">
<title>13--15</title>
<path fill="none" stroke="black" d="M446,-287C446,-287 461.24,-267.19 472.9,-252.03"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="486" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 15&#45;&#45;16 -->
<g id="edge16" class="edge">
<title>15--16</title>
<path fill="none" stroke="black" d="M486,-215.7C486,-204.85 486,-190.92 486,-180.1"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="start" x="587" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 17&#45;&#45;18 -->
<g id="edge18" class="edge">
<title>17--18</title>
<path fill="none" stroke="black" d="M614,-359C614,-359 610.19,-339.19 607.27,-324.03"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="start" x="673" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 17&#45;&#45;21 -->
<g id="edge21" class="edge">
<title>17--21</title>
<path fill="none" stroke="black" d="M614,-359C614,-359 649.43,-339.19 676.55,-324.03"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="573" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 18&#45;&#45;19 -->
<g id="edge19" class="edge">
<title>18--19</title>
<path fill="none" stroke="black" d="M605,-287C605,-287 592.81,-267.19 583.48,-252.03"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="648" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 18&#45;&#45;20 -->
<g id="edge20" class="edge">
<title>18--20</title>
<path fill="none" stroke="black" d="M605,-287C605,-287 621.38,-267.19 633.92,-252.03"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="723" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">30</text>
</g>
<!-- 21&#45;&#45;22 -->
<g id="edge22" class="edge">
<title>21--22</title>
<path fill="none" stroke="black" d="M710.96,-287.7C713.44,-276.85 716.62,-262.92 719.09,-252.1"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="start" x="853" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 23&#45;&#45;24 -->
<g id="edge24" class="edge">
<title>23--24</title>
<path fill="none" stroke="black" d="M916,-359C916,-359 898.48,-339.19 885.06,-324.03"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<text text-anchor="start" x="928" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Call</text>
</g>
<!-- 23&#45;&#45;27 -->
<g id="edge27" class="edge">
<title>23--27</title>
<path fill="none" stroke="black" d="M916,-359C916,-359 927.05,-339.19 935.5,-324.03"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<text text-anchor="start" x="1188.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 23&#45;&#45;34 -->
<g id="edge34" class="edge">
<title>23--34</title>
<path fill="none" stroke="black" d="M916,-359C916,-359 1099.28,-325.08 1169.8,-312.03"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="795" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;i&quot;</text>
</g>
<!-- 24&#45;&#45;25 -->
<g id="edge25" class="edge">
<title>24--25</title>
<path fill="none" stroke="black" d="M862,-287C862,-287 836.48,-267.19 816.94,-252.03"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="870" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 24&#45;&#45;26 -->
<g id="edge26" class="edge">
<title>24--26</title>
<path fill="none" stroke="black" d="M862,-287C862,-287 865.05,-267.19 867.38,-252.03"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<text text-anchor="start" x="928" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 27&#45;&#45;28 -->
<g id="edge28" class="edge">
<title>27--28</title>
<path fill="none" stroke="black" d="M953,-287C953,-287 949.95,-267.19 947.62,-252.03"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<text text-anchor="start" x="1000" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 27&#45;&#45;31 -->
<g id="edge31" class="edge">
<title>27--31</title>
<path fill="none" stroke="black" d="M953,-287C953,-287 977.38,-267.19 996.04,-252.03"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<text text-anchor="middle" x="826" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;range&quot;</text>
</g>
<!-- 28&#45;&#45;29 -->
<g id="edge29" class="edge">
<title>28--29</title>
<path fill="none" stroke="black" d="M928,-215C928,-215 889.15,-195.19 859.4,-180.03"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<text text-anchor="middle" x="909" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 28&#45;&#45;30 -->
<g id="edge30" class="edge">
<title>28--30</title>
<path fill="none" stroke="black" d="M928,-215C928,-215 920.76,-195.19 915.22,-180.03"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<text text-anchor="middle" x="981" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 31&#45;&#45;32 -->
<g id="edge32" class="edge">
<title>31--32</title>
<path fill="none" stroke="black" d="M1017,-215C1017,-215 1003.29,-195.19 992.79,-180.03"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<text text-anchor="middle" x="1053" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 31&#45;&#45;33 -->
<g id="edge33" class="edge">
<title>31--33</title>
<path fill="none" stroke="black" d="M1017,-215C1017,-215 1030.71,-195.19 1041.21,-180.03"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<text text-anchor="start" x="1167.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 34&#45;&#45;35 -->
<g id="edge35" class="edge">
<title>34--35</title>
<path fill="none" stroke="black" d="M1208,-287C1208,-287 1203.81,-267.19 1200.6,-252.03"/>
</g>
<!-- 42 -->
<g id="node43" class="node">
<title>42</title>
<text text-anchor="start" x="1328.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 34&#45;&#45;42 -->
<g id="edge42" class="edge">
<title>34--42</title>
<path fill="none" stroke="black" d="M1208,-287C1208,-287 1272.13,-261.15 1309.96,-245.9"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<text text-anchor="start" x="1108" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 35&#45;&#45;36 -->
<g id="edge36" class="edge">
<title>35--36</title>
<path fill="none" stroke="black" d="M1197,-215C1197,-215 1169.57,-195.19 1148.58,-180.03"/>
</g>
<!-- 39 -->
<g id="node40" class="node">
<title>39</title>
<text text-anchor="middle" x="1197" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 35&#45;&#45;39 -->
<g id="edge39" class="edge">
<title>35--39</title>
<path fill="none" stroke="black" d="M1197,-215C1197,-215 1197,-195.19 1197,-180.03"/>
</g>
<!-- 40 -->
<g id="node41" class="node">
<title>40</title>
<text text-anchor="start" x="1250" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 35&#45;&#45;40 -->
<g id="edge40" class="edge">
<title>35--40</title>
<path fill="none" stroke="black" d="M1197,-215C1197,-215 1230.14,-195.19 1255.51,-180.03"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<text text-anchor="middle" x="1071" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;i&quot;</text>
</g>
<!-- 36&#45;&#45;37 -->
<g id="edge37" class="edge">
<title>36--37</title>
<path fill="none" stroke="black" d="M1121,-143C1121,-143 1101.95,-123.19 1087.37,-108.03"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<text text-anchor="middle" x="1143" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 36&#45;&#45;38 -->
<g id="edge38" class="edge">
<title>36--38</title>
<path fill="none" stroke="black" d="M1121,-143C1121,-143 1129.38,-123.19 1135.8,-108.03"/>
</g>
<!-- 41 -->
<g id="node42" class="node">
<title>41</title>
<text text-anchor="middle" x="1234" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">15</text>
</g>
<!-- 40&#45;&#45;41 -->
<g id="edge41" class="edge">
<title>40--41</title>
<path fill="none" stroke="black" d="M1271.64,-143.7C1263.89,-132.85 1253.94,-118.92 1246.22,-108.1"/>
</g>
<!-- 43 -->
<g id="node44" class="node">
<title>43</title>
<text text-anchor="start" x="1352.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 42&#45;&#45;43 -->
<g id="edge43" class="edge">
<title>42--43</title>
<path fill="none" stroke="black" d="M1358,-215C1358,-215 1365.62,-195.19 1371.45,-180.03"/>
</g>
<!-- 51 -->
<g id="node52" class="node">
<title>51</title>
<text text-anchor="start" x="1489.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 42&#45;&#45;51 -->
<g id="edge51" class="edge">
<title>42--51</title>
<path fill="none" stroke="black" d="M1358,-215C1358,-215 1435.19,-189.43 1481.32,-174.16"/>
</g>
<!-- 44 -->
<g id="node45" class="node">
<title>44</title>
<text text-anchor="middle" x="1306" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 43&#45;&#45;44 -->
<g id="edge44" class="edge">
<title>43--44</title>
<path fill="none" stroke="black" d="M1378,-143C1378,-143 1350.57,-123.19 1329.58,-108.03"/>
</g>
<!-- 45 -->
<g id="node46" class="node">
<title>45</title>
<text text-anchor="start" x="1361" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 43&#45;&#45;45 -->
<g id="edge45" class="edge">
<title>43--45</title>
<path fill="none" stroke="black" d="M1378,-143C1378,-143 1378,-123.19 1378,-108.03"/>
</g>
<!-- 48 -->
<g id="node49" class="node">
<title>48</title>
<text text-anchor="start" x="1433" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 43&#45;&#45;48 -->
<g id="edge48" class="edge">
<title>43--48</title>
<path fill="none" stroke="black" d="M1378,-143C1378,-143 1405.43,-123.19 1426.42,-108.03"/>
</g>
<!-- 46 -->
<g id="node47" class="node">
<title>46</title>
<text text-anchor="middle" x="1306" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;a&quot;</text>
</g>
<!-- 45&#45;&#45;46 -->
<g id="edge46" class="edge">
<title>45--46</title>
<path fill="none" stroke="black" d="M1370,-71C1370,-71 1345.62,-51.19 1326.96,-36.03"/>
</g>
<!-- 47 -->
<g id="node48" class="node">
<title>47</title>
<text text-anchor="middle" x="1378" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 45&#45;&#45;47 -->
<g id="edge47" class="edge">
<title>45--47</title>
<path fill="none" stroke="black" d="M1370,-71C1370,-71 1373.05,-51.19 1375.38,-36.03"/>
</g>
<!-- 49 -->
<g id="node50" class="node">
<title>49</title>
<text text-anchor="middle" x="1450" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;b&quot;</text>
</g>
<!-- 48&#45;&#45;49 -->
<g id="edge49" class="edge">
<title>48--49</title>
<path fill="none" stroke="black" d="M1458,-71C1458,-71 1454.95,-51.19 1452.62,-36.03"/>
</g>
<!-- 50 -->
<g id="node51" class="node">
<title>50</title>
<text text-anchor="middle" x="1522" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 48&#45;&#45;50 -->
<g id="edge50" class="edge">
<title>48--50</title>
<path fill="none" stroke="black" d="M1458,-71C1458,-71 1482.38,-51.19 1501.04,-36.03"/>
</g>
<!-- 52 -->
<g id="node53" class="node">
<title>52</title>
<text text-anchor="start" x="1532" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 51&#45;&#45;52 -->
<g id="edge52" class="edge">
<title>51--52</title>
<path fill="none" stroke="black" d="M1527.61,-143.7C1535.51,-132.85 1545.66,-118.92 1553.54,-108.1"/>
</g>
<!-- 53 -->
<g id="node54" class="node">
<title>53</title>
<text text-anchor="middle" x="1594" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">1</text>
</g>
<!-- 52&#45;&#45;53 -->
<g id="edge53" class="edge">
<title>52--53</title>
<path fill="none" stroke="black" d="M1572.92,-71.7C1577.26,-60.85 1582.83,-46.92 1587.16,-36.1"/>
</g>
<!-- 55 -->
<g id="node56" class="node">
<title>55</title>
<text text-anchor="start" x="1333" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 54&#45;&#45;55 -->
<g id="edge55" class="edge">
<title>54--55</title>
<path fill="none" stroke="black" d="M1210.53,-364.65C1242.38,-352.91 1290.4,-335.22 1324.83,-322.54"/>
</g>
<!-- 56 -->
<g id="node57" class="node">
<title>56</title>
<text text-anchor="middle" x="1409" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">0</text>
</g>
<!-- 55&#45;&#45;56 -->
<g id="edge56" class="edge">
<title>55--56</title>
<path fill="none" stroke="black" d="M1377.38,-287.7C1383.89,-276.85 1392.25,-262.92 1398.74,-252.1"/>
</g>
</g>
</svg>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The number of nodes is 42
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As you can see, the input program of <code>Test1</code> has 42 nodes.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The testing framework takes a reducer and allows to execute a single test or all tests at once.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TestingFramework</span><span class="p">:</span>
    <span class="n">THRESHOLD</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">test_cases</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;test1&#39;</span><span class="p">:</span> <span class="n">Test1</span><span class="p">(),</span>
        <span class="s1">&#39;test2&#39;</span><span class="p">:</span> <span class="n">Test2</span><span class="p">(),</span>
        <span class="s1">&#39;test3&#39;</span><span class="p">:</span> <span class="n">Test3</span><span class="p">(),</span>
        <span class="s1">&#39;test4&#39;</span><span class="p">:</span> <span class="n">Test4</span><span class="p">(),</span>
        <span class="s1">&#39;test5&#39;</span><span class="p">:</span> <span class="n">Test5</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reducer</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reducer</span> <span class="o">=</span> <span class="n">reducer</span>

    <span class="k">def</span> <span class="nf">count_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">100000</span>
        <span class="k">return</span> <span class="n">NodeCounter</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        run a single test</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Running test </span><span class="si">{</span><span class="n">test</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">reducer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reducer</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span>
        <span class="n">reduced_code</span> <span class="o">=</span> <span class="n">reducer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">get_original</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">has_property</span><span class="p">(</span><span class="n">reduced_code</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">parser</span><span class="p">)</span> <span class="ow">and</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">is_minimized</span><span class="p">(</span><span class="n">reduced_code</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">get_minimized</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">run_tests</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        run all public tests</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">passed_tests</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">test</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_cases</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_test</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                <span class="n">passed_tests</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;In total </span><span class="si">{</span><span class="n">passed_tests</span><span class="si">}</span><span class="s2"> tests passed&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;returns True if the parser fails to parse the source&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;HAS PROPERTY: FAIL&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="n">ParserException</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;HAS PROPERTY: OK&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;HAS PROPERTY: FAIL </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">is_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduced</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reference</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the AST of the reduced code contains </span>
<span class="sd">        no more then the number of nodes in the reference + a THRESHOLD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count_minimized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_nodes</span><span class="p">(</span><span class="n">reduced</span><span class="p">)</span>
        <span class="n">count_reference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_nodes</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count_minimized</span> <span class="o">&lt;=</span> <span class="n">count_reference</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">THRESHOLD</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;IS MINIMIZED: OK&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;IS MINIMIZED: FAIL&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's test our <code>ReducingDebugger</code> with the following test:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Test0</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">Parser1</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_original</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">if a and b:</span>
<span class="s1">    c = 1</span>
<span class="s1">else:</span>
<span class="s1">    c = 2</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">a and b&#39;&#39;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span> <span class="o">=</span> <span class="n">TestingFramework</span><span class="p">(</span><span class="n">ReducingDebugger</span><span class="p">)</span>
<span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">run_test</span><span class="p">(</span><span class="n">Test0</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Running test Test0
HAS PROPERTY: OK
IS MINIMIZED: OK
Success!
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The input program was successfully minimized.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>What if we run all public tests?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">run_tests</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Running test Test1
HAS PROPERTY: OK
IS MINIMIZED: FAIL
Running test Test2
HAS PROPERTY: OK
IS MINIMIZED: FAIL
Running test Test3
HAS PROPERTY: OK
IS MINIMIZED: FAIL
Running test Test4
HAS PROPERTY: OK
IS MINIMIZED: FAIL
Running test Test5
HAS PROPERTY: OK
IS MINIMIZED: FAIL
In total 0 tests passed
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Unfortunately, our parser failed to minimize all input programs from the public test suite.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Grading">Grading<a class="anchor-link" href="#Grading">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For this project, you can get a total of 30 Points:</p>
<ul>
<li>15 Points will be awarded for passing the public test (<strong>without hardcoding the minimized solution or the sequence of transformations</strong>) presented in this notebook.
These 15 points mean that you successfully implemented the must-have implementation.</li>
<li>5 Points will be awarded for passing secret tests.</li>
<li>10 Points will be awarded for efficient implementation (see may-have implementation).</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Must-have-Features">Must-have Features<a class="anchor-link" href="#Must-have-Features">&#182;</a></h3><p>Implement a reducer which minifies a given program so that its parser still produces an error.
To this end, collect all possible transformations over the nodes of an AST tree and then apply one change at a time.
These modifications should be repeated until no further updates can be made without triggering a parser exception.
If your reducer passes secret test you are awarded additional 5 points.</p>
<p><em>Note: Implementing the given modifications should be sufficient to successfully complete this project.</em></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="May-have-Features">May-have Features<a class="anchor-link" href="#May-have-Features">&#182;</a></h3><p>An implementation only of the must-have features aims for correctness but can be inefficient (if transformations are applied one at a time). So, it can be optimized, for instance, with help of the Delta Debugging approach.</p>
<p>Implement an AST Delta Debugger which efficiently prunes the nodes.
If your reducer can beat the runtime of our reference implementation (which simply collects all possible transformations and applies them randomly one at a time) you can get up to 10 points (depending on the margin).</p>
<p>Hint: The <a href="https://www.debuggingbook.org/beta/html/DeltaDebugger.html">Reducing Failure-Inducing Inputs chapter</a> already tries to optimize the reduction of the AST with help of Delta Debugging.<br>
Hint: For instance, you can find useful <em>Hierarchical Delta Debugging</em> paper from the Background section of <strong>Reducing Failure-Inducing Inputs</strong> Chapter.</p>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Creative Commons License">
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target=_blank>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/debuggingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/debuggingbook/commits/master/notebooks/Reducing_Code.ipynb" target=_blank)>Last change: 2021-10-13 14:26:39+02:00</a> &bull; 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> &bull;
<a href="https://cispa.de/en/impressum" target=_blank>Imprint</a>
</p>

<script>
function revealCitation() {
    var c = document.getElementById("citation");
    c.style.display = "block";
}
</script>

<div id="citation" class="citation" style="display: none;">
<a name="citation"></a>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller: "<a href="https://www.debuggingbook.org/html/Reducing_Code.html">Second Project</a>".  In Andreas Zeller, "<a href="https://www.debuggingbook.org/">The Debugging Book</a>", <a href="https://www.debuggingbook.org/html/Reducing_Code.html">https://www.debuggingbook.org/html/Reducing_Code.html</a>.  Retrieved 2021-10-13 14:26:39+02:00.
</p>
<pre>
@incollection{debuggingbook2021:Reducing_Code,
    author = {Andreas Zeller},
    booktitle = {The Debugging Book},
    title = {Second Project},
    year = {2021},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.debuggingbook.org/html/Reducing_Code.html}},
    note = {Retrieved 2021-10-13 14:26:39+02:00},
    url = {https://www.debuggingbook.org/html/Reducing_Code.html},
    urldate = {2021-10-13 14:26:39+02:00}
}
</pre>
</div>

      </div>
    </div>
    </article>

 </body>

</html>