<!-- A html document -->
<!-- 
with standard nbconvert css layout
with standard nbconvert input/output content
standard html tag wrapping
with mathjax loaded
with jupyter wigets
 caption and label elements according to ipub meta tags  
with fuzzingbook adaptations -->None
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /><title>Isolating Failure-Inducing Changes - The Debugging Book</title>

<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
    </style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true }
    }
});
</script>
<!-- End of mathjax configuration --><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<!--[if IE lte 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<style type="text/css">
.ipyfigure { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipyfigure>div { flex:1; }
.ipytable { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipytable>div { flex:1; }

</style>

<link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,500,700|Raleway:300|Source+Code+Pro|Open+Sans' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<meta property="og:url" content="https://www.debuggingbook.org/beta/html/ChangeDebugger.html" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Isolating Failure-Inducing Changes - The Debugging Book" />
<meta property="og:description" content="&quot;Yesterday, my program worked. Today, it does not. Why?&quot; In debugging, as elsewhere in software development, code keeps on changing. Thus, it can happen that a piece of code that yesterday was working perfectly, today no longer runs – because we (or others) have made some changes to it that cause it to fail. The good news is that for debugging, we can actually exploit this version history to narrow down the changes that caused the failure – be it by us or by others.Prerequisites You should have read the Chapter on Delta Debugging. Knowledge on version control systems (notably git) will be useful." />
<meta property="og:image" content="https://www.debuggingbook.org/beta/html/PICS/wordcloud.png" />

<meta name="twitter:dnt" content="on">

<link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon.png">

<meta name="msapplication-TileColor" content="#B03A2E">
<meta name="msapplication-config" content="favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">

<meta name="viewport" content="width=device-width, initial-scale=1"></head>
 <body>

    <script>
    var close_menus = function() {
        /* doesn't work yet - AZ
        console.log("Closing menus")
        var cssmenu = document.getElementById("cssmenu")
        var all_items = cssmenu.getElementsByTagName("li");
        var i;
        for (i = 0; i < all_items.length; i++) {
            item = all_items[i];
            // console.log("<li>: ")
            // console.log(item.innerHTML);
            var j;
            var all_ul = item.getElementsByTagName("ul");
            for (j = 0; j < all_ul.length; j++) {
                console.log("<ul>: ")
                console.log(all_ul[j].innerHTML);
                all_ul[j].style.display = "none";
            }
            var all_ol = item.getElementsByTagName("ol");
            for (j = 0; j < all_ol.length; j++) {
                console.log("<ol>: ")
                console.log(all_ol[j].innerHTML);
                all_ol[j].style.display = "none";
            }
        }
        */
    };

    $( document ).ready( close_menus );

    // Let navbar fade away when scrolling down
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
        var currentScrollPos = window.pageYOffset;
        if (currentScrollPos > 10 && currentScrollPos > prevScrollpos) {
            // Hide navbar
            var cssmenu = document.getElementById("cssmenu")
            cssmenu.style.opacity = 0;

            // When scrolling, also close all sub-menus
            close_menus();
        }
        else {
            // Make navbar visible
            document.getElementById("cssmenu").style.opacity = 1;
        }
        prevScrollpos = currentScrollPos;
    };
    </script>
    
<nav>
<div id="cssmenu">
  <ul>
     <li class="has-sub"><a href="#"><span title="The Debugging Book"><i class="fa fa-fw fa-bars"></i> </span><span class="menu_1">The Debugging Book&nbsp;<i class="fa fa-fw fa-wrench"></i></span></a>
        <ol>
           
<li><a href="https://www.debuggingbook.org/beta/"><span class="part_number"><i class="fa fa-fw fa-home"></i></span> About this book</a></li>
<li><a href="https://www.debuggingbook.org/beta/html/00_Table_of_Contents.html"><i class="fa fa-fw fa-sitemap"></i></span> Sitemap</a></li>
<li class="has-sub"><a href="01_Intro.html" class="chapters"><span class="part_number">I</span> Whetting Your Appetite <strong class="new_chapter">&bull;</strong> <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tours.html">Tours through the Book <strong class="new_chapter">&bull;</strong></a></li>
<li><a href="Intro_Debugging.html">Introduction to Debugging <strong class="new_chapter">&bull;</strong></a></li>
</ul><li class="has-sub"><a href="02_Observing.html" class="chapters"><span class="part_number">II</span> Observing Executions <strong class="new_chapter">&bull;</strong> <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracer.html">Tracing Executions <strong class="new_chapter">&bull;</strong></a></li>
<li><a href="Debugger.html">How Debuggers Work <strong class="new_chapter">&bull;</strong></a></li>
<li><a href="Assertions.html">Asserting Expectations</a></li>
<li><a href="PerformanceDebugger.html">Debugging Performance Issues&nbsp;<i class="fa fa-fw fa-wrench"></i></a></li>
</ul><li class="has-sub"><a href="03_Dependencies.html" class="chapters"><span class="part_number">III</span> Flows and Dependencies <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Slicer.html">Tracking Failure Origins</a></li>
</ul><li class="has-sub"><a href="04_Reducing.html" class="chapters"><span class="part_number">IV</span> Reducing Failure Causes <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="DeltaDebugger.html">Reducing Failure-Inducing Inputs</a></li>
<li><a href="ChangeDebugger.html" class="this_page">Isolating Failure-Inducing Changes</a></li>
<li><a href="ThreadDebugger.html">Debugging Concurrent Programs&nbsp;<i class="fa fa-fw fa-wrench"></i></a></li>
</ul><li class="has-sub"><a href="05_Abstracting.html" class="chapters"><span class="part_number">V</span> Abstracting Failures <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="StatisticalDebugger.html">Statistical Debugging</a></li>
<li><a href="DynamicInvariants.html">Mining Function Specifications</a></li>
<li><a href="DDSetDebugger.html">Generalizing Failure Circumstances</a></li>
</ul><li class="has-sub"><a href="06_Repairing.html" class="chapters"><span class="part_number">VI</span> Automatic Repair <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Repairer.html">Repairing Code Automatically</a></li>
</ul><li class="has-sub"><a href="07_In_the_Large.html" class="chapters"><span class="part_number">VII</span> Debugging in the Large <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracking.html">Tracking Bugs</a></li>
<li><a href="ChangeCounter.html">Where the Bugs are</a></li>
</ul><li class="has-sub"><a href="99_Appendices.html" class="chapters">Appendices <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="ExpectError.html">Error Handling</a></li>
<li><a href="Timer.html">Timer</a></li>
<li><a href="ClassDiagram.html">Class Diagrams</a></li>
<li><a href="StackInspector.html">Inspecting Call Stacks</a></li>
</ul>
           <li><a href="https://www.debuggingbook.org/beta/html/00_Index.html">Index (beta)</a></i></li>
        </ol>
     </li>
     <li class="has-sub"><a href="#"><span title="Isolating Failure-Inducing Changes"><i class="fa fa-fw fa-list-ul"></i></span> <span class="menu_2">Isolating Failure-Inducing Changes</span></a>
           <ul><li class="has-sub"><a href="#Synopsis"><i class="fa fa-fw fa-map"></i> Synopsis</a>
<ul><li class="has-sub"><a href="#High-Level-Interface">High-Level Interface</a>
</li><li class="has-sub"><a href="#Programmatic-Interface">Programmatic Interface</a>
</li><li class="has-sub"><a href="#Supporting-Functions">Supporting Functions</a>
</ul></li><li class="has-sub"><a href="#Changes-and-Bugs">&nbsp;&bull;&nbsp;&nbsp; Changes and Bugs</a>
</li><li class="has-sub"><a href="#Leveraging-Version-Histories">&nbsp;&bull;&nbsp;&nbsp; Leveraging Version Histories</a>
</li><li class="has-sub"><a href="#An-Example-Version-History">&nbsp;&bull;&nbsp;&nbsp; An Example Version History</a>
<ul><li class="has-sub"><a href="#Create-a-Working-Directory">Create a Working Directory</a>
</li><li class="has-sub"><a href="#Initialize-Git">Initialize Git</a>
</li><li class="has-sub"><a href="#Excursion:-Adding-More-Revisions">Excursion: Adding More Revisions</a>
</ul></li><li class="has-sub"><a href="#Accessing-Versions">&nbsp;&bull;&nbsp;&nbsp; Accessing Versions</a>
</li><li class="has-sub"><a href="#Manual-Bisecting">&nbsp;&bull;&nbsp;&nbsp; Manual Bisecting</a>
</li><li class="has-sub"><a href="#Automatic-Bisecting">&nbsp;&bull;&nbsp;&nbsp; Automatic Bisecting</a>
</li><li class="has-sub"><a href="#Computing-and-Applying-Patches">&nbsp;&bull;&nbsp;&nbsp; Computing and Applying Patches</a>
</li><li class="has-sub"><a href="#Delta-Debugging-on-Patches">&nbsp;&bull;&nbsp;&nbsp; Delta Debugging on Patches</a>
<ul><li class="has-sub"><a href="#A-Minimal-Set-of-Patches">A Minimal Set of Patches</a>
</li><li class="has-sub"><a href="#A-Minimal-Difference">A Minimal Difference</a>
</ul></li><li class="has-sub"><a href="#A-ChangeDebugger-class">&nbsp;&bull;&nbsp;&nbsp; A ChangeDebugger class</a>
<ul><li class="has-sub"><a href="#High-Level-Interface">High-Level Interface</a>
</li><li class="has-sub"><a href="#Programmatic-Interface">Programmatic Interface</a>
</li><li class="has-sub"><a href="#Supporting-Functions">Supporting Functions</a>
</ul></li><li class="has-sub"><a href="#Lessons-Learned"><i class="fa fa-fw fa-trophy"></i> Lessons Learned</a>
</li><li class="has-sub"><a href="#Next-Steps"><i class="fa fa-fw fa-arrows"></i> Next Steps</a>
</li><li class="has-sub"><a href="#Background"><i class="fa fa-fw fa-mortar-board"></i> Background</a>
</li><li class="has-sub"><a href="#Exercises"><i class="fa fa-fw fa-edit"></i> Exercises</a>
<ul><li class="has-sub"><a href="#Exercise-1:-Fine-Grained-Changes">Exercise 1: Fine-Grained Changes</a>
</ul></li></ul></li>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Resources"><i class="fa fa-fw fa-cube"></i> </span><span class="menu_3">Resources</span></a>
     <ul>
     <li><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/ChangeDebugger.ipynb" target="_blank" class="edit_as_notebook"><i class="fa fa-fw fa-edit"></i> Edit as Notebook</a></li>
     <li><a href="https://www.debuggingbook.org/beta/slides/ChangeDebugger.slides.html" target="_blank"><i class="fa fa-fw fa-video-camera"></i> View Slides</a></li>
     <li><a href="https://www.debuggingbook.org/beta/code/ChangeDebugger.py"><i class="fa fa-fw fa-download"></i> Download Code (.py)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/notebooks/ChangeDebugger.ipynb"><i class="fa fa-fw fa-download"></i> Download Notebook (.ipynb)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-code.zip"><i class="fa fa-fw fa-cube"></i> All Code (.zip)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-notebooks.zip"><i class="fa fa-fw fa-cube"></i> All Notebooks (.zip)</a></li>
     <li><a href="https://github.com/uds-se/debuggingbook/" target="_blank"><i class="fa fa-fw fa-github"></i> Project Page</a></li>
     <li><a href="ReleaseNotes.html" target="_blank"><i class="fa fa-fw fa-calendar"></i> Release Notes</a></li>
     </ul>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Share"><i class="fa fa-fw fa-comments"></i> </span> <span class="menu_4">Share</span></a>
        <ul>
            <li><a href="https://twitter.com/intent/tweet?text=I%20just%20read%20%22Isolating%20Failure-Inducing%20Changes%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fChangeDebugger.html" target="popup" 
onclick="window.open('https://twitter.com/intent/tweet?text=I%20just%20read%20%22Isolating%20Failure-Inducing%20Changes%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fChangeDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-twitter"></i> Share on Twitter</a>
            <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fChangeDebugger.html" target="popup" 
onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fChangeDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-facebook"></i> Share on Facebook</a>
            <li><a href="mailto:?subject=Isolating%20Failure-Inducing%20Changes&body=I%20just%20read%20%22Isolating%20Failure-Inducing%20Changes%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fChangeDebugger.html"><i class="fa fa-fw fa-envelope"></i> Share by Email</a>
            <li><a href="#citation" id="cite" onclick="revealCitation()"><i class="fa fa-fw fa-mortar-board"></i> Cite</a>
        </ul>
     </li>
     <li class="has-sub"><a href="#"><span title="Help"><i class="fa fa-fw fa-question-circle"></i></span> <span class="menu_5">Help</span></a>
        <ul>
          <li><a href="https://www.debuggingbook.org/beta/#Troubleshooting"><i class="fa fa-fw fa-wrench"></i> Troubleshooting</a></li>
          <li><a href="https://docs.python.org/3/tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Python Tutorial</a>
          <li><a href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Jupyter Notebook Tutorial</a>
          <li><a href="https://github.com/uds-se/debuggingbook/issues/" target="_blank"><i class="fa fa-fw fa-commenting"></i> Report an Issue</a></li>
        </ul>
     </li>
  </ul>
</div>
</nav>

    <article>
   <div tabindex="-1" id="notebook" class="border-box-sizing">
     <div class="container" id="notebook-container">

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="Isolating-Failure-Inducing-Changes">Isolating Failure-Inducing Changes<a class="anchor-link" href="#Isolating-Failure-Inducing-Changes">&#182;</a></h1><p><em class="beta"><i class="fa fa-fw fa-warning"></i>&nbsp;This chapter is still under review ("beta").  It may change at any time.</em></p><p>"Yesterday, my program worked. Today, it does not. Why?" In debugging, as elsewhere in software development, code keeps on changing. Thus, it can happen that a piece of code that yesterday was working perfectly, today no longer runs – because we (or others) have made some changes to it that cause it to fail. The good news is that for debugging, we can actually <em>exploit</em> this version history to narrow down <em>the changes that caused the failure</em> – be it by us or by others.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook/tree/master/notebooks/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;hX9ViNEXGL8&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

        <iframe
            width="640"
            height="360"
            src="https://www.youtube-nocookie.com/embed/hX9ViNEXGL8"
            frameborder="0"
            allowfullscreen
        ></iframe>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Prerequisites</strong></p>
<ul>
<li>You should have read the <a href="DeltaDebugger.html">Chapter on Delta Debugging</a>.</li>
<li>Knowledge on version control systems (notably git) will be useful.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook/tree/master/notebooks/bookutils" class="import" target="_blank">bookutils</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook/tree/master/notebooks/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">quiz</span><span class="p">,</span> <span class="n">print_file</span><span class="p">,</span> <span class="n">print_content</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="synopsis"><h2 id="Synopsis">Synopsis<a class="anchor-link" href="#Synopsis">&#182;</a></h2><!-- Automatically generated. Do not edit. -->

<p>To <a href="Importing.html">use the code provided in this chapter</a>, write</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="ChangeDebugger.html" class="import" target="_blank">debuggingbook.ChangeDebugger</a></span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
<p>and then make use of the following features.</p>
<p>This chapter introduces a class <code>ChangeDebugger</code> that automatically determines failure-inducing code changes.</p>
<h3 id="High-Level-Interface">High-Level Interface<a class="anchor-link" href="#High-Level-Interface">&#182;</a></h3><p>Given two source files <code>source_pass</code> and <code>source_fail</code>, where <code>failing_function()</code> raises an exception in <code>source_pass</code>, but not in <code>source_fail</code>, you can use <code>ChangeDebugger</code> as follows:</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">ChangeDebugger</span><span class="p">(</span><span class="n">source_pass</span><span class="p">,</span> <span class="n">source_fail</span><span class="p">)</span> <span class="k">as</span> <span class="n">cd</span><span class="p">:</span>
    <span class="n">failing_function</span><span class="p">()</span>
<span class="n">cd</span>
</pre></div>
<p>This will produce the failure-inducing change between <code>source_pass</code> and <code>source_fail</code>, using <a href="DeltaDebugger.html">Delta Debugging</a> to determine minimal differences in patches applied.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">version_1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>    <span class="c1"># start of markup</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>  <span class="c1"># end of markup</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">version_2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">ChangeDebugger</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_2</span><span class="p">)</span> <span class="k">as</span> <span class="n">cd</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">test_remove_html_markup</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cd</span>

<span class="o">@@</span> <span class="o">-</span><span class="mi">215</span><span class="p">,</span><span class="mi">24</span> <span class="o">+</span><span class="mi">215</span><span class="p">,</span><span class="mi">97</span> <span class="o">@@</span>
 <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>

<span class="o">+</span>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>

         <span class="k">elif</span>
</pre></div>
<h3 id="Programmatic-Interface">Programmatic Interface<a class="anchor-link" href="#Programmatic-Interface">&#182;</a></h3><p>A programmatic interface is also available. The method <code>min_patches()</code> returns a triple (<code>pass_patches</code>, <code>fail_patches</code>, <code>diffs</code>) where</p>
<ul>
<li>applying <code>pass_patches</code> causes the call to pass</li>
<li>applying <code>fail_patches</code> causes the call to fail</li>
<li><code>diffs</code> is the (minimal) difference between the two.</li>
</ul>
<p>The patches come as list of <code>patch_obj</code> objects, as defined by Google's <a href="https://github.com/google/diff-match-patch">diff-match-patch library</a>.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">pass_patches</span><span class="p">,</span> <span class="n">fail_patches</span><span class="p">,</span> <span class="n">diffs</span> <span class="o">=</span> <span class="n">cd</span><span class="o">.</span><span class="n">min_patches</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">diffs</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">print_patch</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="o">@@</span> <span class="o">-</span><span class="mi">215</span><span class="p">,</span><span class="mi">24</span> <span class="o">+</span><span class="mi">215</span><span class="p">,</span><span class="mi">97</span> <span class="o">@@</span>
 <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>

<span class="o">+</span>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>

         <span class="k">elif</span>
</pre></div>
<p>The full set of methods in <code>ChangeDebugger</code> is shown below.</p>
<p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="296pt" height="547pt"
 viewBox="0.00 0.00 295.50 547.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 543)">
<title>%3</title>
<g id="a_graph0"><a xlink:title="ChangeDebugger class hierarchy">
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-543 291.5,-543 291.5,4 -4,4"/>
</a>
</g>
<!-- ChangeDebugger -->
<g id="node1" class="node">
<title>ChangeDebugger</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class ChangeDebugger:&#10;Collect an exception&#45;raising function call f().&#10;Use as `with CallCollector(): f()`">
<polygon fill="none" stroke="#000000" points="15.5,-.5 15.5,-130.5 151.5,-130.5 151.5,-.5 15.5,-.5"/>
<text text-anchor="start" x="23.5" y="-116.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">ChangeDebugger</text>
<polyline fill="none" stroke="#000000" points="15.5,-107.5 151.5,-107.5 "/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="ChangeDebugger">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Called at begin of a `with` block. Checks if current source fails.">
<text text-anchor="start" x="29.5" y="-96" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00" fill="#000000">__enter__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="__init__(self, pass_source:str, fail_source:str, **ddargs:Any) &#45;&gt; None:&#10;Constructor. Takes a passing source file (`pass_source`)&#10;and a failing source file (`fail_source`).&#10;Additional arguments are passed to `DeltaDebugger` constructor.">
<text text-anchor="start" x="29.5" y="-85" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00" fill="#000000">__init__()</text>
</a>
</g>
<g id="a_node1_3"><a xlink:href="#" xlink:title="__repr__(self) &#45;&gt; str:&#10;Return readable list of minimal patches">
<text text-anchor="start" x="29.5" y="-74" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">__repr__()</text>
</a>
</g>
<g id="a_node1_4"><a xlink:href="#" xlink:title="fail_source(self) &#45;&gt; str:&#10;Return the failing source file.">
<text text-anchor="start" x="29.5" y="-63" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">fail_source()</text>
</a>
</g>
<g id="a_node1_5"><a xlink:href="#" xlink:title="min_patches(self) &#45;&gt; Tuple[List[diff_match_patch.diff_match_patch.patch_obj], List[diff_match_patch.diff_match_patch.patch_obj], List[diff_match_patch.diff_match_patch.patch_obj]]:&#10;Compute a minimal set of patches.&#10;Returns a triple (`pass_patches`, `fail_patches`, `diff_patches`)&#10;where `diff_patches` is the minimal difference between&#10;the set `pass_patches` (which, when applied, make the test pass) and&#10;the set `fail_patches` (which, when applied, make the test fail).">
<text text-anchor="start" x="29.5" y="-52" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">min_patches()</text>
</a>
</g>
<g id="a_node1_6"><a xlink:href="#" xlink:title="pass_source(self) &#45;&gt; str:&#10;Return the passing source file.">
<text text-anchor="start" x="29.5" y="-41" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">pass_source()</text>
</a>
</g>
<g id="a_node1_7"><a xlink:href="#" xlink:title="patches(self) &#45;&gt; List[diff_match_patch.diff_match_patch.patch_obj]:&#10;Return the diff between passing and failing source files.">
<text text-anchor="start" x="29.5" y="-30" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">patches()</text>
</a>
</g>
<g id="a_node1_8"><a xlink:href="#" xlink:title="after_collection(self) &#45;&gt; None:&#10;Diagnostics.">
<text text-anchor="start" x="29.5" y="-19" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00" fill="#000000">after_collection()</text>
</a>
</g>
<g id="a_node1_9"><a xlink:href="#" xlink:title="test_patches(self, patches:List[diff_match_patch.diff_match_patch.patch_obj]) &#45;&gt; None">
<text text-anchor="start" x="29.5" y="-7" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">test_patches()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CallCollector -->
<g id="node2" class="node">
<title>CallCollector</title>
<g id="a_node2"><a xlink:href="DeltaDebugger.html" xlink:title="class CallCollector:&#10;Collect an exception&#45;raising function call f().&#10;Use as `with CallCollector(): f()`">
<polygon fill="none" stroke="#000000" points="21,-167.5 21,-330.5 146,-330.5 146,-167.5 21,-167.5"/>
<text text-anchor="start" x="38.5" y="-316.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">CallCollector</text>
<polyline fill="none" stroke="#000000" points="21,-307.5 146,-307.5 "/>
<g id="a_node2_10"><a xlink:href="#" xlink:title="CallCollector">
<g id="a_node2_11"><a xlink:href="DeltaDebugger.html" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Called at begin of `with` block. Turn tracing on.">
<text text-anchor="start" x="29.5" y="-296.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00" fill="#000000">__enter__()</text>
</a>
</g>
<g id="a_node2_12"><a xlink:href="DeltaDebugger.html" xlink:title="__exit__(self, exc_tp:Type, exc_value:BaseException, exc_traceback:traceback) &#45;&gt; Union[bool, NoneType]:&#10;Called at end of `with` block. Turn tracing off.">
<text text-anchor="start" x="29.5" y="-285.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">__exit__()</text>
</a>
</g>
<g id="a_node2_13"><a xlink:href="DeltaDebugger.html" xlink:title="__init__(self) &#45;&gt; None:&#10;Initialize collector">
<text text-anchor="start" x="29.5" y="-274.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00" fill="#000000">__init__()</text>
</a>
</g>
<g id="a_node2_14"><a xlink:href="DeltaDebugger.html" xlink:title="args(self) &#45;&gt; Dict[str, Any]:&#10;Return the dictionary of collected arguments.">
<text text-anchor="start" x="29.5" y="-263.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">args()</text>
</a>
</g>
<g id="a_node2_15"><a xlink:href="DeltaDebugger.html" xlink:title="call(self, new_args:Union[Dict[str, Any], NoneType]=None) &#45;&gt; Any:&#10;Call collected function. If `new_args` is given,&#10;override arguments from its {var: value} entries.">
<text text-anchor="start" x="29.5" y="-252.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">call()</text>
</a>
</g>
<g id="a_node2_16"><a xlink:href="DeltaDebugger.html" xlink:title="exception(self) &#45;&gt; Union[BaseException, NoneType]:&#10;Return the exception produced, or `None` if none.">
<text text-anchor="start" x="29.5" y="-241.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">exception()</text>
</a>
</g>
<g id="a_node2_17"><a xlink:href="DeltaDebugger.html" xlink:title="function(self) &#45;&gt; Callable:&#10;Return the function called.">
<text text-anchor="start" x="29.5" y="-230.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">function()</text>
</a>
</g>
<g id="a_node2_18"><a xlink:href="DeltaDebugger.html" xlink:title="after_collection(self) &#45;&gt; None:&#10;Called after collection. To be defined in subclasses.">
<text text-anchor="start" x="29.5" y="-219.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00" fill="#000000">after_collection()</text>
</a>
</g>
<g id="a_node2_19"><a xlink:href="DeltaDebugger.html" xlink:title="format_call(self, args:Union[Dict[str, Any], NoneType]=None) &#45;&gt; str:&#10;Return a string representing a call of the function with given args.">
<text text-anchor="start" x="29.5" y="-207.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">format_call()</text>
</a>
</g>
<g id="a_node2_20"><a xlink:href="DeltaDebugger.html" xlink:title="format_exception(self, exc:Union[BaseException, NoneType]=None) &#45;&gt; str:&#10;Return a string representing the given exception.">
<text text-anchor="start" x="29.5" y="-196.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">format_exception()</text>
</a>
</g>
<g id="a_node2_21"><a xlink:href="DeltaDebugger.html" xlink:title="init(self) &#45;&gt; None:&#10;Reset for new collection.">
<text text-anchor="start" x="29.5" y="-185.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">init()</text>
</a>
</g>
<g id="a_node2_22"><a xlink:href="DeltaDebugger.html" xlink:title="traceit(self, frame:frame, event:str, arg:Any) &#45;&gt; None:&#10;Tracing function. Collect first call, then turn tracing off.">
<text text-anchor="start" x="29.5" y="-174.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">traceit()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- ChangeDebugger&#45;&gt;CallCollector -->
<g id="edge1" class="edge">
<title>ChangeDebugger&#45;&gt;CallCollector</title>
<path fill="none" stroke="#000000" d="M83.5,-130.7119C83.5,-139.3192 83.5,-148.2675 83.5,-157.2161"/>
<polygon fill="none" stroke="#000000" points="80.0001,-157.3015 83.5,-167.3015 87.0001,-157.3015 80.0001,-157.3015"/>
</g>
<!-- StackInspector -->
<g id="node3" class="node">
<title>StackInspector</title>
<g id="a_node3"><a xlink:href="StackInspector.html" xlink:title="class StackInspector:&#10;Provide functions to inspect the stack">
<polygon fill="none" stroke="#000000" points="0,-367.5 0,-538.5 167,-538.5 167,-367.5 0,-367.5"/>
<text text-anchor="start" x="32.5" y="-524.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">StackInspector</text>
<polyline fill="none" stroke="#000000" points="0,-515.5 167,-515.5 "/>
<g id="a_node3_23"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_24"><a xlink:href="StackInspector.html" xlink:title="_generated_function_cache = {(&#39;test_patches&#39;, 2): &lt;function test_patches at 0x7ff7a4527400&gt;}">
<text text-anchor="start" x="8.5" y="-503" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">_generated_function_cache</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="#000000" points="0,-496.5 167,-496.5 "/>
<g id="a_node3_25"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_26"><a xlink:href="StackInspector.html" xlink:title="caller_frame(self) &#45;&gt; frame:&#10;Return the frame of the caller.">
<text text-anchor="start" x="26.5" y="-484" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_frame()</text>
</a>
</g>
<g id="a_node3_27"><a xlink:href="StackInspector.html" xlink:title="caller_function(self) &#45;&gt; Callable:&#10;Return the calling function">
<text text-anchor="start" x="26.5" y="-473" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_function()</text>
</a>
</g>
<g id="a_node3_28"><a xlink:href="StackInspector.html" xlink:title="caller_globals(self) &#45;&gt; Dict[str, Any]:&#10;Return the globals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-462" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_globals()</text>
</a>
</g>
<g id="a_node3_29"><a xlink:href="StackInspector.html" xlink:title="caller_locals(self) &#45;&gt; Dict[str, Any]:&#10;Return the locals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-451" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_locals()</text>
</a>
</g>
<g id="a_node3_30"><a xlink:href="StackInspector.html" xlink:title="caller_location(self) &#45;&gt; Tuple[Callable, int]:&#10;Return the location (func, lineno) of the caller.">
<text text-anchor="start" x="26.5" y="-440" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_location()</text>
</a>
</g>
<g id="a_node3_31"><a xlink:href="StackInspector.html" xlink:title="create_function(self, frame:frame) &#45;&gt; Callable:&#10;Create function for given frame">
<text text-anchor="start" x="26.5" y="-429" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">create_function()</text>
</a>
</g>
<g id="a_node3_32"><a xlink:href="StackInspector.html" xlink:title="is_internal_error(self, exc_tp:Type, exc_value:BaseException, exc_traceback:traceback) &#45;&gt; bool:&#10;Return True if exception was raised from `StackInspector` or a subclass.">
<text text-anchor="start" x="26.5" y="-418" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">is_internal_error()</text>
</a>
</g>
<g id="a_node3_33"><a xlink:href="StackInspector.html" xlink:title="our_frame(self, frame:frame) &#45;&gt; bool:&#10;Return true if `frame` is in the current (inspecting) class.">
<text text-anchor="start" x="26.5" y="-407" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">our_frame()</text>
</a>
</g>
<g id="a_node3_34"><a xlink:href="StackInspector.html" xlink:title="search_frame(self, name:str, frame:Union[frame, NoneType]=None) &#45;&gt; Tuple[Union[frame, NoneType], Union[Callable, NoneType]]:&#10;Return a pair (`frame`, `item`)&#10;in which the function `name` is defined as `item`.">
<text text-anchor="start" x="26.5" y="-396" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">search_frame()</text>
</a>
</g>
<g id="a_node3_35"><a xlink:href="StackInspector.html" xlink:title="search_func(self, name:str, frame:Union[frame, NoneType]=None) &#45;&gt; Union[Callable, NoneType]:&#10;Search in callers for a definition of the function `name`">
<text text-anchor="start" x="26.5" y="-385" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">search_func()</text>
</a>
</g>
<g id="a_node3_36"><a xlink:href="StackInspector.html" xlink:title="unknown(self) &#45;&gt; None">
<text text-anchor="start" x="26.5" y="-374" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">unknown()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CallCollector&#45;&gt;StackInspector -->
<g id="edge2" class="edge">
<title>CallCollector&#45;&gt;StackInspector</title>
<path fill="none" stroke="#000000" d="M83.5,-330.5057C83.5,-339.2948 83.5,-348.2957 83.5,-357.2325"/>
<polygon fill="none" stroke="#000000" points="80.0001,-357.2806 83.5,-367.2806 87.0001,-357.2806 80.0001,-357.2806"/>
</g>
<!-- Legend -->
<g id="node4" class="node">
<title>Legend</title>
<text text-anchor="start" x="169.5" y="-83" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="10.00" fill="#6a0dad">Legend</text>
<text text-anchor="start" x="169.5" y="-73" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00" fill="#000000">• </text>
<text text-anchor="start" x="176.5" y="-73" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00" fill="#000000">public_method()</text>
<text text-anchor="start" x="169.5" y="-63" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00" fill="#000000">• </text>
<text text-anchor="start" x="176.5" y="-63" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00" fill="#000000">private_method()</text>
<text text-anchor="start" x="169.5" y="-53" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00" fill="#000000">• </text>
<text text-anchor="start" x="176.5" y="-53" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00" fill="#000000">overloaded_method()</text>
<text text-anchor="start" x="169.5" y="-43.8" font-family="Helvetica,sans-Serif" font-size="9.00" fill="#000000">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
<h3 id="Supporting-Functions">Supporting Functions<a class="anchor-link" href="#Supporting-Functions">&#182;</a></h3><p><code>ChangeDebugger</code> relies on lower level <code>patch()</code> and <code>diff()</code> functions.</p>
<p>To apply patch objects on source code, use the <code>patch()</code> function. It takes a source code and a list of patches to be applied.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">diffs</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>    <span class="c1"># start of markup</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>  <span class="c1"># end of markup</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>
<p>Conversely, the <code>diff()</code> function computes patches between two texts. It returns a list of patch objects that can be applied on text.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">diff</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_2</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">print_patch</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="o">@@</span> <span class="o">-</span><span class="mi">48</span><span class="p">,</span><span class="mi">24</span> <span class="o">+</span><span class="mi">48</span><span class="p">,</span><span class="mi">42</span> <span class="o">@@</span>
 <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>

<span class="o">+</span>    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>

     <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">@@</span> <span class="o">-</span><span class="mi">104</span><span class="p">,</span><span class="mi">50</span> <span class="o">+</span><span class="mi">104</span><span class="p">,</span><span class="mi">43</span> <span class="o">@@</span>
  <span class="n">s</span><span class="p">:</span>

<span class="o">-</span>        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>    <span class="c1"># start of markup</span>

<span class="o">+</span>        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span><span class="o">@@</span> <span class="o">-</span><span class="mi">162</span><span class="p">,</span><span class="mi">48</span> <span class="o">+</span><span class="mi">162</span><span class="p">,</span><span class="mi">45</span> <span class="o">@@</span>
 <span class="n">rue</span>

<span class="o">-</span>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>  <span class="c1"># end of markup</span>

<span class="o">+</span>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span><span class="o">@@</span> <span class="o">-</span><span class="mi">215</span><span class="p">,</span><span class="mi">24</span> <span class="o">+</span><span class="mi">215</span><span class="p">,</span><span class="mi">97</span> <span class="o">@@</span>
 <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>

<span class="o">+</span>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>

         <span class="k">elif</span>
</pre></div>
</div>
</div>
</div>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Changes-and-Bugs">Changes and Bugs<a class="anchor-link" href="#Changes-and-Bugs">&#182;</a></h2><p>When you develop software, it is unlikely that you will be able to produce a fully working piece of software right from the beginning – hence the need for debugging. It is just as unlikely, though, that your software will stay <em>unchanged</em> forever. Evolving requirements, the introduction of new technology, changes in the environment all induce software changes – and every such change brings the risk of introducing new bugs.</p>
<p>To detect such bugs introduced by changes, systematic (and best automatic) <em>testing</em>, notably <em>regression testing</em>, can be a big help; in fact, the more comprehensive and the more automated your testing strategy is, the more it actually <em>enables</em> evolving your software, because every new test lowers the risk of a change introducing a bug. Extensive testing is what enables agile development – and we're happy to point to our <a href="https://www.fuzzingbook.org">sibling book on test generation</a> to give you some inspiration on how to do this.</p>
<p>However, a test can only <em>detect</em> failures, not <em>fix</em> them. The more you change, the more you may need to fix, too. The good news is that there are a number of debugging techniques, manual and automated, that can actually <em>exploit</em> the presence of older, working software versions to effectively narrow down the causes of failure in a new, failing software.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Leveraging-Version-Histories">Leveraging Version Histories<a class="anchor-link" href="#Leveraging-Version-Histories">&#182;</a></h2><p>The fundamental prerequisite for exploiting older, working software versions is to have such older, working versions in the first place. If your software <em>always</em> failed, then you will have to resort to conventional debugging. But if there is an older <em>working</em> version, you can make use of it.</p>
<p>We assume that you do have a <em>version repository</em> such as git or SVN, which you use to organize software development and keep older software versions.  (If you do <em>not</em> use version control for your project, you are in <a href="Intro_Debugging.html">debugging hell</a>. Go and set it up now, and come back once you're done.)</p>
<p>If you have a version history, an older working version, and a new failing version, your situation is roughly as depicted in this diagram:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/typing.html" class="import" target="_blank">typing</a></span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">TextIO</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Type</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="692pt" height="44pt"
 viewBox="0.00 0.00 692.00 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-40 688,-40 688,4 -4,4"/>
<!-- v1 -->
<g id="node1" class="node">
<title>v1</title>
<polygon fill="#ffdab9" stroke="#000000" points="54,-36 0,-36 0,0 54,0 54,-36"/>
<text text-anchor="middle" x="27" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v1 ✔</text>
</g>
<!-- v2 -->
<g id="node2" class="node">
<title>v2</title>
<polygon fill="#ffdab9" stroke="#000000" points="144,-36 90,-36 90,0 144,0 144,-36"/>
<text text-anchor="middle" x="117" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v2</text>
</g>
<!-- v1&#45;&gt;v2 -->
<g id="edge1" class="edge">
<title>v1&#45;&gt;v2</title>
<path fill="none" stroke="#000000" d="M54.003,-18C62.0277,-18 70.9665,-18 79.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="79.7051,-21.5001 89.705,-18 79.705,-14.5001 79.7051,-21.5001"/>
</g>
<!-- v3 -->
<g id="node3" class="node">
<title>v3</title>
<polygon fill="#ffdab9" stroke="#000000" points="234,-36 180,-36 180,0 234,0 234,-36"/>
<text text-anchor="middle" x="207" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v3</text>
</g>
<!-- v2&#45;&gt;v3 -->
<g id="edge2" class="edge">
<title>v2&#45;&gt;v3</title>
<path fill="none" stroke="#000000" d="M144.003,-18C152.0277,-18 160.9665,-18 169.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="169.7051,-21.5001 179.705,-18 169.705,-14.5001 169.7051,-21.5001"/>
</g>
<!-- v4 -->
<g id="node4" class="node">
<title>v4</title>
<polygon fill="#ffdab9" stroke="#000000" points="324,-36 270,-36 270,0 324,0 324,-36"/>
<text text-anchor="middle" x="297" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v4</text>
</g>
<!-- v3&#45;&gt;v4 -->
<g id="edge3" class="edge">
<title>v3&#45;&gt;v4</title>
<path fill="none" stroke="#000000" d="M234.003,-18C242.0277,-18 250.9665,-18 259.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="259.7051,-21.5001 269.705,-18 259.705,-14.5001 259.7051,-21.5001"/>
</g>
<!-- v5 -->
<g id="node5" class="node">
<title>v5</title>
<polygon fill="#ffdab9" stroke="#000000" points="414,-36 360,-36 360,0 414,0 414,-36"/>
<text text-anchor="middle" x="387" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v5</text>
</g>
<!-- v4&#45;&gt;v5 -->
<g id="edge4" class="edge">
<title>v4&#45;&gt;v5</title>
<path fill="none" stroke="#000000" d="M324.003,-18C332.0277,-18 340.9665,-18 349.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="349.7051,-21.5001 359.705,-18 349.705,-14.5001 349.7051,-21.5001"/>
</g>
<!-- v6 -->
<g id="node6" class="node">
<title>v6</title>
<polygon fill="#ffdab9" stroke="#000000" points="504,-36 450,-36 450,0 504,0 504,-36"/>
<text text-anchor="middle" x="477" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v6</text>
</g>
<!-- v5&#45;&gt;v6 -->
<g id="edge5" class="edge">
<title>v5&#45;&gt;v6</title>
<path fill="none" stroke="#000000" d="M414.003,-18C422.0277,-18 430.9665,-18 439.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="439.7051,-21.5001 449.705,-18 439.705,-14.5001 439.7051,-21.5001"/>
</g>
<!-- v7 -->
<g id="node7" class="node">
<title>v7</title>
<polygon fill="#ffdab9" stroke="#000000" points="594,-36 540,-36 540,0 594,0 594,-36"/>
<text text-anchor="middle" x="567" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v7</text>
</g>
<!-- v6&#45;&gt;v7 -->
<g id="edge6" class="edge">
<title>v6&#45;&gt;v7</title>
<path fill="none" stroke="#000000" d="M504.003,-18C512.0277,-18 520.9665,-18 529.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="529.7051,-21.5001 539.705,-18 529.705,-14.5001 529.7051,-21.5001"/>
</g>
<!-- v8 -->
<g id="node8" class="node">
<title>v8</title>
<polygon fill="#ffdab9" stroke="#000000" points="684,-36 630,-36 630,0 684,0 684,-36"/>
<text text-anchor="middle" x="657" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v8 ✘</text>
</g>
<!-- v7&#45;&gt;v8 -->
<g id="edge7" class="edge">
<title>v7&#45;&gt;v8</title>
<path fill="none" stroke="#000000" d="M594.003,-18C602.0277,-18 610.9665,-18 619.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="619.7051,-21.5001 629.705,-18 619.705,-14.5001 619.7051,-21.5001"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Somewhere between the old version "v1" ("yesterday") and the current version "v8" ("today"), the software stopped working. But when exactly? And which change was it that caused the failure?</p>
<p>You may think that this is an easy task: We simply manually test one version after another, thus determining the exact version that first failed. However,</p>
<ul>
<li>this can take a long time (notably in the presence of dozens or even hundreds of versions);</li>
<li>this may still leave you with <em>dozens of changes</em> applied from one version to another; and</li>
<li>this is actually a task that can be <em>fully automated</em>.</li>
</ul>
<p>And these "automated" debugging techniques are what we explore in this chapter.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="An-Example-Version-History">An Example Version History<a class="anchor-link" href="#An-Example-Version-History">&#182;</a></h2><p>As our ongoing example, we start with creating a little version history, using the git version management system. We follow the evolution of the <code>remove_html_markup()</code> versions from <a href="Intro_Debugging.html">the introduction to debugging</a> and <a href="Assertions.html">the chapter on assertions</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Create-a-Working-Directory">Create a Working Directory<a class="anchor-link" href="#Create-a-Working-Directory">&#182;</a></h3><p>We start with creating a working folder (aptly named <code>my_project</code>) in which we will do our work. (Note: should you have a folder of that name, it will be deleted and re-initialized).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">PROJECT</span> <span class="o">=</span> <span class="s1">&#39;my_project&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/os.html" class="import" target="_blank">os</a></span>
<span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/shutil.html" class="import" target="_blank">shutil</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">PROJECT</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We choose the project folder as our working directory. Any file we create will be created in that folder.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/sys.html" class="import" target="_blank">sys</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">PROJECT</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Initialize-Git">Initialize Git<a class="anchor-link" href="#Initialize-Git">&#182;</a></h3><p>We set up a local Git repository in our local project folder.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git init
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Initialized empty Git repository in /Users/zeller/Projects/debuggingbook/notebooks/my_project/.git/
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git config user.name <span class="s2">&quot;Demo User&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git config user.email <span class="s2">&quot;demo-user@example.com&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git config advice.detachedHead False
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We are now ready to commit our first version. Here's the initial definition of <code>remove_html_markup()</code> from <a href="Intro_Debugging.html">the introduction to debugging</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>    <span class="c1"># start of markup</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>  <span class="c1"># end of markup</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The function <code>write_source()</code> takes a function <code>fun</code> and writes its source code into a file of the same name – in our case, <code>remove_html_markup.py</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/inspect.html" class="import" target="_blank">inspect</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">write_source</span><span class="p">(</span><span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">fun</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is <code>write_source()</code> in action:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:    <span class="ansi-white-fg"># start of markup</span>
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With <code>git add</code> and <code>git commit</code>, we add the file to our version repository. The <code>-m</code> option defines a <em>message</em> for the commit; this is how we (and potential co-workers_ can later retrieve information on what has changed, and why. (The messages we use here are deliberately kept short.)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git add remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;First version&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master (root-commit) 3499a6a] First version
 1 file changed, 13 insertions(+)
 create mode 100644 remove_html_markup.py
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us now take the second (buggy) version of <code>remove_html_markup()</code> and again write this into our file, thus simulating changing the source code from the first version to the new version:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can inspect the differences between the previously committed version and the current one. Lines prefixed with <code>+</code> are added; lines prefixed with <code>-</code> are deleted.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git diff remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold">diff --git a/remove_html_markup.py b/remove_html_markup.py</span>
<span class="ansi-bold">index 4999dc0..768bae9 100644</span>
<span class="ansi-bold">--- a/remove_html_markup.py</span>
<span class="ansi-bold">+++ b/remove_html_markup.py</span>
<span class="ansi-cyan-fg">@@ -1,12 +1,15 @@</span>
 def remove_html_markup(s):  # type: ignore
     tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">    quote = False</span>
     out = &#34;&#34;

     for c in s:
<span class="ansi-red-fg">-        if c == &#39;&lt;&#39;:    # start of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        if c == &#39;&lt;&#39; and not quote:</span>
             tag = True
<span class="ansi-red-fg">-        elif c == &#39;&gt;&#39;:  # end of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&gt;&#39; and not quote:</span>
             tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&#34;&#39; or c == &#34;&#39;&#34; and tag:</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">            quote = not quote</span>
         elif not tag:
             out = out + c
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can now commit this second version, adding it to our repository.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;Second version&quot;</span> remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master a871b70] Second version
 1 file changed, 5 insertions(+), 2 deletions(-)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We create a few more revisions.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Adding-More-Revisions">
<summary>Adding More Revisions</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We use the additional definitions for <code>remove_html_markup()</code> from <a href="Intro_Debugging.html">the introduction to debugging</a> as additional versions.</p>
<p>These also include "debugging" versions with enabled logging statements, as well as "tentative" versions that may or may not fix the discussed issues. In a real version history, such transient versions would typically not show up – or at least not be made available to co-workers.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c =&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="s2">&quot;tag =&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="s2">&quot;quote =&quot;</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;Third version (with debugging output)&quot;</span> remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master 92c2c0c] Third version (with debugging output)
 1 file changed, 2 insertions(+)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>  <span class="c1"># and not quote:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>  <span class="c1"># and not quote:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;Fourth version (clueless)&quot;</span> remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master dba1264] Fourth version (clueless)
 1 file changed, 2 insertions(+), 4 deletions(-)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">tag</span>  <span class="c1"># &lt;=== Just added</span>

        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;Fifth version (with assert)&quot;</span> remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master 6b030f5] Fifth version (with assert)
 1 file changed, 4 insertions(+), 2 deletions(-)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span>  <span class="c1"># &lt;=== Just added</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;Sixth version (with another assert)&quot;</span> remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master 0ac7af1] Sixth version (with another assert)
 1 file changed, 1 insertion(+), 2 deletions(-)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>  <span class="c1"># &lt;-- FIX</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;Seventh version (fixed)&quot;</span> remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master 1fba67a] Seventh version (fixed)
 1 file changed, 1 insertion(+), 2 deletions(-)
</pre>
</div>

</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here comes the last version of <code>remove_html_markup()</code>, this one from <a href="Assertions.html">the chapter on assertions</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="c1"># postcondition</span>
    <span class="k">assert</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span> <span class="ow">and</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">write_source</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git commit -m <span class="s2">&quot;Eighth version (with proper assertion)&quot;</span> remove_html_markup.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[master 920bca3] Eighth version (with proper assertion)
 1 file changed, 4 insertions(+), 1 deletion(-)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We finally reached the "today" state with the latest version – and find that the latest version has an error. This should come to you as no surprise if you have read the earlier chapters. But if you haven't, you will find that when the argument <code>s</code> contains double quotes, these are stripped from the output:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;foo&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Consequently, this test assertion fails:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="ExpectError.html" class="import" target="_blank">ExpectError</a></span> <span class="kn">import</span> <span class="n">ExpectError</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&quot;foo&quot;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-839bf760c807&gt;&#34;, line 2, in &lt;module&gt;
    assert remove_html_markup(&#39;&#34;foo&#34;&#39;) == &#39;&#34;foo&#34;&#39;
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Note that the failure does <em>not</em> occur in the very first version, as introduced above. So the simple question is:</p>
<ul>
<li>What is the change that cause the failure?</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Accessing-Versions">Accessing Versions<a class="anchor-link" href="#Accessing-Versions">&#182;</a></h2><p>To find out the failure-inducing change, we first need to be able to access older versions. The command</p>
<div class="highlight"><pre><span></span>git log
</pre></div>
<p>gives us a listing of all commits. Using the <code>subprocess</code> module, we can run <code>git log</code> and access its output.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/subprocess.html" class="import" target="_blank">subprocess</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_output</span><span class="p">(</span><span class="n">command</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> 
                            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                            <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The output of <code>git log</code> contains the ID of the version (the so-called <em>commit hash</em>) as well as the message provided during the commit.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log</span> <span class="o">=</span> <span class="n">get_output</span><span class="p">([</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;--pretty=oneline&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>920bca375459146cdb43dd3dd88abe3f99fecd4e Eighth version (with proper assertion)
1fba67a22cebae7d94e946484685b62fb3374aea Seventh version (fixed)
0ac7af1b6d7b51f7dcf4433965fbb56c8f6d4da3 Sixth version (with another assert)
6b030f5bfdd1235d58f59ce7c4246b7bcfc1ead2 Fifth version (with assert)
dba1264c9fb5e3ed6a368a5b1a97691931b3e108 Fourth version (clueless)
92c2c0cf3aba2ed92af41370069c8ca92391e850 Third version (with debugging output)
a871b708412a2c550442b196125dc9a27c6a565b Second version
3499a6a6f3c7de93885b19d6e3b82f5fec4f6a8a First version
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Each hash uniquely identifies a version, and is required to access it. Let us create a list <code>versions</code>, where <code>versions[0]</code> contains the hash (the id) of the first version, <code>versions[1]</code> the second version, and so on.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">versions</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">log</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="p">]</span>
<span class="n">versions</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="n">versions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;3499a6a6f3c7de93885b19d6e3b82f5fec4f6a8a&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can now check out the first version:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git checkout <span class="o">{</span>versions<span class="o">[</span><span class="m">0</span><span class="o">]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>HEAD is now at 3499a6a First version
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:    <span class="ansi-white-fg"># start of markup</span>
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we read in this definition of <code>remove_html_markup()</code> from the first version, we will find that the failure was not yet present:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exec</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&#34;foo&#34;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>However, if we check out the <em>last</em> version of that file ...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git checkout <span class="o">{</span>versions<span class="o">[</span><span class="m">7</span><span class="o">]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Previous HEAD position was 3499a6a First version
HEAD is now at 920bca3 Eighth version (with proper assertion)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-white-fg"># postcondition</span>
    <span class="ansi-blue-fg">assert</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out <span class="ansi-magenta-fg">and</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... we find that this is the version that no longer works.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exec</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;foo&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Manual-Bisecting">Manual Bisecting<a class="anchor-link" href="#Manual-Bisecting">&#182;</a></h2><p>As stated above, we could now go and try out one version after another to see with which version the bug was introduced. But again, proceeding in such a <em>linear</em> fashion would be very inefficient. It is much better to proceed by <em>binary search</em>: If you know that version $v_n$ passed, and version $v_m$ failed (with $m &gt;n$), then test a version $v' = v_{n + (m - n)/2}$ that is right in the <em>middle</em> between the two.</p>
<ul>
<li>If $v'$ passes, then repeat the process with $v'$ and $v_m$.</li>
<li>If $v'$ fails, then repeat the process with $v_n$ and $v'$.</li>
</ul>
<p>Such <em>bisecting</em> quickly progresses towards the failure-inducing version, as it requires you to take only a logarithmic number of tests. In contrast, progressing linearly through the version history requires a test for each version, which is far more effort.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If you use the git version control system, such bisecting is actually a <em>built-in feature</em>, coming to you through the <code>git bisect</code> command. Let us illustrate how <code>git bisect</code> quickly identifies the version that introduced the error.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A bisecting section with <code>git</code> starts with the command <code>bisect start</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect start
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Then, you use <code>git bisect good</code> to identify the version that worked, and <code>git bisect bad</code> to identify the version that was bad – in our case, the hashes of the first and last version.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect good <span class="o">{</span>versions<span class="o">[</span><span class="m">0</span><span class="o">]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect bad <span class="o">{</span>versions<span class="o">[</span><span class="m">7</span><span class="o">]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Bisecting: 3 revisions left to test after this (roughly 2 steps)
[dba1264c9fb5e3ed6a368a5b1a97691931b3e108] Fourth version (clueless)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We find that <code>git bisect</code> automatically has checked out the <code>middle</code> version between the passing and the failing one – in our case, version 4 – and now asks us to assess this version.</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="692pt" height="44pt"
 viewBox="0.00 0.00 692.00 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-40 688,-40 688,4 -4,4"/>
<!-- v1 -->
<g id="node1" class="node">
<title>v1</title>
<polygon fill="#ffdab9" stroke="#000000" points="54,-36 0,-36 0,0 54,0 54,-36"/>
<text text-anchor="middle" x="27" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v1 ✔</text>
</g>
<!-- v2 -->
<g id="node2" class="node">
<title>v2</title>
<polygon fill="#ffdab9" stroke="#000000" points="144,-36 90,-36 90,0 144,0 144,-36"/>
<text text-anchor="middle" x="117" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v2</text>
</g>
<!-- v1&#45;&gt;v2 -->
<g id="edge1" class="edge">
<title>v1&#45;&gt;v2</title>
<path fill="none" stroke="#000000" d="M54.003,-18C62.0277,-18 70.9665,-18 79.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="79.7051,-21.5001 89.705,-18 79.705,-14.5001 79.7051,-21.5001"/>
</g>
<!-- v3 -->
<g id="node3" class="node">
<title>v3</title>
<polygon fill="#ffdab9" stroke="#000000" points="234,-36 180,-36 180,0 234,0 234,-36"/>
<text text-anchor="middle" x="207" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v3</text>
</g>
<!-- v2&#45;&gt;v3 -->
<g id="edge2" class="edge">
<title>v2&#45;&gt;v3</title>
<path fill="none" stroke="#000000" d="M144.003,-18C152.0277,-18 160.9665,-18 169.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="169.7051,-21.5001 179.705,-18 169.705,-14.5001 169.7051,-21.5001"/>
</g>
<!-- v4 -->
<g id="node4" class="node">
<title>v4</title>
<polygon fill="#ffdab9" stroke="#000000" points="324,-36 270,-36 270,0 324,0 324,-36"/>
<text text-anchor="middle" x="297" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v4 ?</text>
</g>
<!-- v3&#45;&gt;v4 -->
<g id="edge3" class="edge">
<title>v3&#45;&gt;v4</title>
<path fill="none" stroke="#000000" d="M234.003,-18C242.0277,-18 250.9665,-18 259.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="259.7051,-21.5001 269.705,-18 259.705,-14.5001 259.7051,-21.5001"/>
</g>
<!-- v5 -->
<g id="node5" class="node">
<title>v5</title>
<polygon fill="#ffdab9" stroke="#000000" points="414,-36 360,-36 360,0 414,0 414,-36"/>
<text text-anchor="middle" x="387" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v5</text>
</g>
<!-- v4&#45;&gt;v5 -->
<g id="edge4" class="edge">
<title>v4&#45;&gt;v5</title>
<path fill="none" stroke="#000000" d="M324.003,-18C332.0277,-18 340.9665,-18 349.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="349.7051,-21.5001 359.705,-18 349.705,-14.5001 349.7051,-21.5001"/>
</g>
<!-- v6 -->
<g id="node6" class="node">
<title>v6</title>
<polygon fill="#ffdab9" stroke="#000000" points="504,-36 450,-36 450,0 504,0 504,-36"/>
<text text-anchor="middle" x="477" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v6</text>
</g>
<!-- v5&#45;&gt;v6 -->
<g id="edge5" class="edge">
<title>v5&#45;&gt;v6</title>
<path fill="none" stroke="#000000" d="M414.003,-18C422.0277,-18 430.9665,-18 439.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="439.7051,-21.5001 449.705,-18 439.705,-14.5001 439.7051,-21.5001"/>
</g>
<!-- v7 -->
<g id="node7" class="node">
<title>v7</title>
<polygon fill="#ffdab9" stroke="#000000" points="594,-36 540,-36 540,0 594,0 594,-36"/>
<text text-anchor="middle" x="567" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v7</text>
</g>
<!-- v6&#45;&gt;v7 -->
<g id="edge6" class="edge">
<title>v6&#45;&gt;v7</title>
<path fill="none" stroke="#000000" d="M504.003,-18C512.0277,-18 520.9665,-18 529.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="529.7051,-21.5001 539.705,-18 529.705,-14.5001 529.7051,-21.5001"/>
</g>
<!-- v8 -->
<g id="node8" class="node">
<title>v8</title>
<polygon fill="#ffdab9" stroke="#000000" points="684,-36 630,-36 630,0 684,0 684,-36"/>
<text text-anchor="middle" x="657" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v8 ✘</text>
</g>
<!-- v7&#45;&gt;v8 -->
<g id="edge7" class="edge">
<title>v7&#45;&gt;v8</title>
<path fill="none" stroke="#000000" d="M594.003,-18C602.0277,-18 610.9665,-18 619.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="619.7051,-21.5001 629.705,-18 619.705,-14.5001 619.7051,-21.5001"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The version is already in our working folder:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># and not quote:</span>
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># and not quote:</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We now need to test this version, and let <code>git bisect</code> know the outcome – with</p>
<div class="highlight"><pre><span></span>git bisect good
</pre></div>
<p>if the test passes, and with</p>
<div class="highlight"><pre><span></span>git bisect bad
</pre></div>
<p>if the test fails.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>It turns out that this version fails:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exec</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;foo&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>So we enter <code>git bisect bad</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect bad
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Bisecting: 0 revisions left to test after this (roughly 1 step)
[92c2c0cf3aba2ed92af41370069c8ca92391e850] Third version (with debugging output)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><code>git bisect</code> has chosen version 3 to assess – again in the middle between a passing and a failing version:</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="692pt" height="44pt"
 viewBox="0.00 0.00 692.00 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-40 688,-40 688,4 -4,4"/>
<!-- v1 -->
<g id="node1" class="node">
<title>v1</title>
<polygon fill="#ffdab9" stroke="#000000" points="54,-36 0,-36 0,0 54,0 54,-36"/>
<text text-anchor="middle" x="27" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v1 ✔</text>
</g>
<!-- v2 -->
<g id="node2" class="node">
<title>v2</title>
<polygon fill="#ffdab9" stroke="#000000" points="144,-36 90,-36 90,0 144,0 144,-36"/>
<text text-anchor="middle" x="117" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v2</text>
</g>
<!-- v1&#45;&gt;v2 -->
<g id="edge1" class="edge">
<title>v1&#45;&gt;v2</title>
<path fill="none" stroke="#000000" d="M54.003,-18C62.0277,-18 70.9665,-18 79.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="79.7051,-21.5001 89.705,-18 79.705,-14.5001 79.7051,-21.5001"/>
</g>
<!-- v3 -->
<g id="node3" class="node">
<title>v3</title>
<polygon fill="#ffdab9" stroke="#000000" points="234,-36 180,-36 180,0 234,0 234,-36"/>
<text text-anchor="middle" x="207" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v3 ?</text>
</g>
<!-- v2&#45;&gt;v3 -->
<g id="edge2" class="edge">
<title>v2&#45;&gt;v3</title>
<path fill="none" stroke="#000000" d="M144.003,-18C152.0277,-18 160.9665,-18 169.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="169.7051,-21.5001 179.705,-18 169.705,-14.5001 169.7051,-21.5001"/>
</g>
<!-- v4 -->
<g id="node4" class="node">
<title>v4</title>
<polygon fill="#ffdab9" stroke="#000000" points="324,-36 270,-36 270,0 324,0 324,-36"/>
<text text-anchor="middle" x="297" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v4 ✘</text>
</g>
<!-- v3&#45;&gt;v4 -->
<g id="edge3" class="edge">
<title>v3&#45;&gt;v4</title>
<path fill="none" stroke="#000000" d="M234.003,-18C242.0277,-18 250.9665,-18 259.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="259.7051,-21.5001 269.705,-18 259.705,-14.5001 259.7051,-21.5001"/>
</g>
<!-- v5 -->
<g id="node5" class="node">
<title>v5</title>
<polygon fill="#ffdab9" stroke="#000000" points="414,-36 360,-36 360,0 414,0 414,-36"/>
<text text-anchor="middle" x="387" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v5</text>
</g>
<!-- v4&#45;&gt;v5 -->
<g id="edge4" class="edge">
<title>v4&#45;&gt;v5</title>
<path fill="none" stroke="#000000" d="M324.003,-18C332.0277,-18 340.9665,-18 349.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="349.7051,-21.5001 359.705,-18 349.705,-14.5001 349.7051,-21.5001"/>
</g>
<!-- v6 -->
<g id="node6" class="node">
<title>v6</title>
<polygon fill="#ffdab9" stroke="#000000" points="504,-36 450,-36 450,0 504,0 504,-36"/>
<text text-anchor="middle" x="477" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v6</text>
</g>
<!-- v5&#45;&gt;v6 -->
<g id="edge5" class="edge">
<title>v5&#45;&gt;v6</title>
<path fill="none" stroke="#000000" d="M414.003,-18C422.0277,-18 430.9665,-18 439.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="439.7051,-21.5001 449.705,-18 439.705,-14.5001 439.7051,-21.5001"/>
</g>
<!-- v7 -->
<g id="node7" class="node">
<title>v7</title>
<polygon fill="#ffdab9" stroke="#000000" points="594,-36 540,-36 540,0 594,0 594,-36"/>
<text text-anchor="middle" x="567" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v7</text>
</g>
<!-- v6&#45;&gt;v7 -->
<g id="edge6" class="edge">
<title>v6&#45;&gt;v7</title>
<path fill="none" stroke="#000000" d="M504.003,-18C512.0277,-18 520.9665,-18 529.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="529.7051,-21.5001 539.705,-18 529.705,-14.5001 529.7051,-21.5001"/>
</g>
<!-- v8 -->
<g id="node8" class="node">
<title>v8</title>
<polygon fill="#ffdab9" stroke="#000000" points="684,-36 630,-36 630,0 684,0 684,-36"/>
<text text-anchor="middle" x="657" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v8 ✘</text>
</g>
<!-- v7&#45;&gt;v8 -->
<g id="edge7" class="edge">
<title>v7&#45;&gt;v8</title>
<path fill="none" stroke="#000000" d="M594.003,-18C602.0277,-18 610.9665,-18 619.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="619.7051,-21.5001 629.705,-18 619.705,-14.5001 619.7051,-21.5001"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>So let us test this version and find that it fails, too:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-cyan-fg">print</span>(<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">c =</span><span class="ansi-yellow-fg">&#34;</span>, <span class="ansi-cyan-fg">repr</span>(c), <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">tag =</span><span class="ansi-yellow-fg">&#34;</span>, tag, <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">quote =</span><span class="ansi-yellow-fg">&#34;</span>, quote)

        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exec</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>c = &#39;&#34;&#39; tag = False quote = False
c = &#39;f&#39; tag = False quote = True
c = &#39;o&#39; tag = False quote = True
c = &#39;o&#39; tag = False quote = True
c = &#39;&#34;&#39; tag = False quote = True
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;foo&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We mark the version as <code>bad</code>. <code>git bisect</code> then checks out version 2 as the last version to assess,</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect bad
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Bisecting: 0 revisions left to test after this (roughly 0 steps)
[a871b708412a2c550442b196125dc9a27c6a565b] Second version
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="692pt" height="44pt"
 viewBox="0.00 0.00 692.00 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-40 688,-40 688,4 -4,4"/>
<!-- v1 -->
<g id="node1" class="node">
<title>v1</title>
<polygon fill="#ffdab9" stroke="#000000" points="54,-36 0,-36 0,0 54,0 54,-36"/>
<text text-anchor="middle" x="27" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v1 ✔</text>
</g>
<!-- v2 -->
<g id="node2" class="node">
<title>v2</title>
<polygon fill="#ffdab9" stroke="#000000" points="144,-36 90,-36 90,0 144,0 144,-36"/>
<text text-anchor="middle" x="117" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v2 ?</text>
</g>
<!-- v1&#45;&gt;v2 -->
<g id="edge1" class="edge">
<title>v1&#45;&gt;v2</title>
<path fill="none" stroke="#000000" d="M54.003,-18C62.0277,-18 70.9665,-18 79.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="79.7051,-21.5001 89.705,-18 79.705,-14.5001 79.7051,-21.5001"/>
</g>
<!-- v3 -->
<g id="node3" class="node">
<title>v3</title>
<polygon fill="#ffdab9" stroke="#000000" points="234,-36 180,-36 180,0 234,0 234,-36"/>
<text text-anchor="middle" x="207" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v3 ✘</text>
</g>
<!-- v2&#45;&gt;v3 -->
<g id="edge2" class="edge">
<title>v2&#45;&gt;v3</title>
<path fill="none" stroke="#000000" d="M144.003,-18C152.0277,-18 160.9665,-18 169.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="169.7051,-21.5001 179.705,-18 169.705,-14.5001 169.7051,-21.5001"/>
</g>
<!-- v4 -->
<g id="node4" class="node">
<title>v4</title>
<polygon fill="#ffdab9" stroke="#000000" points="324,-36 270,-36 270,0 324,0 324,-36"/>
<text text-anchor="middle" x="297" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v4 ✘</text>
</g>
<!-- v3&#45;&gt;v4 -->
<g id="edge3" class="edge">
<title>v3&#45;&gt;v4</title>
<path fill="none" stroke="#000000" d="M234.003,-18C242.0277,-18 250.9665,-18 259.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="259.7051,-21.5001 269.705,-18 259.705,-14.5001 259.7051,-21.5001"/>
</g>
<!-- v5 -->
<g id="node5" class="node">
<title>v5</title>
<polygon fill="#ffdab9" stroke="#000000" points="414,-36 360,-36 360,0 414,0 414,-36"/>
<text text-anchor="middle" x="387" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v5</text>
</g>
<!-- v4&#45;&gt;v5 -->
<g id="edge4" class="edge">
<title>v4&#45;&gt;v5</title>
<path fill="none" stroke="#000000" d="M324.003,-18C332.0277,-18 340.9665,-18 349.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="349.7051,-21.5001 359.705,-18 349.705,-14.5001 349.7051,-21.5001"/>
</g>
<!-- v6 -->
<g id="node6" class="node">
<title>v6</title>
<polygon fill="#ffdab9" stroke="#000000" points="504,-36 450,-36 450,0 504,0 504,-36"/>
<text text-anchor="middle" x="477" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v6</text>
</g>
<!-- v5&#45;&gt;v6 -->
<g id="edge5" class="edge">
<title>v5&#45;&gt;v6</title>
<path fill="none" stroke="#000000" d="M414.003,-18C422.0277,-18 430.9665,-18 439.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="439.7051,-21.5001 449.705,-18 439.705,-14.5001 439.7051,-21.5001"/>
</g>
<!-- v7 -->
<g id="node7" class="node">
<title>v7</title>
<polygon fill="#ffdab9" stroke="#000000" points="594,-36 540,-36 540,0 594,0 594,-36"/>
<text text-anchor="middle" x="567" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v7</text>
</g>
<!-- v6&#45;&gt;v7 -->
<g id="edge6" class="edge">
<title>v6&#45;&gt;v7</title>
<path fill="none" stroke="#000000" d="M504.003,-18C512.0277,-18 520.9665,-18 529.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="529.7051,-21.5001 539.705,-18 529.705,-14.5001 529.7051,-21.5001"/>
</g>
<!-- v8 -->
<g id="node8" class="node">
<title>v8</title>
<polygon fill="#ffdab9" stroke="#000000" points="684,-36 630,-36 630,0 684,0 684,-36"/>
<text text-anchor="middle" x="657" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v8 ✘</text>
</g>
<!-- v7&#45;&gt;v8 -->
<g id="edge7" class="edge">
<title>v7&#45;&gt;v8</title>
<path fill="none" stroke="#000000" d="M594.003,-18C602.0277,-18 610.9665,-18 619.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="619.7051,-21.5001 629.705,-18 619.705,-14.5001 619.7051,-21.5001"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When we test version 2, we find that it fails as well:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exec</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;remove_html_markup.py&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;foo&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Hence, version 2 is <em>the version that introduced the error</em>.</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="692pt" height="44pt"
 viewBox="0.00 0.00 692.00 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-40 688,-40 688,4 -4,4"/>
<!-- v1 -->
<g id="node1" class="node">
<title>v1</title>
<polygon fill="#ffdab9" stroke="#000000" points="54,-36 0,-36 0,0 54,0 54,-36"/>
<text text-anchor="middle" x="27" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v1 ✔</text>
</g>
<!-- v2 -->
<g id="node2" class="node">
<title>v2</title>
<polygon fill="#ffdab9" stroke="#000000" points="144,-36 90,-36 90,0 144,0 144,-36"/>
<text text-anchor="middle" x="117" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v2 ✘</text>
</g>
<!-- v1&#45;&gt;v2 -->
<g id="edge1" class="edge">
<title>v1&#45;&gt;v2</title>
<path fill="none" stroke="#000000" d="M54.003,-18C62.0277,-18 70.9665,-18 79.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="79.7051,-21.5001 89.705,-18 79.705,-14.5001 79.7051,-21.5001"/>
</g>
<!-- v3 -->
<g id="node3" class="node">
<title>v3</title>
<polygon fill="#ffdab9" stroke="#000000" points="234,-36 180,-36 180,0 234,0 234,-36"/>
<text text-anchor="middle" x="207" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v3 ✘</text>
</g>
<!-- v2&#45;&gt;v3 -->
<g id="edge2" class="edge">
<title>v2&#45;&gt;v3</title>
<path fill="none" stroke="#000000" d="M144.003,-18C152.0277,-18 160.9665,-18 169.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="169.7051,-21.5001 179.705,-18 169.705,-14.5001 169.7051,-21.5001"/>
</g>
<!-- v4 -->
<g id="node4" class="node">
<title>v4</title>
<polygon fill="#ffdab9" stroke="#000000" points="324,-36 270,-36 270,0 324,0 324,-36"/>
<text text-anchor="middle" x="297" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v4 ✘</text>
</g>
<!-- v3&#45;&gt;v4 -->
<g id="edge3" class="edge">
<title>v3&#45;&gt;v4</title>
<path fill="none" stroke="#000000" d="M234.003,-18C242.0277,-18 250.9665,-18 259.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="259.7051,-21.5001 269.705,-18 259.705,-14.5001 259.7051,-21.5001"/>
</g>
<!-- v5 -->
<g id="node5" class="node">
<title>v5</title>
<polygon fill="#ffdab9" stroke="#000000" points="414,-36 360,-36 360,0 414,0 414,-36"/>
<text text-anchor="middle" x="387" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v5</text>
</g>
<!-- v4&#45;&gt;v5 -->
<g id="edge4" class="edge">
<title>v4&#45;&gt;v5</title>
<path fill="none" stroke="#000000" d="M324.003,-18C332.0277,-18 340.9665,-18 349.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="349.7051,-21.5001 359.705,-18 349.705,-14.5001 349.7051,-21.5001"/>
</g>
<!-- v6 -->
<g id="node6" class="node">
<title>v6</title>
<polygon fill="#ffdab9" stroke="#000000" points="504,-36 450,-36 450,0 504,0 504,-36"/>
<text text-anchor="middle" x="477" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v6</text>
</g>
<!-- v5&#45;&gt;v6 -->
<g id="edge5" class="edge">
<title>v5&#45;&gt;v6</title>
<path fill="none" stroke="#000000" d="M414.003,-18C422.0277,-18 430.9665,-18 439.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="439.7051,-21.5001 449.705,-18 439.705,-14.5001 439.7051,-21.5001"/>
</g>
<!-- v7 -->
<g id="node7" class="node">
<title>v7</title>
<polygon fill="#ffdab9" stroke="#000000" points="594,-36 540,-36 540,0 594,0 594,-36"/>
<text text-anchor="middle" x="567" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v7</text>
</g>
<!-- v6&#45;&gt;v7 -->
<g id="edge6" class="edge">
<title>v6&#45;&gt;v7</title>
<path fill="none" stroke="#000000" d="M504.003,-18C512.0277,-18 520.9665,-18 529.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="529.7051,-21.5001 539.705,-18 529.705,-14.5001 529.7051,-21.5001"/>
</g>
<!-- v8 -->
<g id="node8" class="node">
<title>v8</title>
<polygon fill="#ffdab9" stroke="#000000" points="684,-36 630,-36 630,0 684,0 684,-36"/>
<text text-anchor="middle" x="657" y="-14.3" font-family="Raleway" font-size="14.00" fill="#000000">v8 ✘</text>
</g>
<!-- v7&#45;&gt;v8 -->
<g id="edge7" class="edge">
<title>v7&#45;&gt;v8</title>
<path fill="none" stroke="#000000" d="M594.003,-18C602.0277,-18 610.9665,-18 619.5309,-18"/>
<polygon fill="#000000" stroke="#000000" points="619.7051,-21.5001 629.705,-18 619.705,-14.5001 619.7051,-21.5001"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When we let <code>git bisect</code> know that this version fails, it tells us that this version is indeed the "first bad commit":</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect bad
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>a871b708412a2c550442b196125dc9a27c6a565b is the first bad commit
<span class="ansi-yellow-fg">commit a871b708412a2c550442b196125dc9a27c6a565b</span>
Author: Demo User &lt;demo-user@example.com&gt;
Date:   Fri Mar 12 00:48:41 2021 +0100

    Second version

 remove_html_markup.py | 7 <span class="ansi-green-fg">+++++</span><span class="ansi-red-fg">--</span>
 1 file changed, 5 insertions(+), 2 deletions(-)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>By comparing this version against the older one, we can see the lines it introduced – namely (buggy) handling of double quotes:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git diff HEAD^
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold">diff --git a/remove_html_markup.py b/remove_html_markup.py</span>
<span class="ansi-bold">index 4999dc0..768bae9 100644</span>
<span class="ansi-bold">--- a/remove_html_markup.py</span>
<span class="ansi-bold">+++ b/remove_html_markup.py</span>
<span class="ansi-cyan-fg">@@ -1,12 +1,15 @@</span>
 def remove_html_markup(s):  # type: ignore
     tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">    quote = False</span>
     out = &#34;&#34;

     for c in s:
<span class="ansi-red-fg">-        if c == &#39;&lt;&#39;:    # start of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        if c == &#39;&lt;&#39; and not quote:</span>
             tag = True
<span class="ansi-red-fg">-        elif c == &#39;&gt;&#39;:  # end of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&gt;&#39; and not quote:</span>
             tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&#34;&#39; or c == &#34;&#39;&#34; and tag:</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">            quote = not quote</span>
         elif not tag:
             out = out + c
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now that we have identified the failure-inducing change ("something is wrong in <code>remove_html_markup()</code>, and it has to do with quote handling"), we can end our <code>git bisect</code> session. <code>git bisect reset</code> gets us back to the start, such that we can fix the most recent version.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect reset
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Previous HEAD position was a871b70 Second version
HEAD is now at 920bca3 Eighth version (with proper assertion)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Automatic-Bisecting">Automatic Bisecting<a class="anchor-link" href="#Automatic-Bisecting">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Even though manual bisecting can be quick, we can speed things up by writing a <em>script</em> that does the testing for us. With such a script, we can have <code>git bisect</code> run fully automatically.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A test script to automate bisecting does the following:</p>
<ul>
<li>It (re)builds the program under test for the given version</li>
<li>It tests whether the failure is present.</li>
</ul>
<p>Its exit code indicates the test outcome:</p>
<ul>
<li>0 means "good" (the failure did not occur)</li>
<li>1 means "bad" (the failure did occur)</li>
<li>125 means "undetermined" (we cannot decide if the failure is present or not)</li>
</ul>
<p>The latter ("undetermined") case may occur if the program fails to build, or shows some other behavior.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We use a Python script <code>test.py</code> that reads in <code>remove_html_markup.py</code> and then tests for the presence or absence of the failure. (Since this is Python, we don't have to rebuild things.)</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>262
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_file</span><span class="p">(</span><span class="s1">&#39;test.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-white-fg">#!/usr/bin/env python</span>

<span class="ansi-blue-fg">from</span> <span class="ansi-cyan-fg ansi-underline">remove_html_markup</span> <span class="ansi-blue-fg">import</span> remove_html_markup
<span class="ansi-blue-fg">import</span> <span class="ansi-cyan-fg ansi-underline">sys</span>

result = remove_html_markup(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">foo</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span>)
<span class="ansi-blue-fg">if</span> result == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">foo</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span>:
    sys.exit(<span class="ansi-blue-fg">0</span>)  <span class="ansi-white-fg"># good/pass</span>
<span class="ansi-blue-fg">elif</span> result == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">foo</span><span class="ansi-yellow-fg">&#39;</span>:
    sys.exit(<span class="ansi-blue-fg">1</span>)  <span class="ansi-white-fg"># bad/fail</span>
<span class="ansi-blue-fg">else</span>:
    sys.exit(<span class="ansi-blue-fg">125</span>)  <span class="ansi-white-fg"># unresolved</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Right now, we are with version 8 and thus in the "failing" state – our script exits with a code of 1:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>python ./test.py<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$?</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us use our test script to bisect automatically. As with manual bisecting, we first have to tell <code>git bisect</code> which the good (passing) and bad (failing) versions are:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect start
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect good <span class="o">{</span>versions<span class="o">[</span><span class="m">0</span><span class="o">]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect bad <span class="o">{</span>versions<span class="o">[</span><span class="m">7</span><span class="o">]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Bisecting: 3 revisions left to test after this (roughly 2 steps)
[dba1264c9fb5e3ed6a368a5b1a97691931b3e108] Fourth version (clueless)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now, we can make use of our script. <code>git bisect run &lt;script&gt;</code> automatically determines the failing version. In our case, <code>&lt;script&gt;</code> is <code>python test.py</code>, and it produces the failing version in less than a second:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect run python test.py
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running python test.py
Bisecting: 0 revisions left to test after this (roughly 1 step)
[92c2c0cf3aba2ed92af41370069c8ca92391e850] Third version (with debugging output)
running python test.py
c = &#39;&#34;&#39; tag = False quote = False
c = &#39;f&#39; tag = False quote = True
c = &#39;o&#39; tag = False quote = True
c = &#39;o&#39; tag = False quote = True
c = &#39;&#34;&#39; tag = False quote = True
Bisecting: 0 revisions left to test after this (roughly 0 steps)
[a871b708412a2c550442b196125dc9a27c6a565b] Second version
running python test.py
a871b708412a2c550442b196125dc9a27c6a565b is the first bad commit
commit a871b708412a2c550442b196125dc9a27c6a565b
Author: Demo User &lt;demo-user@example.com&gt;
Date:   Fri Mar 12 00:48:41 2021 +0100

    Second version

 remove_html_markup.py | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
bisect run success
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, we are at version 2, and can investigate the failure-inducing change:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git diff HEAD^
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold">diff --git a/remove_html_markup.py b/remove_html_markup.py</span>
<span class="ansi-bold">index 4999dc0..768bae9 100644</span>
<span class="ansi-bold">--- a/remove_html_markup.py</span>
<span class="ansi-bold">+++ b/remove_html_markup.py</span>
<span class="ansi-cyan-fg">@@ -1,12 +1,15 @@</span>
 def remove_html_markup(s):  # type: ignore
     tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">    quote = False</span>
     out = &#34;&#34;

     for c in s:
<span class="ansi-red-fg">-        if c == &#39;&lt;&#39;:    # start of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        if c == &#39;&lt;&#39; and not quote:</span>
             tag = True
<span class="ansi-red-fg">-        elif c == &#39;&gt;&#39;:  # end of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&gt;&#39; and not quote:</span>
             tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&#34;&#39; or c == &#34;&#39;&#34; and tag:</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">            quote = not quote</span>
         elif not tag:
             out = out + c
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With <code>git bisect run</code> as well, we have to end our bisecting session:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git bisect reset
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Previous HEAD position was a871b70 Second version
HEAD is now at 920bca3 Eighth version (with proper assertion)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Computing-and-Applying-Patches">Computing and Applying Patches<a class="anchor-link" href="#Computing-and-Applying-Patches">&#182;</a></h2><p>Even if a version control system allows us to identify the change that introduced the failure, a single change between versions can still affect multiple locations. The change between version 1 and version 2 of <code>remove_html_markup()</code>, above, for instance, affects four separate locations in a single function. In the real world, changes between versions may affect dozens or even hundreds of locations. The question is:</p>
<ul>
<li>Can we break down changes further down to individual locations?</li>
</ul>
<p>The answer is yes! But for this, we first need a means to break down changes into smaller parts. These parts are called <em>patches</em> – differences in individual code locations that can be determined and applied individually.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To illustrate how to compute and apply patches, let us have an example. We access the source code of the first and second version of <code>remove_html_markup()</code>, respectively:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">version_1</span> <span class="o">=</span> <span class="n">get_output</span><span class="p">([</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span> 
                            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">versions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">:remove_html_markup.py&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:    <span class="ansi-white-fg"># start of markup</span>
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">version_2</span> <span class="o">=</span> <span class="n">get_output</span><span class="p">([</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span> 
                            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">versions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">:remove_html_markup.py&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">version_2</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Patches are what a tool like <code>diff</code> produces when comparing two files (or <code>git diff</code> when comparing two versions). Here, we see that the difference between the two files consists of four patches, each one affecting a different line in the program.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git diff <span class="o">{</span>versions<span class="o">[</span><span class="m">0</span><span class="o">]}</span> <span class="o">{</span>versions<span class="o">[</span><span class="m">1</span><span class="o">]}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold">diff --git a/remove_html_markup.py b/remove_html_markup.py</span>
<span class="ansi-bold">index 4999dc0..768bae9 100644</span>
<span class="ansi-bold">--- a/remove_html_markup.py</span>
<span class="ansi-bold">+++ b/remove_html_markup.py</span>
<span class="ansi-cyan-fg">@@ -1,12 +1,15 @@</span>
 def remove_html_markup(s):  # type: ignore
     tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">    quote = False</span>
     out = &#34;&#34;

     for c in s:
<span class="ansi-red-fg">-        if c == &#39;&lt;&#39;:    # start of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        if c == &#39;&lt;&#39; and not quote:</span>
             tag = True
<span class="ansi-red-fg">-        elif c == &#39;&gt;&#39;:  # end of markup</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&gt;&#39; and not quote:</span>
             tag = False
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">        elif c == &#39;&#34;&#39; or c == &#34;&#39;&#34; and tag:</span>
<span class="ansi-green-fg">+</span><span class="ansi-green-fg">            quote = not quote</span>
         elif not tag:
             out = out + c
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We'd like to compute and apply such patches without the help of an external program. To this end, we use Google's <a href="https://github.com/google/diff-match-patch">diff-match-patch library</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/google/diff-match-patch" class="import" target="_blank">diff_match_patch</a></span> <span class="kn">import</span> <span class="n">diff_match_patch</span><span class="p">,</span> <span class="n">patch_obj</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>By default, the diff-match-patch library is set up for comparing character strings, not lines; so we have to use a special workaround. Our <code>diff()</code> function computes a set of line patches between the two texts <code>s1</code> and <code>s2</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">s1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">patch_obj</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Compare s1 and s2 like `diff`; return a list of patches&quot;&quot;&quot;</span>
    <span class="n">dmp</span> <span class="o">=</span> <span class="n">diff_match_patch</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;lines&#39;</span><span class="p">:</span>
        <span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="n">text2</span><span class="p">,</span> <span class="n">linearray</span><span class="p">)</span> <span class="o">=</span> <span class="n">dmp</span><span class="o">.</span><span class="n">diff_linesToChars</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">dmp</span><span class="o">.</span><span class="n">diff_main</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="n">text2</span><span class="p">)</span>
        <span class="n">dmp</span><span class="o">.</span><span class="n">diff_charsToLines</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">linearray</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dmp</span><span class="o">.</span><span class="n">patch_make</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;chars&#39;</span><span class="p">:</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">dmp</span><span class="o">.</span><span class="n">diff_main</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dmp</span><span class="o">.</span><span class="n">patch_make</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">diffs</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be &#39;lines&#39; or &#39;chars&#39;&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can use our <code>diff()</code> function to compare the two versions of <code>remove_html_markup()</code>. We obtain four <code>patch_obj</code> patch objects:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">patches</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_2</span><span class="p">)</span>
<span class="n">patches</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a3053a90&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a3053b00&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a3bbe710&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a3bbe9e8&gt;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To inspect these patches, one can simply <code>print()</code> them; however, their string representation uses URL encoding for special characters. We introduce a <code>patch_string()</code> function that decodes them again, and then print out the four patches:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/urllib.html" class="import" target="_blank">urllib</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">patch_string</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">patch_obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">unquote</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_patch</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">patch_obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">print_content</span><span class="p">(</span><span class="n">patch_string</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patches</span><span class="p">:</span>
    <span class="n">print_patch</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>@@ -<span class="ansi-blue-fg">48</span>,<span class="ansi-blue-fg">24</span> +<span class="ansi-blue-fg">48</span>,<span class="ansi-blue-fg">42</span> @@
 tag = <span class="ansi-blue-fg">False</span>

+    quote = <span class="ansi-blue-fg">False</span>

     out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>@@ -<span class="ansi-blue-fg">104</span>,<span class="ansi-blue-fg">50</span> +<span class="ansi-blue-fg">104</span>,<span class="ansi-blue-fg">43</span> @@
  s:

-        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:    <span class="ansi-white-fg"># start of markup</span>

+        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:@@ -<span class="ansi-blue-fg">162</span>,<span class="ansi-blue-fg">48</span> +<span class="ansi-blue-fg">162</span>,<span class="ansi-blue-fg">45</span> @@
 rue

-        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>

+        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:@@ -<span class="ansi-blue-fg">215</span>,<span class="ansi-blue-fg">24</span> +<span class="ansi-blue-fg">215</span>,<span class="ansi-blue-fg">97</span> @@
 tag = <span class="ansi-blue-fg">False</span>

+        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote

         <span class="ansi-blue-fg">elif</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Each patch comes with a <em>location</em> (the part between <code>@@</code> characters as a character offset into the string) and a <em>change</em> (prefixed by <code>+</code> for added lines or <code>-</code> for deleted lines) in a particular <em>context</em> (notably, the preceding and following line).</p>
<p>This <em>context</em> allows us to <em>apply</em> patches even if the location no longer exactly matches – the last patch, for instance, introducing <code>elif c == '"'...</code>, for instance, is applied between the lines <code>tag = False</code> and the next <code>elif</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We define a <code>patch()</code> function that applies a list of patches to a string, again wrapping around the function provided by the diff-match-patch library.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">patch</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">patches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">patch_obj</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Apply given patches on given text; return patched text.&quot;&quot;&quot;</span>
    <span class="n">dmp</span> <span class="o">=</span> <span class="n">diff_match_patch</span><span class="p">()</span>
    <span class="n">patched_text</span><span class="p">,</span> <span class="n">success</span> <span class="o">=</span> <span class="n">dmp</span><span class="o">.</span><span class="n">patch_apply</span><span class="p">(</span><span class="n">patches</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">success</span><span class="p">),</span> <span class="s2">&quot;Could not apply some patch(es)&quot;</span>
    <span class="k">return</span> <span class="n">patched_text</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's how to use <code>patch()</code>. First, if we apply <em>all</em> patches between version 1 and version 2 on version 1, we get version 2:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">patches</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">patches</span><span class="p">)</span> <span class="o">==</span> <span class="n">version_2</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Applying <em>no</em> patch leaves the content unchanged.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="p">[])</span> <span class="o">==</span> <span class="n">version_1</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>However, one can also apply <em>partial</em> sets of patches. For instance, if we only apply the first patch...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">patch_string</span><span class="p">(</span><span class="n">patches</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>@@ -48,24 +48,42 @@
 tag = False

+    quote = False

     out = &#34;&#34;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... we find that the result includes the added line <code>quote = False</code>, but nothing else:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="p">[</span><span class="n">patches</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-red-fg">def</span> <span class="ansi-red-fg">remove_html_markup</span><span class="ansi-yellow-fg">(</span><span class="ansi-red-fg">s</span><span class="ansi-yellow-fg">)</span>:  # <span class="ansi-red-fg">type</span>: <span class="ansi-red-fg">ignore</span>
    <span class="ansi-red-fg">tag</span> = <span class="ansi-red-fg">False</span>
    <span class="ansi-red-fg">quote</span> = <span class="ansi-red-fg">False</span>
    <span class="ansi-red-fg">out</span> = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> <span class="ansi-red-fg">c</span> <span class="ansi-red-fg">in</span> <span class="ansi-red-fg">s</span>:
        <span class="ansi-blue-fg">if</span> <span class="ansi-red-fg">c</span> == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:    # <span class="ansi-red-fg">start</span> <span class="ansi-red-fg">of</span> <span class="ansi-red-fg">markup</span>
            <span class="ansi-red-fg">tag</span> = <span class="ansi-red-fg">True</span>
        <span class="ansi-red-fg">elif</span> <span class="ansi-red-fg">c</span> == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  # <span class="ansi-blue-fg">end</span> <span class="ansi-red-fg">of</span> <span class="ansi-red-fg">markup</span>
            <span class="ansi-red-fg">tag</span> = <span class="ansi-red-fg">False</span>
        <span class="ansi-red-fg">elif</span> <span class="ansi-red-fg">not</span> <span class="ansi-red-fg">tag</span>:
            <span class="ansi-red-fg">out</span> = <span class="ansi-red-fg">out</span> + <span class="ansi-red-fg">c</span>

    <span class="ansi-blue-fg">return</span> <span class="ansi-red-fg">out</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Likewise, we can also apply the second patch individually:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="p">[</span><span class="n">patches</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-red-fg">def</span> <span class="ansi-red-fg">remove_html_markup</span><span class="ansi-yellow-fg">(</span><span class="ansi-red-fg">s</span><span class="ansi-yellow-fg">)</span>:  # <span class="ansi-red-fg">type</span>: <span class="ansi-red-fg">ignore</span>
    <span class="ansi-red-fg">tag</span> = <span class="ansi-red-fg">False</span>
    <span class="ansi-red-fg">out</span> = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> <span class="ansi-red-fg">c</span> <span class="ansi-red-fg">in</span> <span class="ansi-red-fg">s</span>:
        <span class="ansi-blue-fg">if</span> <span class="ansi-red-fg">c</span> == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-red-fg">and</span> <span class="ansi-red-fg">not</span> <span class="ansi-red-fg">quote</span>:
            <span class="ansi-red-fg">tag</span> = <span class="ansi-red-fg">True</span>
        <span class="ansi-red-fg">elif</span> <span class="ansi-red-fg">c</span> == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  # <span class="ansi-blue-fg">end</span> <span class="ansi-red-fg">of</span> <span class="ansi-red-fg">markup</span>
            <span class="ansi-red-fg">tag</span> = <span class="ansi-red-fg">False</span>
        <span class="ansi-red-fg">elif</span> <span class="ansi-red-fg">not</span> <span class="ansi-red-fg">tag</span>:
            <span class="ansi-red-fg">out</span> = <span class="ansi-red-fg">out</span> + <span class="ansi-red-fg">c</span>

    <span class="ansi-blue-fg">return</span> <span class="ansi-red-fg">out</span>
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">What has changed in version 1 after applying the second patch?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="53b3d4fe-82c4-11eb-a588-acde48001122" id="53b3d4fe-82c4-11eb-a588-acde48001122-1" onclick="clear_selection('53b3d4fe-82c4-11eb-a588-acde48001122')">
        <label id="53b3d4fe-82c4-11eb-a588-acde48001122-1-label" for="53b3d4fe-82c4-11eb-a588-acde48001122-1">The initialization of quote is deleted</label><br>

        <input type="radio" name="53b3d4fe-82c4-11eb-a588-acde48001122" id="53b3d4fe-82c4-11eb-a588-acde48001122-2" onclick="clear_selection('53b3d4fe-82c4-11eb-a588-acde48001122')">
        <label id="53b3d4fe-82c4-11eb-a588-acde48001122-2-label" for="53b3d4fe-82c4-11eb-a588-acde48001122-2">The condition after <code>if c == '&lt;'</code> is expanded</label><br>

        <input type="radio" name="53b3d4fe-82c4-11eb-a588-acde48001122" id="53b3d4fe-82c4-11eb-a588-acde48001122-3" onclick="clear_selection('53b3d4fe-82c4-11eb-a588-acde48001122')">
        <label id="53b3d4fe-82c4-11eb-a588-acde48001122-3-label" for="53b3d4fe-82c4-11eb-a588-acde48001122-3">The tag variable gets a different value</label><br>

        <input type="radio" name="53b3d4fe-82c4-11eb-a588-acde48001122" id="53b3d4fe-82c4-11eb-a588-acde48001122-4" onclick="clear_selection('53b3d4fe-82c4-11eb-a588-acde48001122')">
        <label id="53b3d4fe-82c4-11eb-a588-acde48001122-4-label" for="53b3d4fe-82c4-11eb-a588-acde48001122-4">None of the above</label><br>

    </div>
    </p>
    <input id="53b3d4fe-82c4-11eb-a588-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('53b3d4fe-82c4-11eb-a588-acde48001122', 4, 0, '1 / 1 + 1 ** 1 - 1 % 1 * 1')">
    <span class="quiz_hint" id="53b3d4fe-82c4-11eb-a588-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Delta-Debugging-on-Patches">Delta Debugging on Patches<a class="anchor-link" href="#Delta-Debugging-on-Patches">&#182;</a></h2><p>With the ability to apply arbitrary sets of patches, we can now go and apply <a href="DeltaDebugger.html">Delta Debugging</a> to identify failure-inducing patches. The idea is simple: If applying <em>no</em> patch makes the test pass, and applying <em>all</em> patches makes the test fail, then we can use Delta Debugging to identify a minimal set of failure-inducing patches.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us write a testing function that checks for the presence of the failure. <code>test_remove_html_markup_patches()</code></p>
<ul>
<li>takes a list of patches,</li>
<li>applies them on version 1, </li>
<li>reads in the definition of <code>remove_html_markup()</code></li>
<li>and then invokes it to check if the error is present.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_remove_html_markup_patches</span><span class="p">(</span><span class="n">patches</span><span class="p">:</span> <span class="n">patch_obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">new_version</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">patches</span><span class="p">)</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">new_version</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
    <span class="k">assert</span> <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&quot;foo&quot;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If no patches are applied, we are at version 1, and the error is not present.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_remove_html_markup_patches</span><span class="p">([])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If <em>all</em> patches are applied, we are at version 2, and the error <em>is</em> present.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">test_remove_html_markup_patches</span><span class="p">(</span><span class="n">patches</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-899e4aa0f13c&gt;&#34;, line 2, in &lt;module&gt;
    test_remove_html_markup_patches(patches)
  File &#34;&lt;ipython-input-1-51c2474cb795&gt;&#34;, line 4, in test_remove_html_markup_patches
    assert remove_html_markup(&#39;&#34;foo&#34;&#39;) == &#39;&#34;foo&#34;&#39;
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="A-Minimal-Set-of-Patches">A Minimal Set of Patches<a class="anchor-link" href="#A-Minimal-Set-of-Patches">&#182;</a></h3><p>We can now apply delta debugging on the list of patches, simply by invoking a <code>DeltaDebugger</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="DeltaDebugger.html" class="import" target="_blank">DeltaDebugger</a></span> <span class="kn">import</span> <span class="n">DeltaDebugger</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">test_remove_html_markup_patches</span><span class="p">(</span><span class="n">patches</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>These is the minimal set of failure-inducing patches:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reduced_patches</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()[</span><span class="s1">&#39;patches&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">reduced_patches</span><span class="p">:</span>
    <span class="n">print_patch</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>@@ -<span class="ansi-blue-fg">48</span>,<span class="ansi-blue-fg">24</span> +<span class="ansi-blue-fg">48</span>,<span class="ansi-blue-fg">42</span> @@
 tag = <span class="ansi-blue-fg">False</span>

+    quote = <span class="ansi-blue-fg">False</span>

     out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>@@ -<span class="ansi-blue-fg">215</span>,<span class="ansi-blue-fg">24</span> +<span class="ansi-blue-fg">215</span>,<span class="ansi-blue-fg">97</span> @@
 tag = <span class="ansi-blue-fg">False</span>

+        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote

         <span class="ansi-blue-fg">elif</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is the resulting code. We see that the changes to the conditions (<code>if c == '&lt;'</code> and <code>if c == '&gt;'</code>) are not necessary to produce the failure – our test string has no HTML tags.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">reduced_patches</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:    <span class="ansi-white-fg"># start of markup</span>
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Hence, we have now narrowed down our failure-inducing changes from four patches down to two.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="A-Minimal-Difference">A Minimal Difference<a class="anchor-link" href="#A-Minimal-Difference">&#182;</a></h3><p>Can we narrow this down even further? Yes, we can! The idea is to not only search for the minimal set of patches to be applied on the passing version, but to actually seek a minimal <em>difference</em> betweem two patch sets. That is, we obtain</p>
<ul>
<li>one set of <em>passing</em> patches that, when applied, still passes;</li>
<li>one set of <em>failing</em> patches that, when applied, fails;</li>
</ul>
<p>with a <em>minimal difference</em> between the two. This minimal difference is what causes the failure.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We obtain such two sets (as well as their difference) by using the <code>min_arg_diff()</code> method of the <code>DeltaDebugger</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pass_patches</span><span class="p">,</span> <span class="n">fail_patches</span><span class="p">,</span> <span class="n">diffs</span> <span class="o">=</span> \
    <span class="nb">tuple</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="s1">&#39;patches&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_arg_diff</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is <code>remove_html_markup[)</code> with the passing set applied. We see that the variable <code>quote</code> is defined at the beginning. This definition is actually a precondition for other patches to result in an executable program; otherwise, the program will fail when the variable <code>quote</code> does not exist.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">pass_patches</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's <code>remove_html_markup()</code> with the failing set applied. We see that now we also have the check for double quotes:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">patch</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">fail_patches</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The difference is just this one patch:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">diffs</span><span class="p">:</span>
    <span class="n">print_patch</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>@@ -<span class="ansi-blue-fg">215</span>,<span class="ansi-blue-fg">24</span> +<span class="ansi-blue-fg">215</span>,<span class="ansi-blue-fg">97</span> @@
 tag = <span class="ansi-blue-fg">False</span>

+        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote

         <span class="ansi-blue-fg">elif</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And one more time, we are pointed to the buggy line that introduced the error.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="A-ChangeDebugger-class">A ChangeDebugger class<a class="anchor-link" href="#A-ChangeDebugger-class">&#182;</a></h2><p>Let us put all these steps together in a single class. The <code>ChangeDebugger</code> is a derivative of <code>CallCollector</code> which takes two source files (one passing, one failing).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="DeltaDebugger.html" class="import" target="_blank">DeltaDebugger</a></span> <span class="kn">import</span> <span class="n">CallCollector</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ChangeDebugger</span><span class="p">(</span><span class="n">CallCollector</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pass_source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fail_source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">ddargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Constructor. Takes a passing source file (`pass_source`)</span>
<span class="sd">        and a failing source file (`fail_source`).</span>
<span class="sd">        Additional arguments are passed to `DeltaDebugger` constructor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pass_source</span> <span class="o">=</span> <span class="n">pass_source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_source</span> <span class="o">=</span> <span class="n">fail_source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patches</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">pass_source</span><span class="p">,</span> <span class="n">fail_source</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ddargs</span> <span class="o">=</span> <span class="n">ddargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">ddargs</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;log&#39;</span> <span class="ow">in</span> <span class="n">ddargs</span> <span class="k">else</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">pass_source</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the passing source file.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pass_source</span>

    <span class="k">def</span> <span class="nf">fail_source</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the failing source file.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_source</span>

    <span class="k">def</span> <span class="nf">patches</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">patch_obj</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return the diff between passing and failing source files.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patches</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>From <code>CallCollector</code>, it inherits the ability to inspect a single function call...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_remove_html_markup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;&quot;foo&quot;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ChangeDebugger</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_2</span><span class="p">)</span> <span class="k">as</span> <span class="n">cd</span><span class="p">:</span>
    <span class="n">test_remove_html_markup</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... and to repeat it at will.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">cd</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-1cdc3d223902&gt;&#34;, line 2, in &lt;module&gt;
    cd.call()
  File &#34;/Users/zeller/Projects/debuggingbook/notebooks/DeltaDebugger.ipynb&#34;, line 205, in call
    return self.function()(**args)
  File &#34;&lt;ipython-input-1-6809e80c588d&gt;&#34;, line 2, in test_remove_html_markup
    assert remove_html_markup(&#39;&#34;foo&#34;&#39;) == &#39;&#34;foo&#34;&#39;
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can access the passing source, the failing source, and the list of patches:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">cd</span><span class="o">.</span><span class="n">pass_source</span><span class="p">(),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:    <span class="ansi-white-fg"># start of markup</span>
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:  <span class="ansi-white-fg"># end of markup</span>
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">cd</span><span class="o">.</span><span class="n">fail_source</span><span class="p">(),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cd</span><span class="o">.</span><span class="n">patches</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452b9e8&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452b518&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452b908&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452bdd8&gt;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For testing, we do not apply Delta Debugging on the function under test – that would reduce the function's arguments. (It would still be neat, but that's not what we're aiming for here.)</p>
<p>Instead, we introduce a method <code>test_patches()</code> that gets a set of patches, applies them, reads in the resulting source, and (re-)calls the function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ChangeDebugger</span><span class="p">(</span><span class="n">ChangeDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_patches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">patch_obj</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_version</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pass_source</span><span class="p">(),</span> <span class="n">patches</span><span class="p">)</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">new_version</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For completeness, we ensure that at the beginning of the <code>with</code> block, we assume the failing source:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ChangeDebugger</span><span class="p">(</span><span class="n">ChangeDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Called at begin of a `with` block. Checks if current source fails.&quot;&quot;&quot;</span>
        <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fail_source</span><span class="p">(),</span> <span class="nb">globals</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's <code>test_patches()</code> in action. As before, if we apply no patches, the test passes; if we apply all patches, it fails.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ChangeDebugger</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_2</span><span class="p">)</span> <span class="k">as</span> <span class="n">cd</span><span class="p">:</span>
    <span class="n">test_remove_html_markup</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cd</span><span class="o">.</span><span class="n">test_patches</span><span class="p">([])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">cd</span><span class="o">.</span><span class="n">test_patches</span><span class="p">(</span><span class="n">cd</span><span class="o">.</span><span class="n">patches</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-27b59634b5f9&gt;&#34;, line 2, in &lt;module&gt;
    cd.test_patches(cd.patches())
  File &#34;&lt;ipython-input-1-cdf9e7513b95&gt;&#34;, line 5, in test_patches
    self.call()
  File &#34;/Users/zeller/Projects/debuggingbook/notebooks/DeltaDebugger.ipynb&#34;, line 205, in call
    return self.function()(**args)
  File &#34;&lt;ipython-input-1-6809e80c588d&gt;&#34;, line 2, in test_remove_html_markup
    assert remove_html_markup(&#39;&#34;foo&#34;&#39;) == &#39;&#34;foo&#34;&#39;
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now for the actual debugging. We introduce a method <code>min_patches()</code> in which we invoke a <code>DeltaDebugger</code> on the <code>test_patches()</code> method we just defined. Using <code>min_arg.diff()</code>, it then computes a minimal failure-inducing difference between the patches.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ChangeDebugger</span><span class="p">(</span><span class="n">ChangeDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">min_patches</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">patch_obj</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">patch_obj</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">patch_obj</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute a minimal set of patches.</span>
<span class="sd">        Returns a triple (`pass_patches`, `fail_patches`, `diff_patches`) </span>
<span class="sd">        where `diff_patches` is the minimal difference between </span>
<span class="sd">        the set `pass_patches` (which, when applied, make the test pass) and </span>
<span class="sd">        the set `fail_patches` (which, when applied, make the test fail).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">patches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patches</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_ddargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_patches</span><span class="p">(</span><span class="n">patches</span><span class="p">)</span>

        <span class="n">args</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_arg_diff</span><span class="p">()</span>
        <span class="n">pass_patches</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;patches&#39;</span><span class="p">]</span>
        <span class="n">fail_patches</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;patches&#39;</span><span class="p">]</span>
        <span class="n">diff_patches</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;patches&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">pass_patches</span><span class="p">,</span> <span class="n">fail_patches</span><span class="p">,</span> <span class="n">diff_patches</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>__repr__()</code> method, turning a <code>ChangeDebugger</code> into a readable string, computes <code>min_patches()</code> and returns a user-readable representation of the patches:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ChangeDebugger</span><span class="p">(</span><span class="n">ChangeDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return readable list of minimal patches&quot;&quot;&quot;</span>
        <span class="n">pass_patches</span><span class="p">,</span> <span class="n">fail_patches</span><span class="p">,</span> <span class="n">diff_patches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_patches</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">patch_string</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">diff_patches</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's how to use these methods. First, we invoke <code>ChangeDebugger</code> with the given old and new source code versions on our test function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ChangeDebugger</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_2</span><span class="p">)</span> <span class="k">as</span> <span class="n">cd</span><span class="p">:</span>
    <span class="n">test_remove_html_markup</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>These are the patches we determined:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cd</span><span class="o">.</span><span class="n">patches</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452bf60&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452b320&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452b470&gt;,
 &lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452b710&gt;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We invoke <code>min_patches</code> to obtain a minimal set of patches:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pass_patches</span><span class="p">,</span> <span class="n">fail_patches</span><span class="p">,</span> <span class="n">diffs</span> <span class="o">=</span> <span class="n">cd</span><span class="o">.</span><span class="n">min_patches</span><span class="p">()</span>
<span class="n">diffs</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&lt;diff_match_patch.diff_match_patch.patch_obj at 0x7ff7a452b710&gt;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can inspect the failure-inducing patches right away:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">patch_string</span><span class="p">(</span><span class="n">diffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>@@ -215,24 +215,97 @@
 tag = False

+        elif c == &#39;&#34;&#39; or c == &#34;&#39;&#34; and tag:
            quote = not quote

         elif
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Or – even simpler – we can simply print out the <code>ChangeDebugger</code> to obtain a readable representation.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cd</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>@@ -215,24 +215,97 @@
 tag = False

+        elif c == &#39;&#34;&#39; or c == &#34;&#39;&#34; and tag:
            quote = not quote

         elif
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Success!</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Does this also work for longer change histories? Let's take the very first and the very last version.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">version_8</span> <span class="o">=</span> <span class="n">get_output</span><span class="p">([</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">,</span> 
                            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">versions</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="si">}</span><span class="s1">:remove_html_markup.py&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ChangeDebugger</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_8</span><span class="p">)</span> <span class="k">as</span> <span class="n">cd</span><span class="p">:</span>
    <span class="n">test_remove_html_markup</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We start with 5 patches:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">cd</span><span class="o">.</span><span class="n">patches</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>5
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Printing out the debugger again reveals a single failure-inducing change – it's actually still the same.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cd</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>@@ -215,24 +215,97 @@
 tag = False

+        elif c == &#39;&#34;&#39; or c == &#34;&#39;&#34; and tag:
            quote = not quote

         elif
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We close with a bit of housekeeping, ensuring that the preconditions are properly met.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="DeltaDebugger.html" class="import" target="_blank">DeltaDebugger</a></span> <span class="kn">import</span> <span class="n">NoCallError</span><span class="p">,</span> <span class="n">NotFailingError</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NotPassingError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ChangeDebugger</span><span class="p">(</span><span class="n">ChangeDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">after_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Diagnostics.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoCallError</span><span class="p">(</span><span class="s2">&quot;No function call observed&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFailingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">()</span><span class="si">}</span><span class="s2"> did not raise an exception&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_patches</span><span class="p">([])</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotPassingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">()</span><span class="si">}</span><span class="s2"> raised an exception in its passing version&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_patches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patches</span><span class="p">())</span>
            <span class="k">raise</span> <span class="n">NotFailingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">()</span><span class="si">}</span><span class="s2"> did not raise an exception in failing version&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observed </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span>
                  <span class="sa">f</span><span class="s2">&quot; raising </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="n">NotPassingError</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">ChangeDebugger</span><span class="p">(</span><span class="n">version_1</span><span class="p">,</span> <span class="n">version_2</span><span class="p">)</span> <span class="k">as</span> <span class="n">cd</span><span class="p">:</span>
        <span class="n">test_remove_html_markup</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With this, we're done. Enjoy debugging changes!</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Lessons-Learned">Lessons Learned<a class="anchor-link" href="#Lessons-Learned">&#182;</a></h2><ul>
<li>If one has a version history available, one can use it to determine failure-inducing changes.</li>
<li>Bisecting with git effectively isolates failure-inducing commits, both manually and automatically.</li>
<li>Delta debugging on changes allows to further isolate minimal sets of failure-inducing changes.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Next-Steps">Next Steps<a class="anchor-link" href="#Next-Steps">&#182;</a></h2><p>This concludes our applications of Delta Debugging. In the next chapters, we will analyze how to abstract failure-inducing inputs into failure-inducing <em>input sets</em>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background<a class="anchor-link" href="#Background">&#182;</a></h2><p>The concept of "bisecting" as traversing a version history to identify failure-inducing changes was first described by Brian Ness and Viet Ngo from Cray Research as "Source change isolation" [<a href="https://www.computer.org/csdl/proceedings-article/compsac/1997/81050616/12OmNANBZnS">Ness <em>et al</em>, 1997.</a>]. The abstract of their paper summarizes the goals and benefits:</p>
<blockquote><p>Effective regression containment is an important factor in the design of development and testing processes for large software projects, especially when many developers are doing concurrent work on a common set of sources. Source change isolation provides an inexpensive, mechanical alternative to analytical methods for identifying the cause of software regressions. It also provides the advantage of enabling regressions to be eliminated by reversing the effect of source changes that introduced errant behavior, without the need to write new code, and without halting other development work on the same software. Deliverability is also improved.</p>
</blockquote>
<p>Delta Debugging on changes (and also Delta Debugging) was introduced in "Yesterday, my program worked. Today, it does not. Why?" [<a href="https://doi.org/10.1145/318774.318946">Zeller <em>et al</em>, 1999.</a>], a paper which would win an ACM SIGSOFT Impact Paper Award ten years later.
This paper generalized over [<a href="https://www.computer.org/csdl/proceedings-article/compsac/1997/81050616/12OmNANBZnS">Ness <em>et al</em>, 1997.</a>] by identifying failure-inducing differences in arbitrary sets of changes. [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002.</a>] generalized the algorithm to work on inputs and other collections (including changes); the <a href="DeltaDebugger">chapter on delta debugging</a>, which we use in this chapter, uses the [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002.</a>] formulation of the <code>dd</code> algorithm.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We're done, so we clean up a bit:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">PROJECT</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercises">Exercises<a class="anchor-link" href="#Exercises">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-1:-Fine-Grained-Changes">Exercise 1: Fine-Grained Changes<a class="anchor-link" href="#Exercise-1:-Fine-Grained-Changes">&#182;</a></h3><p>Instead of computing patches on lines (as we and most <code>diff</code> programs do), one can also compute fine-grained diffs, using our <code>diff()</code> function with <code>mode='chars'</code>. Would this make sense?</p>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/ChangeDebugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Creative Commons License">
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target=_blank>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/debuggingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/debuggingbook/commits/master/notebooks/ChangeDebugger.ipynb" target=_blank)>Last change: 2021-03-12 00:35:32+01:00</a> &bull; 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> &bull;
<a href="https://cispa.de/en/impressum" target=_blank>Imprint</a>
</p>

<script>
function revealCitation() {
    var c = document.getElementById("citation");
    c.style.display = "block";
}
</script>

<div id="citation" class="citation" style="display: none;">
<a name="citation"></a>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller: "<a href="https://www.debuggingbook.org/beta/html/ChangeDebugger.html">Isolating Failure-Inducing Changes</a>".  In Andreas Zeller, "<a href="https://www.debuggingbook.org/beta/">The Debugging Book</a>", <a href="https://www.debuggingbook.org/beta/html/ChangeDebugger.html">https://www.debuggingbook.org/beta/html/ChangeDebugger.html</a>.  Retrieved 2021-03-12 00:35:32+01:00.
</p>
<pre>
@incollection{debuggingbook2021:ChangeDebugger,
    author = {Andreas Zeller},
    booktitle = {The Debugging Book},
    title = {Isolating Failure-Inducing Changes},
    year = {2021},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.debuggingbook.org/beta/html/ChangeDebugger.html}},
    note = {Retrieved 2021-03-12 00:35:32+01:00},
    url = {https://www.debuggingbook.org/beta/html/ChangeDebugger.html},
    urldate = {2021-03-12 00:35:32+01:00}
}
</pre>
</div>

      </div>
    </div>
    </article>

 </body>

</html>