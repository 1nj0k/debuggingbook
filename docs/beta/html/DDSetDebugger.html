<!-- A html document -->
<!-- 
with standard nbconvert css layout
with standard nbconvert input/output content
standard html tag wrapping
with mathjax loaded
with jupyter wigets
 caption and label elements according to ipub meta tags  
with fuzzingbook adaptations -->None
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /><title>Generalizing Failure Circumstances - The Debugging Book</title>

<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
    </style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true }
    }
});
</script>
<!-- End of mathjax configuration --><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<!--[if IE lte 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<style type="text/css">
.ipyfigure { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipyfigure>div { flex:1; }
.ipytable { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipytable>div { flex:1; }

</style>

<link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,500,700|Raleway:300|Source+Code+Pro|Open+Sans' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<meta property="og:url" content="https://www.debuggingbook.org/beta/html/DDSetDebugger.html" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Generalizing Failure Circumstances - The Debugging Book" />
<meta property="og:description" content="One central question in debugging is: Does this bug occur in other situations, too? In this chapter, we present a technique that is set to generalize the circumstances under which a failure occurs. The DDSET algorithm takes a failure-inducing input, breaks it into individual elements. For each element, it tries to find whether it can be replaced by others in the same category, and if so, it generalizes the concrete element to the very category. The result is a pattern that characterizes the failure condition: &quot;The failure occurs for all inputs of the form `(&lt;expr&gt;  &lt;expr&gt;)`.Prerequisites You should have read the chapter on delta debugging." />
<meta property="og:image" content="https://www.debuggingbook.org/beta/html/PICS/wordcloud.png" />

<meta name="twitter:dnt" content="on">

<link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon.png">

<meta name="msapplication-TileColor" content="#B03A2E">
<meta name="msapplication-config" content="favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">

<meta name="viewport" content="width=device-width, initial-scale=1"></head>
 <body>

    <script>
    var close_menus = function() {
        /* doesn't work yet - AZ
        console.log("Closing menus")
        var cssmenu = document.getElementById("cssmenu")
        var all_items = cssmenu.getElementsByTagName("li");
        var i;
        for (i = 0; i < all_items.length; i++) {
            item = all_items[i];
            // console.log("<li>: ")
            // console.log(item.innerHTML);
            var j;
            var all_ul = item.getElementsByTagName("ul");
            for (j = 0; j < all_ul.length; j++) {
                console.log("<ul>: ")
                console.log(all_ul[j].innerHTML);
                all_ul[j].style.display = "none";
            }
            var all_ol = item.getElementsByTagName("ol");
            for (j = 0; j < all_ol.length; j++) {
                console.log("<ol>: ")
                console.log(all_ol[j].innerHTML);
                all_ol[j].style.display = "none";
            }
        }
        */
    };

    $( document ).ready( close_menus );

    // Let navbar fade away when scrolling down
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
        var currentScrollPos = window.pageYOffset;
        if (currentScrollPos > 10 && currentScrollPos > prevScrollpos) {
            // Hide navbar
            var cssmenu = document.getElementById("cssmenu")
            cssmenu.style.opacity = 0;

            // When scrolling, also close all sub-menus
            close_menus();
        }
        else {
            // Make navbar visible
            document.getElementById("cssmenu").style.opacity = 1;
        }
        prevScrollpos = currentScrollPos;
    };
    </script>
    
<nav>
<div id="cssmenu">
  <ul>
     <li class="has-sub"><a href="#"><span title="The Debugging Book"><i class="fa fa-fw fa-bars"></i> </span><span class="menu_1">The Debugging Book&nbsp;<i class="fa fa-fw fa-wrench"></i></span></a>
        <ol>
           
<li><a href="https://www.debuggingbook.org/beta/"><span class="part_number"><i class="fa fa-fw fa-home"></i></span> About this book</a></li>
<li><a href="https://www.debuggingbook.org/beta/html/00_Table_of_Contents.html"><i class="fa fa-fw fa-sitemap"></i></span> Sitemap</a></li>
<li class="has-sub"><a href="01_Intro.html" class="chapters"><span class="part_number">I</span> Whetting Your Appetite <strong class="new_chapter">&bull;</strong> <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tours.html">Tours through the Book <strong class="new_chapter">&bull;</strong></a></li>
<li><a href="Intro_Debugging.html">Introduction to Debugging <strong class="new_chapter">&bull;</strong></a></li>
</ul><li class="has-sub"><a href="02_Observing.html" class="chapters"><span class="part_number">II</span> Observing Executions <strong class="new_chapter">&bull;</strong> <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracer.html">Tracing Executions <strong class="new_chapter">&bull;</strong></a></li>
<li><a href="Debugger.html">How Debuggers Work <strong class="new_chapter">&bull;</strong></a></li>
<li><a href="Assertions.html">Asserting Expectations</a></li>
<li><a href="PerformanceDebugger.html">Debugging Performance Issues&nbsp;<i class="fa fa-fw fa-wrench"></i></a></li>
</ul><li class="has-sub"><a href="03_Dependencies.html" class="chapters"><span class="part_number">III</span> Flows and Dependencies <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Slicer.html">Tracking Failure Origins</a></li>
</ul><li class="has-sub"><a href="04_Reducing.html" class="chapters"><span class="part_number">IV</span> Reducing Failure Causes <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="DeltaDebugger.html">Reducing Failure-Inducing Inputs</a></li>
<li><a href="ChangeDebugger.html">Isolating Failure-Inducing Changes</a></li>
<li><a href="ThreadDebugger.html">Debugging Concurrent Programs&nbsp;<i class="fa fa-fw fa-wrench"></i></a></li>
</ul><li class="has-sub"><a href="05_Abstracting.html" class="chapters"><span class="part_number">V</span> Abstracting Failures <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="StatisticalDebugger.html">Statistical Debugging</a></li>
<li><a href="DynamicInvariants.html">Mining Function Specifications</a></li>
<li><a href="DDSetDebugger.html" class="this_page">Generalizing Failure Circumstances</a></li>
</ul><li class="has-sub"><a href="06_Repairing.html" class="chapters"><span class="part_number">VI</span> Automatic Repair <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Repairer.html">Repairing Code Automatically</a></li>
</ul><li class="has-sub"><a href="07_In_the_Large.html" class="chapters"><span class="part_number">VII</span> Debugging in the Large <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracking.html">Tracking Bugs</a></li>
<li><a href="ChangeCounter.html">Where the Bugs are</a></li>
</ul><li class="has-sub"><a href="99_Appendices.html" class="chapters">Appendices <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="ExpectError.html">Error Handling</a></li>
<li><a href="Timer.html">Timer</a></li>
<li><a href="ClassDiagram.html">Class Diagrams</a></li>
<li><a href="StackInspector.html">Inspecting Call Stacks</a></li>
</ul>
           <li><a href="https://www.debuggingbook.org/beta/html/00_Index.html">Index (beta)</a></i></li>
        </ol>
     </li>
     <li class="has-sub"><a href="#"><span title="Generalizing Failure Circumstances"><i class="fa fa-fw fa-list-ul"></i></span> <span class="menu_2">Generalizing Failure Circumstances</span></a>
           <ul><li class="has-sub"><a href="#Synopsis"><i class="fa fa-fw fa-map"></i> Synopsis</a>
</li><li class="has-sub"><a href="#A-Failing-Program">&nbsp;&bull;&nbsp;&nbsp; A Failing Program</a>
</li><li class="has-sub"><a href="#Grammars">&nbsp;&bull;&nbsp;&nbsp; Grammars</a>
</li><li class="has-sub"><a href="#Derivation-Trees">&nbsp;&bull;&nbsp;&nbsp; Derivation Trees</a>
</li><li class="has-sub"><a href="#Parsing">&nbsp;&bull;&nbsp;&nbsp; Parsing</a>
</li><li class="has-sub"><a href="#Mutating-the-Tree">&nbsp;&bull;&nbsp;&nbsp; Mutating the Tree</a>
<ul><li class="has-sub"><a href="#Referencing-Subtrees">Referencing Subtrees</a>
</li><li class="has-sub"><a href="#Creating-new-Subtrees">Creating new Subtrees</a>
</li><li class="has-sub"><a href="#Mutating-the-Tree">Mutating the Tree</a>
</ul></li><li class="has-sub"><a href="#Generalizing-Trees">&nbsp;&bull;&nbsp;&nbsp; Generalizing Trees</a>
<ul><li class="has-sub"><a href="#Testing-for-Generalization">Testing for Generalization</a>
</li><li class="has-sub"><a href="#Generalizable-Paths">Generalizable Paths</a>
</ul></li><li class="has-sub"><a href="#Fuzzing-with-Patterns">&nbsp;&bull;&nbsp;&nbsp; Fuzzing with Patterns</a>
</li><li class="has-sub"><a href="#Putting-it-all-Together">&nbsp;&bull;&nbsp;&nbsp; Putting it all Together</a>
<ul><li class="has-sub"><a href="#Constructor">Constructor</a>
</li><li class="has-sub"><a href="#Generalizing-Arguments">Generalizing Arguments</a>
</li><li class="has-sub"><a href="#Fuzzing">Fuzzing</a>
</ul></li><li class="has-sub"><a href="#More-Examples">&nbsp;&bull;&nbsp;&nbsp; More Examples</a>
<ul><li class="has-sub"><a href="#Square-Root">Square Root</a>
</li><li class="has-sub"><a href="#Middle">Middle</a>
</ul></li><li class="has-sub"><a href="#Lessons-Learned"><i class="fa fa-fw fa-trophy"></i> Lessons Learned</a>
</li><li class="has-sub"><a href="#Next-Steps"><i class="fa fa-fw fa-arrows"></i> Next Steps</a>
</li><li class="has-sub"><a href="#Background"><i class="fa fa-fw fa-mortar-board"></i> Background</a>
</li><li class="has-sub"><a href="#Exercises"><i class="fa fa-fw fa-edit"></i> Exercises</a>
<ul><li class="has-sub"><a href="#Exercise-1:-Generalization-and-Specialization">Exercise 1: Generalization and Specialization</a>
</li><li class="has-sub"><a href="#Exercise-2:-Hierarchical-Delta-Debugging">Exercise 2: Hierarchical Delta Debugging</a>
</ul></li><li class="has-sub"><a href="#Exercise-3:-Reducing-Trees">&nbsp;&bull;&nbsp;&nbsp; Exercise 3: Reducing Trees</a>
</ul></li>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Resources"><i class="fa fa-fw fa-cube"></i> </span><span class="menu_3">Resources</span></a>
     <ul>
     <li><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DDSetDebugger.ipynb" target="_blank" class="edit_as_notebook"><i class="fa fa-fw fa-edit"></i> Edit as Notebook</a></li>
     <li><a href="https://www.debuggingbook.org/beta/slides/DDSetDebugger.slides.html" target="_blank"><i class="fa fa-fw fa-video-camera"></i> View Slides</a></li>
     <li><a href="https://www.debuggingbook.org/beta/code/DDSetDebugger.py"><i class="fa fa-fw fa-download"></i> Download Code (.py)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/notebooks/DDSetDebugger.ipynb"><i class="fa fa-fw fa-download"></i> Download Notebook (.ipynb)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-code.zip"><i class="fa fa-fw fa-cube"></i> All Code (.zip)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-notebooks.zip"><i class="fa fa-fw fa-cube"></i> All Notebooks (.zip)</a></li>
     <li><a href="https://github.com/uds-se/debuggingbook/" target="_blank"><i class="fa fa-fw fa-github"></i> Project Page</a></li>
     <li><a href="ReleaseNotes.html" target="_blank"><i class="fa fa-fw fa-calendar"></i> Release Notes</a></li>
     </ul>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Share"><i class="fa fa-fw fa-comments"></i> </span> <span class="menu_4">Share</span></a>
        <ul>
            <li><a href="https://twitter.com/intent/tweet?text=I%20just%20read%20%22Generalizing%20Failure%20Circumstances%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDDSetDebugger.html" target="popup" 
onclick="window.open('https://twitter.com/intent/tweet?text=I%20just%20read%20%22Generalizing%20Failure%20Circumstances%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDDSetDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-twitter"></i> Share on Twitter</a>
            <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDDSetDebugger.html" target="popup" 
onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDDSetDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-facebook"></i> Share on Facebook</a>
            <li><a href="mailto:?subject=Generalizing%20Failure%20Circumstances&body=I%20just%20read%20%22Generalizing%20Failure%20Circumstances%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDDSetDebugger.html"><i class="fa fa-fw fa-envelope"></i> Share by Email</a>
            <li><a href="#citation" id="cite" onclick="revealCitation()"><i class="fa fa-fw fa-mortar-board"></i> Cite</a>
        </ul>
     </li>
     <li class="has-sub"><a href="#"><span title="Help"><i class="fa fa-fw fa-question-circle"></i></span> <span class="menu_5">Help</span></a>
        <ul>
          <li><a href="https://www.debuggingbook.org/beta/#Troubleshooting"><i class="fa fa-fw fa-wrench"></i> Troubleshooting</a></li>
          <li><a href="https://docs.python.org/3/tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Python Tutorial</a>
          <li><a href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Jupyter Notebook Tutorial</a>
          <li><a href="https://github.com/uds-se/debuggingbook/issues/" target="_blank"><i class="fa fa-fw fa-commenting"></i> Report an Issue</a></li>
        </ul>
     </li>
  </ul>
</div>
</nav>

    <article>
   <div tabindex="-1" id="notebook" class="border-box-sizing">
     <div class="container" id="notebook-container">

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="Generalizing-Failure-Circumstances">Generalizing Failure Circumstances<a class="anchor-link" href="#Generalizing-Failure-Circumstances">&#182;</a></h1><p><em class="beta"><i class="fa fa-fw fa-warning"></i>&nbsp;This chapter is still under review ("beta").  It may change at any time.</em></p><p>One central question in debugging is: <em>Does this bug occur in other situations, too?</em> In this chapter, we present a technique that is set to <em>generalize</em> the circumstances under which a failure occurs. The DDSET algorithm takes a failure-inducing input, breaks it into individual elements. For each element, it tries to find whether it can be replaced by others in the same category, and if so, it <em>generalizes</em> the concrete element to the very category. The result is a <em>pattern</em> that characterizes the failure condition: "The failure occurs for all inputs of the form <code>(&lt;expr&gt; * &lt;expr&gt;)</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook/tree/master/notebooks/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;PV22XtIQU1s&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

        <iframe
            width="640"
            height="360"
            src="https://www.youtube-nocookie.com/embed/PV22XtIQU1s"
            frameborder="0"
            allowfullscreen
        ></iframe>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Prerequisites</strong></p>
<ul>
<li>You should have read the <a href="DeltaDebugger.html">chapter on <em>delta debugging</em></a>.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook/tree/master/notebooks/bookutils" class="import" target="_blank">bookutils</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="DeltaDebugger.html" class="import" target="_blank">DeltaDebugger</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="synopsis"><h2 id="Synopsis">Synopsis<a class="anchor-link" href="#Synopsis">&#182;</a></h2><!-- Automatically generated. Do not edit. -->

<p>To <a href="Importing.html">use the code provided in this chapter</a>, write</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="DDSetDebugger.html" class="import" target="_blank">debuggingbook.DDSetDebugger</a></span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
<p>and then make use of the following features.</p>
<p>This chapter provides a class <code>DDSetDebugger</code>, implementing the DDSET algorithm for generalizing failure-inducing inputs. The <code>DDSetDebugger</code> is used as follows:</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DDSetDebugger</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">function</span><span class="p">(</span><span class="n">args</span><span class="o">...</span><span class="p">)</span>
<span class="n">dd</span>
</pre></div>
<p>Here, <code>function(args...)</code> is a failing function call (= raises an execption) that takes at least one string argument; <code>grammar</code> is an <a href="https://www.fuzzingbook.org/html/Grammars.html">input grammar in fuzzingbook format</a> that matches the format of this argument.</p>
<p>The result is a call of <code>function()</code> with an <em>abstract failure-inducing input</em> – a variant of the conrete input in which parts are replaced by placeholders in the form <code>&lt;name&gt;</code>, where <code>&lt;name&gt;</code> is a nonterminal in the grammar. The failure has been verified to occur for a number of instantiations of <code>&lt;name&gt;</code>.</p>
<p>Here is an example of how <code>DDSetDebugger</code> works. The concrete failing input <code>&lt;foo&gt;"bar&lt;/foo&gt;</code> is generalized to an <em>abstract failure-inducing input</em>:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">DDSetDebugger</span><span class="p">(</span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&lt;foo&gt;&quot;bar&lt;/foo&gt;&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dd</span>

<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;lt&gt;&lt;id&gt;&lt;gt&gt;&quot;&lt;plain-text&gt;&lt;closing-tag&gt;&#39;</span><span class="p">)</span>
</pre></div>
<p>The abstract input tells us that the failure occurs for whatever opening and closing HTML tags as long as there is a double quote between them.</p>
<p>A programmatic interface is available as well. <code>generalize()</code> returns a mapping of argument names to (generalized) values:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">generalize</span><span class="p">()</span>

<span class="p">{</span><span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;lt&gt;&lt;id&gt;&lt;gt&gt;&quot;&lt;plain-text&gt;&lt;closing-tag&gt;&#39;</span><span class="p">}</span>
</pre></div>
<p>Using <code>fuzz()</code>, the abstract input can be instantiated to further concrete inputs, all set to produce the failure again:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="nb">print</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>

<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;s1d&gt;&quot;1&lt;/hF&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;H&gt;&quot;c*C&lt;/l&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;Ah2&gt;&quot;&lt;/v&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;a7&gt;&quot;)&lt;/NP&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;boyIIt640TF&gt;&quot;&lt;/b08&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;dF&gt;&quot;&lt;/fay&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;l2&gt;&quot;</span><span class="se">\t</span><span class="s1">7&lt;/z&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;ci&gt;&quot;&lt;/t&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;J&gt;&quot;2&lt;/t&gt;&#39;</span><span class="p">)</span>
<span class="n">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&lt;Fo9g&gt;&quot;</span><span class="se">\r</span><span class="s1">~</span><span class="se">\t\r</span><span class="s1">&lt;/D&gt;&#39;</span><span class="p">)</span>
</pre></div>
<p><code>DDSetDebugger</code> can be customized by passing a subclass of <code>TreeGeneralizer</code>, which does the gist of the work; for details, see its constructor.
The full class hierarchy is shown below.</p>
<p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="453pt" height="536pt"
 viewBox="0.00 0.00 452.50 536.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 532)">
<title>%3</title>
<g id="a_graph0"><a xlink:title="DDSetDebugger class hierarchy">
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-532 448.5,-532 448.5,4 -4,4"/>
</a>
</g>
<!-- DDSetDebugger -->
<g id="node1" class="node">
<title>DDSetDebugger</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class DDSetDebugger:&#10;Debugger implementing the DDSET algorithm for abstracting failure&#45;inducing inputs.">
<polygon fill="none" stroke="#000000" points="20.5,-17 20.5,-103 146.5,-103 146.5,-17 20.5,-17"/>
<text text-anchor="start" x="28.5" y="-88.8" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">DDSetDebugger</text>
<polyline fill="none" stroke="#000000" points="20.5,-80 146.5,-80 "/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="DDSetDebugger">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__init__(self, grammar:Dict[str, List[Union[str, Tuple[str, Dict[str, Any]]]]], generalizer_class:Type=&lt;class &#39;__main__.TreeGeneralizer&#39;&gt;, parser:Union[fuzzingbook.Parser.Parser, NoneType]=None, **kwargs:Any) &#45;&gt; None:&#10;Constructor.&#10;`grammar` is an input grammar in fuzzingbook format.&#10;`generalizer_class` is the tree generalizer class to use&#10;(default: `TreeGeneralizer`)&#10;`parser` is the parser to use (default: `EarleyParser(grammar)`).&#10;All other keyword args are passed to the tree generalizer, notably:&#10;`fuzzer` &#45; the fuzzer to use (default: `GrammarFuzzer`), and&#10;`log` &#45; enables debugging output if True.">
<text text-anchor="start" x="47.5" y="-68.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00" fill="#000000">__init__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="__repr__(self) &#45;&gt; str:&#10;Return a string representation of the generalized call.">
<text text-anchor="start" x="47.5" y="-57.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">__repr__()</text>
</a>
</g>
<g id="a_node1_3"><a xlink:href="#" xlink:title="fuzz(self) &#45;&gt; str:&#10;Return a call with arguments randomly instantiated&#10;from the abstract failure&#45;inducing pattern.">
<text text-anchor="start" x="47.5" y="-46.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">fuzz()</text>
</a>
</g>
<g id="a_node1_4"><a xlink:href="#" xlink:title="fuzz_args(self) &#45;&gt; Dict[str, Any]:&#10;Return arguments randomly instantiated&#10;from the abstract failure&#45;inducing pattern.">
<text text-anchor="start" x="47.5" y="-35.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">fuzz_args()</text>
</a>
</g>
<g id="a_node1_5"><a xlink:href="#" xlink:title="generalize(self) &#45;&gt; Dict[str, Any]:&#10;Generalize arguments seen. For each function argument,&#10;produce an abstract failure&#45;inducing input that characterizes&#10;the set of inputs for which the function fails.">
<text text-anchor="start" x="47.5" y="-24.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">generalize()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CallCollector -->
<g id="node2" class="node">
<title>CallCollector</title>
<g id="a_node2"><a xlink:href="DeltaDebugger.html" xlink:title="class CallCollector:&#10;Collect an exception&#45;raising function call f().&#10;Use as `with CallCollector(): f()`">
<polygon fill="none" stroke="#000000" points="21,-156.5 21,-319.5 146,-319.5 146,-156.5 21,-156.5"/>
<text text-anchor="start" x="38.5" y="-305.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">CallCollector</text>
<polyline fill="none" stroke="#000000" points="21,-296.5 146,-296.5 "/>
<g id="a_node2_6"><a xlink:href="#" xlink:title="CallCollector">
<g id="a_node2_7"><a xlink:href="DeltaDebugger.html" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Called at begin of `with` block. Turn tracing on.">
<text text-anchor="start" x="29.5" y="-285.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">__enter__()</text>
</a>
</g>
<g id="a_node2_8"><a xlink:href="DeltaDebugger.html" xlink:title="__exit__(self, exc_tp:Type, exc_value:BaseException, exc_traceback:traceback) &#45;&gt; Union[bool, NoneType]:&#10;Called at end of `with` block. Turn tracing off.">
<text text-anchor="start" x="29.5" y="-274.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">__exit__()</text>
</a>
</g>
<g id="a_node2_9"><a xlink:href="DeltaDebugger.html" xlink:title="__init__(self) &#45;&gt; None:&#10;Initialize collector">
<text text-anchor="start" x="29.5" y="-263.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00" fill="#000000">__init__()</text>
</a>
</g>
<g id="a_node2_10"><a xlink:href="DeltaDebugger.html" xlink:title="args(self) &#45;&gt; Dict[str, Any]:&#10;Return the dictionary of collected arguments.">
<text text-anchor="start" x="29.5" y="-252.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">args()</text>
</a>
</g>
<g id="a_node2_11"><a xlink:href="DeltaDebugger.html" xlink:title="call(self, new_args:Union[Dict[str, Any], NoneType]=None) &#45;&gt; Any:&#10;Call collected function. If `new_args` is given,&#10;override arguments from its {var: value} entries.">
<text text-anchor="start" x="29.5" y="-241.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">call()</text>
</a>
</g>
<g id="a_node2_12"><a xlink:href="DeltaDebugger.html" xlink:title="exception(self) &#45;&gt; Union[BaseException, NoneType]:&#10;Return the exception produced, or `None` if none.">
<text text-anchor="start" x="29.5" y="-230.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">exception()</text>
</a>
</g>
<g id="a_node2_13"><a xlink:href="DeltaDebugger.html" xlink:title="function(self) &#45;&gt; Callable:&#10;Return the function called.">
<text text-anchor="start" x="29.5" y="-219.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00" fill="#000000">function()</text>
</a>
</g>
<g id="a_node2_14"><a xlink:href="DeltaDebugger.html" xlink:title="after_collection(self) &#45;&gt; None:&#10;Called after collection. To be defined in subclasses.">
<text text-anchor="start" x="29.5" y="-208.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00" fill="#000000">after_collection()</text>
</a>
</g>
<g id="a_node2_15"><a xlink:href="DeltaDebugger.html" xlink:title="format_call(self, args:Union[Dict[str, Any], NoneType]=None) &#45;&gt; str:&#10;Return a string representing a call of the function with given args.">
<text text-anchor="start" x="29.5" y="-196.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">format_call()</text>
</a>
</g>
<g id="a_node2_16"><a xlink:href="DeltaDebugger.html" xlink:title="format_exception(self, exc:Union[BaseException, NoneType]=None) &#45;&gt; str:&#10;Return a string representing the given exception.">
<text text-anchor="start" x="29.5" y="-185.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">format_exception()</text>
</a>
</g>
<g id="a_node2_17"><a xlink:href="DeltaDebugger.html" xlink:title="init(self) &#45;&gt; None:&#10;Reset for new collection.">
<text text-anchor="start" x="29.5" y="-174.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">init()</text>
</a>
</g>
<g id="a_node2_18"><a xlink:href="DeltaDebugger.html" xlink:title="traceit(self, frame:frame, event:str, arg:Any) &#45;&gt; None:&#10;Tracing function. Collect first call, then turn tracing off.">
<text text-anchor="start" x="29.5" y="-163.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">traceit()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- DDSetDebugger&#45;&gt;CallCollector -->
<g id="edge1" class="edge">
<title>DDSetDebugger&#45;&gt;CallCollector</title>
<path fill="none" stroke="#000000" d="M83.5,-103.0888C83.5,-116.1301 83.5,-130.9825 83.5,-145.9501"/>
<polygon fill="none" stroke="#000000" points="80.0001,-146.3097 83.5,-156.3098 87.0001,-146.3098 80.0001,-146.3097"/>
</g>
<!-- StackInspector -->
<g id="node3" class="node">
<title>StackInspector</title>
<g id="a_node3"><a xlink:href="StackInspector.html" xlink:title="class StackInspector:&#10;Provide functions to inspect the stack">
<polygon fill="none" stroke="#000000" points="0,-356.5 0,-527.5 167,-527.5 167,-356.5 0,-356.5"/>
<text text-anchor="start" x="32.5" y="-513.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">StackInspector</text>
<polyline fill="none" stroke="#000000" points="0,-504.5 167,-504.5 "/>
<g id="a_node3_19"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_20"><a xlink:href="StackInspector.html" xlink:title="_generated_function_cache = {}">
<text text-anchor="start" x="8.5" y="-492" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">_generated_function_cache</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="#000000" points="0,-485.5 167,-485.5 "/>
<g id="a_node3_21"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node3_22"><a xlink:href="StackInspector.html" xlink:title="caller_frame(self) &#45;&gt; frame:&#10;Return the frame of the caller.">
<text text-anchor="start" x="26.5" y="-473" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_frame()</text>
</a>
</g>
<g id="a_node3_23"><a xlink:href="StackInspector.html" xlink:title="caller_function(self) &#45;&gt; Callable:&#10;Return the calling function">
<text text-anchor="start" x="26.5" y="-462" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_function()</text>
</a>
</g>
<g id="a_node3_24"><a xlink:href="StackInspector.html" xlink:title="caller_globals(self) &#45;&gt; Dict[str, Any]:&#10;Return the globals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-451" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_globals()</text>
</a>
</g>
<g id="a_node3_25"><a xlink:href="StackInspector.html" xlink:title="caller_locals(self) &#45;&gt; Dict[str, Any]:&#10;Return the locals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-440" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_locals()</text>
</a>
</g>
<g id="a_node3_26"><a xlink:href="StackInspector.html" xlink:title="caller_location(self) &#45;&gt; Tuple[Callable, int]:&#10;Return the location (func, lineno) of the caller.">
<text text-anchor="start" x="26.5" y="-429" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">caller_location()</text>
</a>
</g>
<g id="a_node3_27"><a xlink:href="StackInspector.html" xlink:title="create_function(self, frame:frame) &#45;&gt; Callable:&#10;Create function for given frame">
<text text-anchor="start" x="26.5" y="-418" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">create_function()</text>
</a>
</g>
<g id="a_node3_28"><a xlink:href="StackInspector.html" xlink:title="is_internal_error(self, exc_tp:Type, exc_value:BaseException, exc_traceback:traceback) &#45;&gt; bool:&#10;Return True if exception was raised from `StackInspector` or a subclass.">
<text text-anchor="start" x="26.5" y="-407" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">is_internal_error()</text>
</a>
</g>
<g id="a_node3_29"><a xlink:href="StackInspector.html" xlink:title="our_frame(self, frame:frame) &#45;&gt; bool:&#10;Return true if `frame` is in the current (inspecting) class.">
<text text-anchor="start" x="26.5" y="-396" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">our_frame()</text>
</a>
</g>
<g id="a_node3_30"><a xlink:href="StackInspector.html" xlink:title="search_frame(self, name:str, frame:Union[frame, NoneType]=None) &#45;&gt; Tuple[Union[frame, NoneType], Union[Callable, NoneType]]:&#10;Return a pair (`frame`, `item`)&#10;in which the function `name` is defined as `item`.">
<text text-anchor="start" x="26.5" y="-385" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">search_frame()</text>
</a>
</g>
<g id="a_node3_31"><a xlink:href="StackInspector.html" xlink:title="search_func(self, name:str, frame:Union[frame, NoneType]=None) &#45;&gt; Union[Callable, NoneType]:&#10;Search in callers for a definition of the function `name`">
<text text-anchor="start" x="26.5" y="-374" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">search_func()</text>
</a>
</g>
<g id="a_node3_32"><a xlink:href="StackInspector.html" xlink:title="unknown(self) &#45;&gt; None">
<text text-anchor="start" x="26.5" y="-363" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">unknown()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CallCollector&#45;&gt;StackInspector -->
<g id="edge2" class="edge">
<title>CallCollector&#45;&gt;StackInspector</title>
<path fill="none" stroke="#000000" d="M83.5,-319.5057C83.5,-328.2948 83.5,-337.2957 83.5,-346.2325"/>
<polygon fill="none" stroke="#000000" points="80.0001,-346.2806 83.5,-356.2806 87.0001,-346.2806 80.0001,-346.2806"/>
</g>
<!-- TreeGeneralizer -->
<g id="node4" class="node">
<title>TreeGeneralizer</title>
<g id="a_node4"><a xlink:href="#" xlink:title="class TreeGeneralizer:&#10;Determine which parts of a derivation tree can be generalized.">
<polygon fill="none" stroke="#000000" points="165,-.5 165,-119.5 308,-119.5 308,-.5 165,-.5"/>
<text text-anchor="start" x="182" y="-105.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">TreeGeneralizer</text>
<polyline fill="none" stroke="#000000" points="165,-96.5 308,-96.5 "/>
<g id="a_node4_33"><a xlink:href="#" xlink:title="TreeGeneralizer">
<g id="a_node4_34"><a xlink:href="#" xlink:title="__init__(self, grammar:Dict[str, List[Union[str, Tuple[str, Dict[str, Any]]]]], tree:Tuple[str, Union[List[Any], NoneType]], test:Callable, max_tries_for_generalization:int=10, **kwargs:Any) &#45;&gt; None:&#10;Constructor. `grammar` and `tree` are as in `TreeMutator`.&#10;`test` is a function taking a string that either&#10;* raises an exception, indicating test failure;&#10;* or not, indicating test success.&#10;`max_tries_for_generalization` is the number of times&#10;an instantiation has to fail before it is generalized.">
<text text-anchor="start" x="173.5" y="-85.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00" fill="#000000">__init__()</text>
</a>
</g>
<g id="a_node4_35"><a xlink:href="#" xlink:title="can_generalize(self, path:List[int], tree:Union[Tuple[str, Union[List[Any], NoneType]], NoneType]=None) &#45;&gt; bool:&#10;Return True if the subtree at `path` can be generalized.">
<text text-anchor="start" x="173.5" y="-73.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">can_generalize()</text>
</a>
</g>
<g id="a_node4_36"><a xlink:href="#" xlink:title="find_paths(self, predicate:Callable[[List[int], Tuple[str, Union[List[Any], NoneType]]], bool], path:Union[List[int], NoneType]=None, tree:Union[Tuple[str, Union[List[Any], NoneType]], NoneType]=None) &#45;&gt; List[List[int]]:&#10;Return a list of all paths for which `predicate` holds.&#10;`predicate` is a function `predicate`(`path`, `tree`), where&#10;`path` denotes a subtree in `tree`. If `predicate()` returns&#10;True, `path` is included in the returned list.">
<text text-anchor="start" x="173.5" y="-62.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">find_paths()</text>
</a>
</g>
<g id="a_node4_37"><a xlink:href="#" xlink:title="fuzz_tree(self, tree:Tuple[str, Union[List[Any], NoneType]]) &#45;&gt; Tuple[str, Union[List[Any], NoneType]]:&#10;Return an instantiated copy of `tree`.">
<text text-anchor="start" x="173.5" y="-51.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">fuzz_tree()</text>
</a>
</g>
<g id="a_node4_38"><a xlink:href="#" xlink:title="generalizable_paths(self) &#45;&gt; List[List[int]]:&#10;Return a list of all paths whose subtrees can be generalized.">
<text text-anchor="start" x="173.5" y="-40.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">generalizable_paths()</text>
</a>
</g>
<g id="a_node4_39"><a xlink:href="#" xlink:title="generalize(self) &#45;&gt; Tuple[str, Union[List[Any], NoneType]]:&#10;Returns a copy of the tree in which all generalizable subtrees&#10;are generalized (= replaced by nonterminals without children)">
<text text-anchor="start" x="173.5" y="-29.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">generalize()</text>
</a>
</g>
<g id="a_node4_40"><a xlink:href="#" xlink:title="generalize_path(self, path:List[int], tree:Union[Tuple[str, Union[List[Any], NoneType]], NoneType]=None) &#45;&gt; Tuple[str, Union[List[Any], NoneType]]:&#10;Return a copy of the tree in which the subtree at `path`&#10;is generalized (= replaced by a nonterminal without children)">
<text text-anchor="start" x="173.5" y="-18.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">generalize_path()</text>
</a>
</g>
<g id="a_node4_41"><a xlink:href="#" xlink:title="test_tree(self, tree:Tuple[str, Union[List[Any], NoneType]]) &#45;&gt; bool:&#10;Return True if testing `tree` passes, else False">
<text text-anchor="start" x="173.5" y="-7.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">test_tree()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- TreeMutator -->
<g id="node5" class="node">
<title>TreeMutator</title>
<g id="a_node5"><a xlink:href="#" xlink:title="class TreeMutator:&#10;Grammar&#45;based mutations of derivation trees.">
<polygon fill="none" stroke="#000000" points="186,-200.5 186,-275.5 287,-275.5 287,-200.5 186,-200.5"/>
<text text-anchor="start" x="194" y="-261.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">TreeMutator</text>
<polyline fill="none" stroke="#000000" points="186,-252.5 287,-252.5 "/>
<g id="a_node5_42"><a xlink:href="#" xlink:title="TreeMutator">
<g id="a_node5_43"><a xlink:href="#" xlink:title="__init__(self, grammar:Dict[str, List[Union[str, Tuple[str, Dict[str, Any]]]]], tree:Tuple[str, Union[List[Any], NoneType]], fuzzer:Union[fuzzingbook.GrammarFuzzer.GrammarFuzzer, NoneType]=None, log:int=False):&#10;Constructor.&#10;`grammar` is the underlying grammar;&#10;`tree` is the tree to work on.&#10;`fuzzer` is the grammar fuzzer to use (default: `GrammarFuzzer`)">
<text text-anchor="start" x="197.5" y="-241.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00" fill="#000000">__init__()</text>
</a>
</g>
<g id="a_node5_44"><a xlink:href="#" xlink:title="get_subtree(self, path:List[int], tree:Union[Tuple[str, Union[List[Any], NoneType]], NoneType]=None) &#45;&gt; Tuple[str, Union[List[Any], NoneType]]:&#10;Access a subtree based on `path` (a list of children numbers)">
<text text-anchor="start" x="197.5" y="-229.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">get_subtree()</text>
</a>
</g>
<g id="a_node5_45"><a xlink:href="#" xlink:title="mutate(self, path:List[int], tree:Union[Tuple[str, Union[List[Any], NoneType]], NoneType]=None) &#45;&gt; Tuple[str, Union[List[Any], NoneType]]:&#10;Return a new tree mutated at `path`">
<text text-anchor="start" x="197.5" y="-218.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">mutate()</text>
</a>
</g>
<g id="a_node5_46"><a xlink:href="#" xlink:title="new_tree(self, start_symbol:str) &#45;&gt; Tuple[str, Union[List[Any], NoneType]]:&#10;Create a new subtree for &lt;start_symbol&gt;.">
<text text-anchor="start" x="197.5" y="-207.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00" fill="#000000">new_tree()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- TreeGeneralizer&#45;&gt;TreeMutator -->
<g id="edge3" class="edge">
<title>TreeGeneralizer&#45;&gt;TreeMutator</title>
<path fill="none" stroke="#000000" d="M236.5,-119.7666C236.5,-142.6805 236.5,-168.5026 236.5,-190.1565"/>
<polygon fill="none" stroke="#000000" points="233.0001,-190.4207 236.5,-200.4207 240.0001,-190.4208 233.0001,-190.4207"/>
</g>
<!-- Legend -->
<g id="node6" class="node">
<title>Legend</title>
<text text-anchor="start" x="326.5" y="-77.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="10.00" fill="#6a0dad">Legend</text>
<text text-anchor="start" x="326.5" y="-67.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00" fill="#000000">• </text>
<text text-anchor="start" x="333.5" y="-67.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00" fill="#000000">public_method()</text>
<text text-anchor="start" x="326.5" y="-57.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00" fill="#000000">• </text>
<text text-anchor="start" x="333.5" y="-57.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00" fill="#000000">private_method()</text>
<text text-anchor="start" x="326.5" y="-47.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00" fill="#000000">• </text>
<text text-anchor="start" x="333.5" y="-47.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00" fill="#000000">overloaded_method()</text>
<text text-anchor="start" x="326.5" y="-38.3" font-family="Helvetica,sans-Serif" font-size="9.00" fill="#000000">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
</div>
</div>
</div>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="A-Failing-Program">A Failing Program<a class="anchor-link" href="#A-Failing-Program">&#182;</a></h2><p>As with previous chapters, we use <code>remove_html_markup()</code> as our ongoing example. This function is set to remove HTML markup tags (like <code>&lt;em&gt;</code>) from a given string <code>s</code>, returning the plain text only. We use the version from <a href="Assertions.html">the chapter on asssertions</a>, using an assertion as postcondition checker.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">remove_html_markup</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">quote</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">quote</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">quote</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">quote</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="n">c</span>

    <span class="c1"># postcondition</span>
    <span class="k">assert</span> <span class="s1">&#39;&lt;&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span> <span class="ow">and</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For the most inputs, <code>remove_html_markup()</code> works just as expected:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="s2">&quot;Be &lt;em&gt;quiet&lt;/em&gt;, he said&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;Be quiet, he said&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>There are inputs, however, for which it fails:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">BAD_INPUT</span> <span class="o">=</span> <span class="s1">&#39;&lt;foo&gt;&quot;bar&lt;/foo&gt;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="ExpectError.html" class="import" target="_blank">ExpectError</a></span> <span class="kn">import</span> <span class="n">ExpectError</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="n">BAD_INPUT</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-491b4345bb53&gt;&#34;, line 2, in &lt;module&gt;
    remove_html_markup(BAD_INPUT)
  File &#34;&lt;ipython-input-1-02fa29ebf01a&gt;&#34;, line 17, in remove_html_markup
    assert &#39;&lt;&#39; not in out and &#39;&gt;&#39; not in out
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/fuzzingbook/tree/master/notebooks/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">quiz</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In contrast to the other chapters, our aim now is not to immediately go and debug <code>remove_html_markup()</code>. Instead, we focus on another important question:</p>
<blockquote><p>Under which conditions precisely does <code>remove_html_markup()</code> fail?</p>
</blockquote>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This question can be generalized to</p>
<blockquote><p>What is the set of inputs for which <code>remove_html_markup()</code> fails?</p>
</blockquote>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our plan for this is to <em>generalize</em> concrete inputs (such as <code>BAD_INPUTS</code>) into an <em>abstract failure-inducing inputs</em>. These are patterns formed from a concrete input, but in which specific <em>placeholders</em> indicate sets of inputs that are permitted. In the abstract failure-inducing input</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">opening-tag</span><span class="p">&gt;</span>&quot;bar<span class="p">&lt;</span><span class="nt">closing-tag</span><span class="p">&gt;</span>
</pre></div>
<p>for instance, <code>&lt;opening-tag&gt;</code> and <code>&lt;closing-tag&gt;</code> are placeholders for opening and closing HTML tags, respectively. The pattern indicates that any opening HTML tag and closing HTML tag can be present in the input, as long as the enclosed text reads <code>"bar</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Given a concrete failure-inducing input, our aim is to <em>generalize</em> it as much as possible to such an abstract failure-inducing input. The resulting pattern should then</p>
<ul>
<li>capture the <em>circumstances</em> under which the program fails;</li>
<li>allow for <em>test generation</em> by instantiating the placeholders;</li>
<li>help ensuring our fix is as <em>general as possible</em>.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">If <code>s = '&lt;foo&gt;"bar&lt;/foo&gt;'</code> (i.e., <code>BAD_INPUT</code>), what is the value of <code>out</code> such that the assertion fails?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="5bff24c0-82be-11eb-a588-acde48001122" id="5bff24c0-82be-11eb-a588-acde48001122-1" onclick="clear_selection('5bff24c0-82be-11eb-a588-acde48001122')">
        <label id="5bff24c0-82be-11eb-a588-acde48001122-1-label" for="5bff24c0-82be-11eb-a588-acde48001122-1"><code>bar</code></label><br>

        <input type="radio" name="5bff24c0-82be-11eb-a588-acde48001122" id="5bff24c0-82be-11eb-a588-acde48001122-2" onclick="clear_selection('5bff24c0-82be-11eb-a588-acde48001122')">
        <label id="5bff24c0-82be-11eb-a588-acde48001122-2-label" for="5bff24c0-82be-11eb-a588-acde48001122-2"><code>bar&lt;/foo&gt;</code></label><br>

        <input type="radio" name="5bff24c0-82be-11eb-a588-acde48001122" id="5bff24c0-82be-11eb-a588-acde48001122-3" onclick="clear_selection('5bff24c0-82be-11eb-a588-acde48001122')">
        <label id="5bff24c0-82be-11eb-a588-acde48001122-3-label" for="5bff24c0-82be-11eb-a588-acde48001122-3"><code>"bar&lt;/foo&gt;</code></label><br>

        <input type="radio" name="5bff24c0-82be-11eb-a588-acde48001122" id="5bff24c0-82be-11eb-a588-acde48001122-4" onclick="clear_selection('5bff24c0-82be-11eb-a588-acde48001122')">
        <label id="5bff24c0-82be-11eb-a588-acde48001122-4-label" for="5bff24c0-82be-11eb-a588-acde48001122-4"><code>&lt;foo&gt;"bar&lt;/foo&gt;</code></label><br>

    </div>
    </p>
    <input id="5bff24c0-82be-11eb-a588-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('5bff24c0-82be-11eb-a588-acde48001122', 4, 0, '9999999 // 4999999')">
    <span class="quiz_hint" id="5bff24c0-82be-11eb-a588-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Grammars">Grammars<a class="anchor-link" href="#Grammars">&#182;</a></h2><p>To determine abstract failure-inducing inputs, we need means to determine and characterize <em>sets of inputs</em> – known in computer science as <em>languages</em>. To formally describe languages, the field of <em>formal languages</em> has devised a number of <em>language specifications</em> that describe a language.  <em>Regular expressions</em> represent the simplest class of these languages to denote sets of strings: The regular expression <code>[a-z]*</code>, for instance, denotes a (possibly empty) sequence of lowercase letters.  <em>Automata theory</em> connects these languages to automata that accept these inputs; <em>finite state machines</em>, for instance, can be used to specify the language of regular expressions.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Regular expressions are great for not-too-complex input formats, and the associated finite state machines have many properties that make them great for reasoning.  To specify more complex inputs, though, they quickly encounter limitations.  At the other end of the language spectrum, we have <em>universal grammars</em> that denote the language accepted by <em>Turing machines</em>.  A Turing machine can compute anything that can be computed; and with Python being Turing-complete, this means that we can also use a Python program $p$ to specify or even enumerate legal inputs. But then, computer science theory also tells us that each such program has to be written specifically for the input to be considered, which is not the level of automation we want.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The middle ground between regular expressions and Turing machines is covered by <em>grammars</em>.  Grammars are among the most popular (and best understood) formalisms to formally specify input languages.  Using a grammar, one can express a wide range of the properties of an input language.  Grammars are particularly great for expressing the <em>syntactical structure</em> of an input, and are the formalism of choice to express nested or recursive inputs.  The grammars we use are so-called <em>context-free grammars</em>, one of the easiest and most popular grammar formalisms.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A grammar is defined as a mapping of <em>nonterminal</em> symbols (denoted in <code>&lt;angle brackets&gt;</code> to lists of alternative <em>expansions</em>, which are strings containing <em>terminal</em> symbols and possibly more <em>nonterminal</em> symbols. To make the writing of grammars as simple as possible, we adopt the <a href="https://www.fuzzingbook.org/">fuzzingbook</a> format that is based on strings and lists.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://www.fuzzingbook.org/" class="import" target="_blank">fuzzingbook</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Fuzzingbook grammars take the format of a <em>mapping</em> between symbol names and expansions, where expansions are <em>lists</em> of alternatives.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/typing.html" class="import" target="_blank">typing</a></span> <span class="kn">import</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/typing.html" class="import" target="_blank">typing</a></span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">FrozenSet</span><span class="p">,</span> <span class="n">cast</span><span class="p">,</span> <span class="n">Generator</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Grammar</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span>  <span class="c1"># A grammar maps strings...</span>
               <span class="n">List</span><span class="p">[</span>
                   <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span>  <span class="c1"># to list of strings...</span>
                         <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>  <span class="c1"># or to pairs of strings and attributes.</span>
                        <span class="p">]</span>
               <span class="p">]</span>
              <span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A one-rule grammar for digits thus takes the form</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DIGIT_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>which means that the <code>&lt;start&gt;</code> symbol can be expanded into any of the digits listed.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A full grammar for arithmetic expressions looks like this:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">EXPR_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;expr&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;expr&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;term&gt; + &lt;expr&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;term&gt; - &lt;expr&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;term&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;term&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;factor&gt; * &lt;term&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;factor&gt; / &lt;term&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;factor&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;factor&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;+&lt;factor&gt;&quot;</span><span class="p">,</span>
         <span class="s2">&quot;-&lt;factor&gt;&quot;</span><span class="p">,</span>
         <span class="s2">&quot;(&lt;expr&gt;)&quot;</span><span class="p">,</span>
         <span class="s2">&quot;&lt;integer&gt;.&lt;integer&gt;&quot;</span><span class="p">,</span>
         <span class="s2">&quot;&lt;integer&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;integer&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;digit&gt;&lt;integer&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>From such a grammar, one can easily generate inputs that conform to the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://www.fuzzingbook.org/html/GrammarFuzzer.html" class="import" target="_blank">fuzzingbook.GrammarFuzzer</a></span> <span class="kn">import</span> <span class="n">GrammarFuzzer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_expr_fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">EXPR_GRAMMAR</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">fuzz_expr</span> <span class="o">=</span> <span class="n">simple_expr_fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fuzz_expr</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3.8 + --62.912 - ++4 - +5 * 3.0 * 4
7 * (75.5 - -6 + 5 - 4) + -(8 - 1) / 5 * 2
(-(9) * +6 + 9 / 3 * 8 - 9 * 8 / 7) / -+-65
(9 + 8) * 2 * (6 + 6 + 9) * 0 * 1.9 * 0
(1 * 7 - 9 + 5) * 5 / 0 * 5 + 7 * 5 * 7
-(6 / 9 - 5 - 3 - 1) - -1 / +1 + (9) / (8) * 6
(+-(0 - (1) * 7 / 3)) / ((1 * 3 + 8) + 9 - +1 / --0) - 5 * (-+939.491)
+2.9 * 0 / 501.19814 / --+--(6.05002)
+-8.8 / (1) * -+1 + -8 + 9 - 3 / 8 * 6 + 4 * 3 * 5
(+(8 / 9 - 1 - 7)) + ---06.30 / +4.39
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Nonterminals as found in the grammar make natural <em>placeholders</em> in abstract failure-inducing inputs. If we know, for instance, that it is not just the concrete failure-inducing input</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
<p>but the abstract failure-inducing input</p>
<div class="highlight"><pre><span></span>(<span class="p">&lt;</span><span class="nt">expr</span><span class="p">&gt;</span> * <span class="p">&lt;</span><span class="nt">expr</span><span class="p">&gt;</span>)
</pre></div>
<p>that causes the failure, we immediately see that the error is due to the multiplication operator rather than its operands.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Coming back to our <code>remove_html_markup()</code> example, let us create a simple grammar for HTML expressions. A <code>&lt;html&gt;</code> element is either plain text or tagged text.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;html&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;html&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;plain-text&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;tagged-text&gt;&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Plain text is a simple (possibly empty) sequence of letter, digits, punctuation, and whitespace. (Note how <code>&lt;plain-text&gt;</code> is either empty or some character followed by more plain text.) The characters <code>&lt;</code> and <code>&gt;</code> are not allowed, though.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/string.html" class="import" target="_blank">string</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s2">&quot;&lt;plain-text&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;plain-char&gt;&lt;plain-text&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;plain-char&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;letter&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;other&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;whitespace&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;letter&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">),</span>
    <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">),</span>
    <span class="s2">&quot;&lt;other&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)),</span>
    <span class="s2">&quot;&lt;whitespace&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">whitespace</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Tagged text is a bit more complicated. We have opening tags <code>&lt;foo&gt;</code>, followed by some more HTML material, and then closed by a closing tag <code>&lt;/foo&gt;</code>. (We do not insist that the two tags match.) A self-closing tag has the form <code>&lt;br/&gt;</code>. For compatibility reasons, we also allow just opening tags without closing tags, as in <code>&lt;img&gt;</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s2">&quot;&lt;tagged-text&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;opening-tag&gt;&lt;html&gt;&lt;closing-tag&gt;&quot;</span><span class="p">,</span>
         <span class="s2">&quot;&lt;self-closing-tag&gt;&quot;</span><span class="p">,</span>
         <span class="s2">&quot;&lt;opening-tag&gt;&quot;</span><span class="p">],</span>
<span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Since the characters <code>&lt;</code> and <code>&gt;</code> are already reserved for denoting nonterminal symbols, we use the special nonterminal symbols <code>&lt;lt&gt;</code> and <code>&lt;gt&gt;</code> that expand into <code>&lt;</code> and <code>&gt;</code>, respectively,</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s2">&quot;&lt;opening-tag&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;lt&gt;&lt;id&gt;&lt;gt&gt;&quot;</span><span class="p">,</span>
         <span class="s2">&quot;&lt;lt&gt;&lt;id&gt;&lt;attrs&gt;&lt;gt&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;lt&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;&quot;</span><span class="p">],</span>
    <span class="s2">&quot;&lt;gt&gt;&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;letter&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;id&gt;&lt;letter&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;id&gt;&lt;digit&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;closing-tag&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;lt&gt;/&lt;id&gt;&lt;gt&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;self-closing-tag&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;lt&gt;&lt;id&gt;&lt;attrs&gt;/&lt;gt&gt;&quot;</span><span class="p">],</span>
<span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Finally, HTML tags can have attributes, which are enclosed in quotes.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s2">&quot;&lt;attrs&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;attr&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;attr&gt;&lt;attrs&gt;&quot;</span> <span class="p">],</span>

    <span class="s2">&quot;&lt;attr&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot; &lt;id&gt;=&#39;&lt;plain-text&gt;&#39;&quot;</span><span class="p">,</span>
         <span class="s1">&#39; &lt;id&gt;=&quot;&lt;plain-text&gt;&quot;&#39;</span><span class="p">],</span>
<span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, we can generate inputs from the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_html_fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">fuzz_html</span> <span class="o">=</span> <span class="n">simple_html_fuzzer</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">fuzz_html</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&#39;&lt;T3 xG=&#34;&#34;&gt;&#39;
&#39;&lt;N9cd U=\&#39;\&#39; y=\&#39;l1\&#39; v0=&#34;&#34; tb4ya=&#34;&#34; UbD=\&#39;\&#39;&gt;9&lt;/R&gt;&#39;
&#39;\x0b&#39;
&#39; ea\\\\&#39;
&#39;&amp;7&#39;
&#34;&lt;c1 o2=&#39;&#39; x9661lQo64T=&#39;&#39;/&gt;&#34;
&#39;&lt;S4&gt;&#39;
&#39;&lt;GMS&gt;&lt;/wAu&gt;&#39;
&#39;&lt;j CI=\&#39;\&#39; T98sJ=&#34;&#34; DR4=\&#39;\&#39;/&gt;&#39;
&#39;&lt;FQc90 Wt=&#34;&#34;/&gt;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Such inputs, of course, are great for systematic testing. Our sister book, <a href="https://www.fuzzingbook.org/">the fuzzing book</a>, covers these and more.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Derivation-Trees">Derivation Trees<a class="anchor-link" href="#Derivation-Trees">&#182;</a></h2><p>To produce inputs from a grammar, the fuzzingbook <code>GrammarFuzzer</code> makes use of a structure called a <em>derivation tree</em> (also known as <em>syntax tree</em>). A derivation tree encodes the individual expansion steps undertaken while producing the output.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DerivationTree</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us illustrate derivation trees by example, using the last HTML output we produced.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fuzz_html</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&lt;FQc90 Wt=&#34;&#34;/&gt;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>GrammarFuzzer</code> attribute <code>derivation_tree</code> holds the last tree used to produced this input. We can visualize the tree as follows:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display_tree</span><span class="p">(</span><span class="n">simple_html_fuzzer</span><span class="o">.</span><span class="n">derivation_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="787pt" height="764pt"
 viewBox="0.00 0.00 787.00 764.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 760)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-760 783,-760 783,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="none" stroke="#ffffff" points="446.5,-756 387.5,-756 387.5,-720 446.5,-720 446.5,-756"/>
<text text-anchor="middle" x="417" y="-734.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="none" stroke="#ffffff" points="444,-684 390,-684 390,-648 444,-648 444,-684"/>
<text text-anchor="middle" x="417" y="-662.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;html&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M417,-719.8314C417,-712.131 417,-702.9743 417,-694.4166"/>
<polygon fill="#000000" stroke="#000000" points="420.5001,-694.4132 417,-684.4133 413.5001,-694.4133 420.5001,-694.4132"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="none" stroke="#ffffff" points="472,-612 362,-612 362,-576 472,-576 472,-612"/>
<text text-anchor="middle" x="417" y="-590.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;tagged&#45;text&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M417,-647.8314C417,-640.131 417,-630.9743 417,-622.4166"/>
<polygon fill="#000000" stroke="#000000" points="420.5001,-622.4132 417,-612.4133 413.5001,-622.4133 420.5001,-622.4132"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="none" stroke="#ffffff" points="493,-540 341,-540 341,-504 493,-504 493,-540"/>
<text text-anchor="middle" x="417" y="-518.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;self&#45;closing&#45;tag&gt;</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M417,-575.8314C417,-568.131 417,-558.9743 417,-550.4166"/>
<polygon fill="#000000" stroke="#000000" points="420.5001,-550.4132 417,-540.4133 413.5001,-550.4133 420.5001,-550.4132"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<polygon fill="none" stroke="#ffffff" points="263,-468 209,-468 209,-432 263,-432 263,-468"/>
<text text-anchor="middle" x="236" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;lt&gt;</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M371.3261,-503.8314C340.7861,-491.6829 301.1348,-475.91 272.6584,-464.5824"/>
<polygon fill="#000000" stroke="#000000" points="273.6708,-461.2184 263.0853,-460.7743 271.0834,-467.7227 273.6708,-461.2184"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<polygon fill="none" stroke="#ffffff" points="369,-468 315,-468 315,-432 369,-432 369,-468"/>
<text text-anchor="middle" x="342" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 3&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>3&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M398.0743,-503.8314C389.0143,-495.1337 378.0191,-484.5783 368.1735,-475.1265"/>
<polygon fill="#000000" stroke="#000000" points="370.5574,-472.5633 360.9196,-468.1628 365.7096,-477.613 370.5574,-472.5633"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<polygon fill="none" stroke="#ffffff" points="446.5,-468 387.5,-468 387.5,-432 446.5,-432 446.5,-468"/>
<text text-anchor="middle" x="417" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;attrs&gt;</text>
</g>
<!-- 3&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>3&#45;&gt;21</title>
<path fill="none" stroke="#000000" d="M417,-503.8314C417,-496.131 417,-486.9743 417,-478.4166"/>
<polygon fill="#000000" stroke="#000000" points="420.5001,-478.4132 417,-468.4133 413.5001,-478.4133 420.5001,-478.4132"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<polygon fill="none" stroke="#ffffff" points="519,-468 465,-468 465,-432 519,-432 519,-468"/>
<text text-anchor="middle" x="492" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">/</text>
</g>
<!-- 3&#45;&gt;34 -->
<g id="edge34" class="edge">
<title>3&#45;&gt;34</title>
<path fill="none" stroke="#000000" d="M435.9257,-503.8314C444.9857,-495.1337 455.9809,-484.5783 465.8265,-475.1265"/>
<polygon fill="#000000" stroke="#000000" points="468.2904,-477.613 473.0804,-468.1628 463.4426,-472.5633 468.2904,-477.613"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<polygon fill="none" stroke="#ffffff" points="591,-468 537,-468 537,-432 591,-432 591,-468"/>
<text text-anchor="middle" x="564" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;gt&gt;</text>
</g>
<!-- 3&#45;&gt;35 -->
<g id="edge35" class="edge">
<title>3&#45;&gt;35</title>
<path fill="none" stroke="#000000" d="M454.3026,-503.9776C473.8441,-494.508 498.3678,-482.5805 527.6491,-468.1529"/>
<polygon fill="#000000" stroke="#000000" points="529.4691,-471.1578 536.8889,-463.595 526.3723,-464.8801 529.4691,-471.1578"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<polygon fill="none" stroke="#ffffff" points="224,-396 170,-396 170,-360 224,-360 224,-396"/>
<text text-anchor="middle" x="197" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M226.1587,-431.8314C221.8043,-423.7925 216.5902,-414.1666 211.7831,-405.2918"/>
<polygon fill="#000000" stroke="#000000" points="214.8143,-403.5392 206.9739,-396.4133 208.6592,-406.8732 214.8143,-403.5392"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<polygon fill="none" stroke="#ffffff" points="296,-396 242,-396 242,-360 296,-360 296,-396"/>
<text text-anchor="middle" x="269" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M323.579,-431.8314C314.8471,-423.219 304.2683,-412.7851 294.7577,-403.4048"/>
<polygon fill="#000000" stroke="#000000" points="296.9925,-400.6931 287.4151,-396.1628 292.077,-405.6769 296.9925,-400.6931"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<polygon fill="none" stroke="#ffffff" points="373.5,-396 314.5,-396 314.5,-360 373.5,-360 373.5,-396"/>
<text text-anchor="middle" x="344" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;digit&gt;</text>
</g>
<!-- 6&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>6&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M342.5047,-431.8314C342.7186,-424.131 342.9729,-414.9743 343.2106,-406.4166"/>
<polygon fill="#000000" stroke="#000000" points="346.7094,-406.5066 343.4885,-396.4133 339.7121,-406.3122 346.7094,-406.5066"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<polygon fill="none" stroke="#ffffff" points="219,-324 165,-324 165,-288 219,-288 219,-324"/>
<text text-anchor="middle" x="192" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7&#45;&gt;8</title>
<path fill="none" stroke="#000000" d="M249.5696,-359.8314C240.268,-351.1337 228.9796,-340.5783 218.8714,-331.1265"/>
<polygon fill="#000000" stroke="#000000" points="221.1189,-328.4363 211.4241,-324.1628 216.3379,-333.5493 221.1189,-328.4363"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<polygon fill="none" stroke="#ffffff" points="298.5,-324 239.5,-324 239.5,-288 298.5,-288 298.5,-324"/>
<text text-anchor="middle" x="269" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;digit&gt;</text>
</g>
<!-- 7&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>7&#45;&gt;17</title>
<path fill="none" stroke="#000000" d="M269,-359.8314C269,-352.131 269,-342.9743 269,-334.4166"/>
<polygon fill="#000000" stroke="#000000" points="272.5001,-334.4132 269,-324.4133 265.5001,-334.4133 272.5001,-334.4132"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<polygon fill="none" stroke="#ffffff" points="140,-252 86,-252 86,-216 140,-216 140,-252"/>
<text text-anchor="middle" x="113" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8&#45;&gt;9</title>
<path fill="none" stroke="#000000" d="M172.065,-287.8314C162.5217,-279.1337 150.9401,-268.5783 140.5694,-259.1265"/>
<polygon fill="#000000" stroke="#000000" points="142.6772,-256.3121 132.9287,-252.1628 137.962,-261.4857 142.6772,-256.3121"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<polygon fill="none" stroke="#ffffff" points="226,-252 158,-252 158,-216 226,-216 226,-252"/>
<text text-anchor="middle" x="192" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 8&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>8&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M192,-287.8314C192,-280.131 192,-270.9743 192,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="195.5001,-262.4132 192,-252.4133 188.5001,-262.4133 195.5001,-262.4132"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<polygon fill="none" stroke="#ffffff" points="61,-180 7,-180 7,-144 61,-144 61,-180"/>
<text text-anchor="middle" x="34" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9&#45;&gt;10</title>
<path fill="none" stroke="#000000" d="M93.065,-215.8314C83.5217,-207.1337 71.9401,-196.5783 61.5694,-187.1265"/>
<polygon fill="#000000" stroke="#000000" points="63.6772,-184.3121 53.9287,-180.1628 58.962,-189.4857 63.6772,-184.3121"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<polygon fill="none" stroke="#ffffff" points="147,-180 79,-180 79,-144 147,-144 147,-180"/>
<text text-anchor="middle" x="113" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 9&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>9&#45;&gt;13</title>
<path fill="none" stroke="#000000" d="M113,-215.8314C113,-208.131 113,-198.9743 113,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="116.5001,-190.4132 113,-180.4133 109.5001,-190.4133 116.5001,-190.4132"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<polygon fill="none" stroke="#ffffff" points="68,-108 0,-108 0,-72 68,-72 68,-108"/>
<text text-anchor="middle" x="34" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>10&#45;&gt;11</title>
<path fill="none" stroke="#000000" d="M34,-143.8314C34,-136.131 34,-126.9743 34,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="37.5001,-118.4132 34,-108.4133 30.5001,-118.4133 37.5001,-118.4132"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<polygon fill="none" stroke="#ffffff" points="61,-36 7,-36 7,0 61,0 61,-36"/>
<text text-anchor="middle" x="34" y="-14.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">F</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11&#45;&gt;12</title>
<path fill="none" stroke="#000000" d="M34,-71.8314C34,-64.131 34,-54.9743 34,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="37.5001,-46.4132 34,-36.4133 30.5001,-46.4133 37.5001,-46.4132"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<polygon fill="none" stroke="#ffffff" points="140,-108 86,-108 86,-72 140,-72 140,-108"/>
<text text-anchor="middle" x="113" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">Q</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13&#45;&gt;14</title>
<path fill="none" stroke="#000000" d="M113,-143.8314C113,-136.131 113,-126.9743 113,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="116.5001,-118.4132 113,-108.4133 109.5001,-118.4133 116.5001,-118.4132"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<polygon fill="none" stroke="#ffffff" points="219,-180 165,-180 165,-144 219,-144 219,-180"/>
<text text-anchor="middle" x="192" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">c</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15&#45;&gt;16</title>
<path fill="none" stroke="#000000" d="M192,-215.8314C192,-208.131 192,-198.9743 192,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="195.5001,-190.4132 192,-180.4133 188.5001,-190.4133 195.5001,-190.4132"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<polygon fill="none" stroke="#ffffff" points="298,-252 244,-252 244,-216 298,-216 298,-252"/>
<text text-anchor="middle" x="271" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">9</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17&#45;&gt;18</title>
<path fill="none" stroke="#000000" d="M269.5047,-287.8314C269.7186,-280.131 269.9729,-270.9743 270.2106,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="273.7094,-262.5066 270.4885,-252.4133 266.7121,-262.3122 273.7094,-262.5066"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<polygon fill="none" stroke="#ffffff" points="371,-324 317,-324 317,-288 371,-288 371,-324"/>
<text text-anchor="middle" x="344" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">0</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19&#45;&gt;20</title>
<path fill="none" stroke="#000000" d="M344,-359.8314C344,-352.131 344,-342.9743 344,-334.4166"/>
<polygon fill="#000000" stroke="#000000" points="347.5001,-334.4132 344,-324.4133 340.5001,-334.4133 347.5001,-334.4132"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<polygon fill="none" stroke="#ffffff" points="516,-396 462,-396 462,-360 516,-360 516,-396"/>
<text text-anchor="middle" x="489" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;attr&gt;</text>
</g>
<!-- 21&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>21&#45;&gt;22</title>
<path fill="none" stroke="#000000" d="M435.1686,-431.8314C443.7152,-423.2848 454.0557,-412.9443 463.3802,-403.6198"/>
<polygon fill="#000000" stroke="#000000" points="465.9905,-405.9592 470.5867,-396.4133 461.0408,-401.0095 465.9905,-405.9592"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<polygon fill="none" stroke="#ffffff" points="443,-324 389,-324 389,-288 443,-288 443,-324"/>
<text text-anchor="middle" x="416" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060"> </text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22&#45;&gt;23</title>
<path fill="none" stroke="#000000" d="M470.579,-359.8314C461.8471,-351.219 451.2683,-340.7851 441.7577,-331.4048"/>
<polygon fill="#000000" stroke="#000000" points="443.9925,-328.6931 434.4151,-324.1628 439.077,-333.6769 443.9925,-328.6931"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<polygon fill="none" stroke="#ffffff" points="515,-324 461,-324 461,-288 515,-288 515,-324"/>
<text text-anchor="middle" x="488" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 22&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>22&#45;&gt;24</title>
<path fill="none" stroke="#000000" d="M488.7477,-359.8314C488.6407,-352.131 488.5135,-342.9743 488.3947,-334.4166"/>
<polygon fill="#000000" stroke="#000000" points="491.8944,-334.3637 488.2557,-324.4133 484.8951,-334.4609 491.8944,-334.3637"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<polygon fill="none" stroke="#ffffff" points="587,-324 533,-324 533,-288 587,-288 587,-324"/>
<text text-anchor="middle" x="560" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">=&quot;</text>
</g>
<!-- 22&#45;&gt;30 -->
<g id="edge30" class="edge">
<title>22&#45;&gt;30</title>
<path fill="none" stroke="#000000" d="M506.9163,-359.8314C515.3442,-351.2848 525.541,-340.9443 534.736,-331.6198"/>
<polygon fill="#000000" stroke="#000000" points="537.3131,-333.9912 541.8425,-324.4133 532.3289,-329.0761 537.3131,-333.9912"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<polygon fill="none" stroke="#ffffff" points="706.5,-324 605.5,-324 605.5,-288 706.5,-288 706.5,-324"/>
<text text-anchor="middle" x="656" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 22&#45;&gt;31 -->
<g id="edge31" class="edge">
<title>22&#45;&gt;31</title>
<path fill="none" stroke="#000000" d="M516.2229,-365.2959C520.1648,-363.497 524.1798,-361.6868 528,-360 552.5307,-349.1682 579.8971,-337.5595 603.0092,-327.8919"/>
<polygon fill="#000000" stroke="#000000" points="604.4211,-331.0953 612.3014,-324.0135 601.7248,-324.6354 604.4211,-331.0953"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<polygon fill="none" stroke="#ffffff" points="779,-324 725,-324 725,-288 779,-288 779,-324"/>
<text text-anchor="middle" x="752" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">&quot;</text>
</g>
<!-- 22&#45;&gt;33 -->
<g id="edge33" class="edge">
<title>22&#45;&gt;33</title>
<path fill="none" stroke="#000000" d="M516.3661,-364.3687C520.2152,-362.7474 524.1667,-361.2334 528,-360 608.5693,-334.0762 634.6989,-350.7431 715,-324 715.1017,-323.9661 715.2034,-323.9321 715.3052,-323.8978"/>
<polygon fill="#000000" stroke="#000000" points="716.7995,-327.0723 724.8574,-320.1932 714.2684,-320.5459 716.7995,-327.0723"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<polygon fill="none" stroke="#ffffff" points="475,-252 421,-252 421,-216 475,-216 475,-252"/>
<text text-anchor="middle" x="448" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24&#45;&gt;25</title>
<path fill="none" stroke="#000000" d="M477.9063,-287.8314C473.4403,-279.7925 468.0925,-270.1666 463.1621,-261.2918"/>
<polygon fill="#000000" stroke="#000000" points="466.1456,-259.4551 458.2296,-252.4133 460.0265,-262.8546 466.1456,-259.4551"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<polygon fill="none" stroke="#ffffff" points="561,-252 493,-252 493,-216 561,-216 561,-252"/>
<text text-anchor="middle" x="527" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 24&#45;&gt;28 -->
<g id="edge28" class="edge">
<title>24&#45;&gt;28</title>
<path fill="none" stroke="#000000" d="M497.8413,-287.8314C502.1957,-279.7925 507.4098,-270.1666 512.2169,-261.2918"/>
<polygon fill="#000000" stroke="#000000" points="515.3408,-262.8732 517.0261,-252.4133 509.1857,-259.5392 515.3408,-262.8732"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<polygon fill="none" stroke="#ffffff" points="482,-180 414,-180 414,-144 482,-144 482,-180"/>
<text text-anchor="middle" x="448" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 25&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>25&#45;&gt;26</title>
<path fill="none" stroke="#000000" d="M448,-215.8314C448,-208.131 448,-198.9743 448,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="451.5001,-190.4132 448,-180.4133 444.5001,-190.4133 451.5001,-190.4132"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<polygon fill="none" stroke="#ffffff" points="475,-108 421,-108 421,-72 475,-72 475,-108"/>
<text text-anchor="middle" x="448" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">W</text>
</g>
<!-- 26&#45;&gt;27 -->
<g id="edge27" class="edge">
<title>26&#45;&gt;27</title>
<path fill="none" stroke="#000000" d="M448,-143.8314C448,-136.131 448,-126.9743 448,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="451.5001,-118.4132 448,-108.4133 444.5001,-118.4133 451.5001,-118.4132"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<polygon fill="none" stroke="#ffffff" points="554,-180 500,-180 500,-144 554,-144 554,-180"/>
<text text-anchor="middle" x="527" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">t</text>
</g>
<!-- 28&#45;&gt;29 -->
<g id="edge29" class="edge">
<title>28&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M527,-215.8314C527,-208.131 527,-198.9743 527,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="530.5001,-190.4132 527,-180.4133 523.5001,-190.4133 530.5001,-190.4132"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<polygon fill="none" stroke="#ffffff" points="683,-252 629,-252 629,-216 683,-216 683,-252"/>
</g>
<!-- 31&#45;&gt;32 -->
<g id="edge32" class="edge">
<title>31&#45;&gt;32</title>
<path fill="none" stroke="#000000" d="M656,-287.8314C656,-280.131 656,-270.9743 656,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="659.5001,-262.4132 656,-252.4133 652.5001,-262.4133 659.5001,-262.4132"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<polygon fill="none" stroke="#ffffff" points="591,-396 537,-396 537,-360 591,-360 591,-396"/>
<text text-anchor="middle" x="564" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">&gt;</text>
</g>
<!-- 35&#45;&gt;36 -->
<g id="edge36" class="edge">
<title>35&#45;&gt;36</title>
<path fill="none" stroke="#000000" d="M564,-431.8314C564,-424.131 564,-414.9743 564,-406.4166"/>
<polygon fill="#000000" stroke="#000000" points="567.5001,-406.4132 564,-396.4133 560.5001,-406.4133 567.5001,-406.4132"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>From top to bottom, we see that the input was constructed from a <code>&lt;start&gt;</code> symbol, which then expanded into <code>html</code>, which then expanded into HTML text, and so on. Multiple children in a tree stand for a concatenation of individual symbols.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Internally, these trees come as pairs <code>(symbol, children)</code>, where <code>symbol</code> is the name of a node (say, <code>&lt;html&gt;</code>), and <code>children</code> is a (possibly empty) list of subtrees. Here are the topmost nodes of the above tree:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/pprint.html" class="import" target="_blank">pprint</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">simple_html_fuzzer</span><span class="o">.</span><span class="n">derivation_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(&#39;&lt;start&gt;&#39;, [(&#39;&lt;html&gt;&#39;, [(&#39;&lt;tagged-text&gt;&#39;, [(&#39;&lt;self-closing-tag&gt;&#39;, [...])])])])
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To produce abstract failure-inducing patterns, we will work on this very structure. The idea is to</p>
<ol>
<li>systematically replace subtrees by other, generated, compatible subtrees (e.g. replace one <code>&lt;html&gt;</code> subtree in the concrete input by some other generated <code>&lt;html&gt;</code> subtree);</li>
<li>see whether these subtrees also result in failures; and</li>
<li>if they do, use the nonterminal (<code>&lt;html&gt;</code>) as a placeholder in the pattern.</li>
</ol>
<p>This will involve some subtree manipulation, construction, and finally testing. First of all, though, we need to be able to turn an <em>existing input</em> into a derivation tree.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Parsing">Parsing<a class="anchor-link" href="#Parsing">&#182;</a></h2><p>The activity of creating a structure out of an unstructured input is called <em>parsing</em>. Generally speaking, a <em>parser</em> uses a <em>grammar</em> to create a <em>derivation tree</em> (also called <em>parse tree</em> in parsing contexts) from a string input.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, there's a whole body of theory (and practice!) around constructing parsers. We make our life simple by using an existing parser (again, from <a href="https://www.fuzzingbook.org/Parser.html">the fuzzing book</a>), which does just what we want. The <code>EarleyParser</code> is instantiated with a grammar such as <code>SIMPLE_HTML_GRAMMAR</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://www.fuzzingbook.org/html/Parser.html" class="import" target="_blank">fuzzingbook.Parser</a></span> <span class="kn">import</span> <span class="n">Parser</span><span class="p">,</span> <span class="n">EarleyParser</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_html_parser</span> <span class="o">=</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Its method <code>parse()</code> returns an iterator over multiple possible derivation trees.  (There can be multiple trees because the grammar could be ambiguous). We are only interested in the first such tree. Let us parse <code>BAD_INPUT</code> and inspect the resulting ~parse tree~ ~syntax tree~ derivation tree:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_input_tree</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">simple_html_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">BAD_INPUT</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display_tree</span><span class="p">(</span><span class="n">bad_input_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1005pt" height="764pt"
 viewBox="0.00 0.00 1005.00 764.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 760)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-760 1001,-760 1001,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="none" stroke="#ffffff" points="415.5,-756 356.5,-756 356.5,-720 415.5,-720 415.5,-756"/>
<text text-anchor="middle" x="386" y="-734.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="none" stroke="#ffffff" points="413,-684 359,-684 359,-648 413,-648 413,-684"/>
<text text-anchor="middle" x="386" y="-662.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;html&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M386,-719.8314C386,-712.131 386,-702.9743 386,-694.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-694.4132 386,-684.4133 382.5001,-694.4133 389.5001,-694.4132"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="none" stroke="#ffffff" points="441,-612 331,-612 331,-576 441,-576 441,-612"/>
<text text-anchor="middle" x="386" y="-590.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;tagged&#45;text&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M386,-647.8314C386,-640.131 386,-630.9743 386,-622.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-622.4132 386,-612.4133 382.5001,-622.4133 389.5001,-622.4132"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="none" stroke="#ffffff" points="304,-540 194,-540 194,-504 304,-504 304,-540"/>
<text text-anchor="middle" x="249" y="-518.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;opening&#45;tag&gt;</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M351.4291,-575.8314C333.5815,-566.4516 311.6226,-554.9112 292.62,-544.9244"/>
<polygon fill="#000000" stroke="#000000" points="294.0401,-541.7168 283.5598,-540.1628 290.7836,-547.9132 294.0401,-541.7168"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<polygon fill="none" stroke="#ffffff" points="413,-540 359,-540 359,-504 413,-504 413,-540"/>
<text text-anchor="middle" x="386" y="-518.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;html&gt;</text>
</g>
<!-- 2&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>2&#45;&gt;17</title>
<path fill="none" stroke="#000000" d="M386,-575.8314C386,-568.131 386,-558.9743 386,-550.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-550.4132 386,-540.4133 382.5001,-550.4133 389.5001,-550.4132"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<polygon fill="none" stroke="#ffffff" points="816,-540 706,-540 706,-504 816,-504 816,-540"/>
<text text-anchor="middle" x="761" y="-518.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;closing&#45;tag&gt;</text>
</g>
<!-- 2&#45;&gt;35 -->
<g id="edge35" class="edge">
<title>2&#45;&gt;35</title>
<path fill="none" stroke="#000000" d="M441.3325,-583.3762C509.1448,-570.3562 623.8851,-548.3261 695.8804,-534.503"/>
<polygon fill="#000000" stroke="#000000" points="696.5855,-537.9316 705.7462,-532.6087 695.2656,-531.0572 696.5855,-537.9316"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<polygon fill="none" stroke="#ffffff" points="108,-468 54,-468 54,-432 108,-432 108,-468"/>
<text text-anchor="middle" x="81" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;lt&gt;</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M206.6065,-503.8314C179.0764,-492.0328 143.5695,-476.8155 117.3345,-465.5719"/>
<polygon fill="#000000" stroke="#000000" points="118.6906,-462.3453 108.1204,-461.623 115.9331,-468.7793 118.6906,-462.3453"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<polygon fill="none" stroke="#ffffff" points="219,-468 165,-468 165,-432 219,-432 219,-468"/>
<text text-anchor="middle" x="192" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 3&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>3&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M234.6165,-503.8314C228.0514,-495.5386 220.1493,-485.557 212.9422,-476.4533"/>
<polygon fill="#000000" stroke="#000000" points="215.5284,-474.0813 206.5772,-468.4133 210.0401,-478.4262 215.5284,-474.0813"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<polygon fill="none" stroke="#ffffff" points="295,-468 241,-468 241,-432 295,-432 295,-468"/>
<text text-anchor="middle" x="268" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;gt&gt;</text>
</g>
<!-- 3&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>3&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M253.7945,-503.8314C255.8489,-496.0463 258.296,-486.7729 260.5756,-478.1347"/>
<polygon fill="#000000" stroke="#000000" points="263.9735,-478.9753 263.1409,-468.4133 257.2052,-477.1892 263.9735,-478.9753"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<polygon fill="none" stroke="#ffffff" points="68,-396 14,-396 14,-360 68,-360 68,-396"/>
<text text-anchor="middle" x="41" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M70.9063,-431.8314C66.4403,-423.7925 61.0925,-414.1666 56.1621,-405.2918"/>
<polygon fill="#000000" stroke="#000000" points="59.1456,-403.4551 51.2296,-396.4133 53.0265,-406.8546 59.1456,-403.4551"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<polygon fill="none" stroke="#ffffff" points="140,-396 86,-396 86,-360 140,-360 140,-396"/>
<text text-anchor="middle" x="113" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M172.065,-431.8314C162.5217,-423.1337 150.9401,-412.5783 140.5694,-403.1265"/>
<polygon fill="#000000" stroke="#000000" points="142.6772,-400.3121 132.9287,-396.1628 137.962,-405.4857 142.6772,-400.3121"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<polygon fill="none" stroke="#ffffff" points="226,-396 158,-396 158,-360 226,-360 226,-396"/>
<text text-anchor="middle" x="192" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 6&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>6&#45;&gt;13</title>
<path fill="none" stroke="#000000" d="M192,-431.8314C192,-424.131 192,-414.9743 192,-406.4166"/>
<polygon fill="#000000" stroke="#000000" points="195.5001,-406.4132 192,-396.4133 188.5001,-406.4133 195.5001,-406.4132"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<polygon fill="none" stroke="#ffffff" points="61,-324 7,-324 7,-288 61,-288 61,-324"/>
<text text-anchor="middle" x="34" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7&#45;&gt;8</title>
<path fill="none" stroke="#000000" d="M93.065,-359.8314C83.5217,-351.1337 71.9401,-340.5783 61.5694,-331.1265"/>
<polygon fill="#000000" stroke="#000000" points="63.6772,-328.3121 53.9287,-324.1628 58.962,-333.4857 63.6772,-328.3121"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<polygon fill="none" stroke="#ffffff" points="147,-324 79,-324 79,-288 147,-288 147,-324"/>
<text text-anchor="middle" x="113" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7&#45;&gt;11</title>
<path fill="none" stroke="#000000" d="M113,-359.8314C113,-352.131 113,-342.9743 113,-334.4166"/>
<polygon fill="#000000" stroke="#000000" points="116.5001,-334.4132 113,-324.4133 109.5001,-334.4133 116.5001,-334.4132"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<polygon fill="none" stroke="#ffffff" points="68,-252 0,-252 0,-216 68,-216 68,-252"/>
<text text-anchor="middle" x="34" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8&#45;&gt;9</title>
<path fill="none" stroke="#000000" d="M34,-287.8314C34,-280.131 34,-270.9743 34,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="37.5001,-262.4132 34,-252.4133 30.5001,-262.4133 37.5001,-262.4132"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<polygon fill="none" stroke="#ffffff" points="61,-180 7,-180 7,-144 61,-144 61,-180"/>
<text text-anchor="middle" x="34" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">f</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9&#45;&gt;10</title>
<path fill="none" stroke="#000000" d="M34,-215.8314C34,-208.131 34,-198.9743 34,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="37.5001,-190.4132 34,-180.4133 30.5001,-190.4133 37.5001,-190.4132"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<polygon fill="none" stroke="#ffffff" points="140,-252 86,-252 86,-216 140,-216 140,-252"/>
<text text-anchor="middle" x="113" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11&#45;&gt;12</title>
<path fill="none" stroke="#000000" d="M113,-287.8314C113,-280.131 113,-270.9743 113,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="116.5001,-262.4132 113,-252.4133 109.5001,-262.4133 116.5001,-262.4132"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<polygon fill="none" stroke="#ffffff" points="219,-324 165,-324 165,-288 219,-288 219,-324"/>
<text text-anchor="middle" x="192" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13&#45;&gt;14</title>
<path fill="none" stroke="#000000" d="M192,-359.8314C192,-352.131 192,-342.9743 192,-334.4166"/>
<polygon fill="#000000" stroke="#000000" points="195.5001,-334.4132 192,-324.4133 188.5001,-334.4133 195.5001,-334.4132"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<polygon fill="none" stroke="#ffffff" points="298,-396 244,-396 244,-360 298,-360 298,-396"/>
<text text-anchor="middle" x="271" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15&#45;&gt;16</title>
<path fill="none" stroke="#000000" d="M268.757,-431.8314C269.0779,-424.131 269.4594,-414.9743 269.816,-406.4166"/>
<polygon fill="#000000" stroke="#000000" points="273.3133,-406.5503 270.2328,-396.4133 266.3194,-406.2589 273.3133,-406.5503"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<polygon fill="none" stroke="#ffffff" points="436.5,-468 335.5,-468 335.5,-432 436.5,-432 436.5,-468"/>
<text text-anchor="middle" x="386" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17&#45;&gt;18</title>
<path fill="none" stroke="#000000" d="M386,-503.8314C386,-496.131 386,-486.9743 386,-478.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-478.4132 386,-468.4133 382.5001,-478.4133 389.5001,-478.4132"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<polygon fill="none" stroke="#ffffff" points="417.5,-396 316.5,-396 316.5,-360 417.5,-360 417.5,-396"/>
<text text-anchor="middle" x="367" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;char&gt;</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M381.2055,-431.8314C379.1511,-424.0463 376.704,-414.7729 374.4244,-406.1347"/>
<polygon fill="#000000" stroke="#000000" points="377.7948,-405.1892 371.8591,-396.4133 371.0265,-406.9753 377.7948,-405.1892"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<polygon fill="none" stroke="#ffffff" points="536.5,-396 435.5,-396 435.5,-360 536.5,-360 536.5,-396"/>
<text text-anchor="middle" x="486" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18&#45;&gt;22</title>
<path fill="none" stroke="#000000" d="M411.2342,-431.8314C423.788,-422.7927 439.1283,-411.7476 452.6391,-402.0198"/>
<polygon fill="#000000" stroke="#000000" points="454.7036,-404.8463 460.7739,-396.1628 450.6134,-399.1655 454.7036,-404.8463"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<polygon fill="none" stroke="#ffffff" points="347.5,-324 288.5,-324 288.5,-288 347.5,-288 347.5,-324"/>
<text text-anchor="middle" x="318" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;other&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19&#45;&gt;20</title>
<path fill="none" stroke="#000000" d="M354.6352,-359.8314C349.0491,-351.6232 342.337,-341.7606 336.1928,-332.7323"/>
<polygon fill="#000000" stroke="#000000" points="339.051,-330.7112 330.5313,-324.4133 333.264,-334.6496 339.051,-330.7112"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<polygon fill="none" stroke="#ffffff" points="345,-252 291,-252 291,-216 345,-216 345,-252"/>
<text text-anchor="middle" x="318" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">&quot;</text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20&#45;&gt;21</title>
<path fill="none" stroke="#000000" d="M318,-287.8314C318,-280.131 318,-270.9743 318,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="321.5001,-262.4132 318,-252.4133 314.5001,-262.4133 321.5001,-262.4132"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<polygon fill="none" stroke="#ffffff" points="466.5,-324 365.5,-324 365.5,-288 466.5,-288 466.5,-324"/>
<text text-anchor="middle" x="416" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;char&gt;</text>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22&#45;&gt;23</title>
<path fill="none" stroke="#000000" d="M468.336,-359.8314C460.0268,-351.2848 449.9736,-340.9443 440.9082,-331.6198"/>
<polygon fill="#000000" stroke="#000000" points="443.3821,-329.1435 433.9018,-324.4133 438.3631,-334.023 443.3821,-329.1435"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<polygon fill="none" stroke="#ffffff" points="585.5,-324 484.5,-324 484.5,-288 585.5,-288 585.5,-324"/>
<text text-anchor="middle" x="535" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 22&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>22&#45;&gt;26</title>
<path fill="none" stroke="#000000" d="M498.3648,-359.8314C503.9509,-351.6232 510.663,-341.7606 516.8072,-332.7323"/>
<polygon fill="#000000" stroke="#000000" points="519.736,-334.6496 522.4687,-324.4133 513.949,-330.7112 519.736,-334.6496"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<polygon fill="none" stroke="#ffffff" points="440,-252 372,-252 372,-216 440,-216 440,-252"/>
<text text-anchor="middle" x="406" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 23&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>23&#45;&gt;24</title>
<path fill="none" stroke="#000000" d="M413.4766,-287.8314C412.4071,-280.131 411.1353,-270.9743 409.9468,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="413.3999,-261.8367 408.5574,-252.4133 406.4664,-262.7997 413.3999,-261.8367"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<polygon fill="none" stroke="#ffffff" points="433,-180 379,-180 379,-144 433,-144 433,-180"/>
<text text-anchor="middle" x="406" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">b</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24&#45;&gt;25</title>
<path fill="none" stroke="#000000" d="M406,-215.8314C406,-208.131 406,-198.9743 406,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="409.5001,-190.4132 406,-180.4133 402.5001,-190.4133 409.5001,-190.4132"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<polygon fill="none" stroke="#ffffff" points="559.5,-252 458.5,-252 458.5,-216 559.5,-216 559.5,-252"/>
<text text-anchor="middle" x="509" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;char&gt;</text>
</g>
<!-- 26&#45;&gt;27 -->
<g id="edge27" class="edge">
<title>26&#45;&gt;27</title>
<path fill="none" stroke="#000000" d="M528.4391,-287.8314C525.5973,-279.9617 522.2063,-270.5712 519.0581,-261.8533"/>
<polygon fill="#000000" stroke="#000000" points="522.3377,-260.63 515.6492,-252.4133 515.7538,-263.0076 522.3377,-260.63"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<polygon fill="none" stroke="#ffffff" points="678.5,-252 577.5,-252 577.5,-216 678.5,-216 678.5,-252"/>
<text text-anchor="middle" x="628" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 26&#45;&gt;30 -->
<g id="edge30" class="edge">
<title>26&#45;&gt;30</title>
<path fill="none" stroke="#000000" d="M558.4678,-287.8314C570.0327,-278.8779 584.1404,-267.9558 596.6183,-258.2955"/>
<polygon fill="#000000" stroke="#000000" points="598.775,-261.0521 604.5397,-252.1628 594.4898,-255.5171 598.775,-261.0521"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<polygon fill="none" stroke="#ffffff" points="531,-180 463,-180 463,-144 531,-144 531,-180"/>
<text text-anchor="middle" x="497" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 27&#45;&gt;28 -->
<g id="edge28" class="edge">
<title>27&#45;&gt;28</title>
<path fill="none" stroke="#000000" d="M505.9719,-215.8314C504.6885,-208.131 503.1624,-198.9743 501.7361,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="505.1653,-189.7018 500.0689,-180.4133 498.2606,-190.8526 505.1653,-189.7018"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<polygon fill="none" stroke="#ffffff" points="524,-108 470,-108 470,-72 524,-72 524,-108"/>
<text text-anchor="middle" x="497" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">a</text>
</g>
<!-- 28&#45;&gt;29 -->
<g id="edge29" class="edge">
<title>28&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M497,-143.8314C497,-136.131 497,-126.9743 497,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="500.5001,-118.4132 497,-108.4133 493.5001,-118.4133 500.5001,-118.4132"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<polygon fill="none" stroke="#ffffff" points="650.5,-180 549.5,-180 549.5,-144 650.5,-144 650.5,-180"/>
<text text-anchor="middle" x="600" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;char&gt;</text>
</g>
<!-- 30&#45;&gt;31 -->
<g id="edge31" class="edge">
<title>30&#45;&gt;31</title>
<path fill="none" stroke="#000000" d="M620.9344,-215.8314C617.874,-207.9617 614.2221,-198.5712 610.8318,-189.8533"/>
<polygon fill="#000000" stroke="#000000" points="614.0473,-188.4647 607.1607,-180.4133 607.5232,-191.0019 614.0473,-188.4647"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<polygon fill="none" stroke="#ffffff" points="769.5,-180 668.5,-180 668.5,-144 769.5,-144 769.5,-180"/>
<text text-anchor="middle" x="719" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 30&#45;&gt;34 -->
<g id="edge34" class="edge">
<title>30&#45;&gt;34</title>
<path fill="none" stroke="#000000" d="M650.9631,-215.8314C662.1715,-206.9632 675.8209,-196.1637 687.9439,-186.5718"/>
<polygon fill="#000000" stroke="#000000" points="690.3737,-189.1125 696.0442,-180.1628 686.0303,-183.6229 690.3737,-189.1125"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<polygon fill="none" stroke="#ffffff" points="634,-108 566,-108 566,-72 634,-72 634,-108"/>
<text text-anchor="middle" x="600" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 31&#45;&gt;32 -->
<g id="edge32" class="edge">
<title>31&#45;&gt;32</title>
<path fill="none" stroke="#000000" d="M600,-143.8314C600,-136.131 600,-126.9743 600,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="603.5001,-118.4132 600,-108.4133 596.5001,-118.4133 603.5001,-118.4132"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<polygon fill="none" stroke="#ffffff" points="627,-36 573,-36 573,0 627,0 627,-36"/>
<text text-anchor="middle" x="600" y="-14.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">r</text>
</g>
<!-- 32&#45;&gt;33 -->
<g id="edge33" class="edge">
<title>32&#45;&gt;33</title>
<path fill="none" stroke="#000000" d="M600,-71.8314C600,-64.131 600,-54.9743 600,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="603.5001,-46.4132 600,-36.4133 596.5001,-46.4133 603.5001,-46.4132"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<polygon fill="none" stroke="#ffffff" points="716,-468 662,-468 662,-432 716,-432 716,-468"/>
<text text-anchor="middle" x="689" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;lt&gt;</text>
</g>
<!-- 35&#45;&gt;36 -->
<g id="edge36" class="edge">
<title>35&#45;&gt;36</title>
<path fill="none" stroke="#000000" d="M742.8314,-503.8314C734.2848,-495.2848 723.9443,-484.9443 714.6198,-475.6198"/>
<polygon fill="#000000" stroke="#000000" points="716.9592,-473.0095 707.4133,-468.4133 712.0095,-477.9592 716.9592,-473.0095"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<polygon fill="none" stroke="#ffffff" points="788,-468 734,-468 734,-432 788,-432 788,-468"/>
<text text-anchor="middle" x="761" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">/</text>
</g>
<!-- 35&#45;&gt;38 -->
<g id="edge38" class="edge">
<title>35&#45;&gt;38</title>
<path fill="none" stroke="#000000" d="M761,-503.8314C761,-496.131 761,-486.9743 761,-478.4166"/>
<polygon fill="#000000" stroke="#000000" points="764.5001,-478.4132 761,-468.4133 757.5001,-478.4133 764.5001,-478.4132"/>
</g>
<!-- 39 -->
<g id="node40" class="node">
<title>39</title>
<polygon fill="none" stroke="#ffffff" points="860,-468 806,-468 806,-432 860,-432 860,-468"/>
<text text-anchor="middle" x="833" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 35&#45;&gt;39 -->
<g id="edge39" class="edge">
<title>35&#45;&gt;39</title>
<path fill="none" stroke="#000000" d="M779.1686,-503.8314C787.7152,-495.2848 798.0557,-484.9443 807.3802,-475.6198"/>
<polygon fill="#000000" stroke="#000000" points="809.9905,-477.9592 814.5867,-468.4133 805.0408,-473.0095 809.9905,-477.9592"/>
</g>
<!-- 48 -->
<g id="node49" class="node">
<title>48</title>
<polygon fill="none" stroke="#ffffff" points="975,-468 921,-468 921,-432 975,-432 975,-468"/>
<text text-anchor="middle" x="948" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;gt&gt;</text>
</g>
<!-- 35&#45;&gt;48 -->
<g id="edge48" class="edge">
<title>35&#45;&gt;48</title>
<path fill="none" stroke="#000000" d="M808.188,-503.8314C840.1697,-491.5175 881.8228,-475.48 911.3211,-464.1224"/>
<polygon fill="#000000" stroke="#000000" points="912.7528,-467.3217 920.8273,-460.4622 910.2375,-460.7891 912.7528,-467.3217"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<polygon fill="none" stroke="#ffffff" points="716,-396 662,-396 662,-360 716,-360 716,-396"/>
<text text-anchor="middle" x="689" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;</text>
</g>
<!-- 36&#45;&gt;37 -->
<g id="edge37" class="edge">
<title>36&#45;&gt;37</title>
<path fill="none" stroke="#000000" d="M689,-431.8314C689,-424.131 689,-414.9743 689,-406.4166"/>
<polygon fill="#000000" stroke="#000000" points="692.5001,-406.4132 689,-396.4133 685.5001,-406.4133 692.5001,-406.4132"/>
</g>
<!-- 40 -->
<g id="node41" class="node">
<title>40</title>
<polygon fill="none" stroke="#ffffff" points="839,-396 785,-396 785,-360 839,-360 839,-396"/>
<text text-anchor="middle" x="812" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 39&#45;&gt;40 -->
<g id="edge40" class="edge">
<title>39&#45;&gt;40</title>
<path fill="none" stroke="#000000" d="M827.7008,-431.8314C825.4302,-424.0463 822.7254,-414.7729 820.206,-406.1347"/>
<polygon fill="#000000" stroke="#000000" points="823.5306,-405.0332 817.3705,-396.4133 816.8106,-406.9933 823.5306,-405.0332"/>
</g>
<!-- 46 -->
<g id="node47" class="node">
<title>46</title>
<polygon fill="none" stroke="#ffffff" points="925,-396 857,-396 857,-360 925,-360 925,-396"/>
<text text-anchor="middle" x="891" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 39&#45;&gt;46 -->
<g id="edge46" class="edge">
<title>39&#45;&gt;46</title>
<path fill="none" stroke="#000000" d="M847.6358,-431.8314C854.3161,-423.5386 862.3568,-413.557 869.6904,-404.4533"/>
<polygon fill="#000000" stroke="#000000" points="872.6194,-406.3965 876.1671,-396.4133 867.1681,-402.0052 872.6194,-406.3965"/>
</g>
<!-- 41 -->
<g id="node42" class="node">
<title>41</title>
<polygon fill="none" stroke="#ffffff" points="800,-324 746,-324 746,-288 800,-288 800,-324"/>
<text text-anchor="middle" x="773" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 40&#45;&gt;41 -->
<g id="edge41" class="edge">
<title>40&#45;&gt;41</title>
<path fill="none" stroke="#000000" d="M802.1587,-359.8314C797.8043,-351.7925 792.5902,-342.1666 787.7831,-333.2918"/>
<polygon fill="#000000" stroke="#000000" points="790.8143,-331.5392 782.9739,-324.4133 784.6592,-334.8732 790.8143,-331.5392"/>
</g>
<!-- 44 -->
<g id="node45" class="node">
<title>44</title>
<polygon fill="none" stroke="#ffffff" points="886,-324 818,-324 818,-288 886,-288 886,-324"/>
<text text-anchor="middle" x="852" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 40&#45;&gt;44 -->
<g id="edge44" class="edge">
<title>40&#45;&gt;44</title>
<path fill="none" stroke="#000000" d="M822.0937,-359.8314C826.5597,-351.7925 831.9075,-342.1666 836.8379,-333.2918"/>
<polygon fill="#000000" stroke="#000000" points="839.9735,-334.8546 841.7704,-324.4133 833.8544,-331.4551 839.9735,-334.8546"/>
</g>
<!-- 42 -->
<g id="node43" class="node">
<title>42</title>
<polygon fill="none" stroke="#ffffff" points="807,-252 739,-252 739,-216 807,-216 807,-252"/>
<text text-anchor="middle" x="773" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 41&#45;&gt;42 -->
<g id="edge42" class="edge">
<title>41&#45;&gt;42</title>
<path fill="none" stroke="#000000" d="M773,-287.8314C773,-280.131 773,-270.9743 773,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="776.5001,-262.4132 773,-252.4133 769.5001,-262.4133 776.5001,-262.4132"/>
</g>
<!-- 43 -->
<g id="node44" class="node">
<title>43</title>
<polygon fill="none" stroke="#ffffff" points="842,-180 788,-180 788,-144 842,-144 842,-180"/>
<text text-anchor="middle" x="815" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">f</text>
</g>
<!-- 42&#45;&gt;43 -->
<g id="edge43" class="edge">
<title>42&#45;&gt;43</title>
<path fill="none" stroke="#000000" d="M783.5984,-215.8314C788.2877,-207.7925 793.9028,-198.1666 799.0798,-189.2918"/>
<polygon fill="#000000" stroke="#000000" points="802.2434,-190.8146 804.2589,-180.4133 796.1969,-187.2875 802.2434,-190.8146"/>
</g>
<!-- 45 -->
<g id="node46" class="node">
<title>45</title>
<polygon fill="none" stroke="#ffffff" points="879,-252 825,-252 825,-216 879,-216 879,-252"/>
<text text-anchor="middle" x="852" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 44&#45;&gt;45 -->
<g id="edge45" class="edge">
<title>44&#45;&gt;45</title>
<path fill="none" stroke="#000000" d="M852,-287.8314C852,-280.131 852,-270.9743 852,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="855.5001,-262.4132 852,-252.4133 848.5001,-262.4133 855.5001,-262.4132"/>
</g>
<!-- 47 -->
<g id="node48" class="node">
<title>47</title>
<polygon fill="none" stroke="#ffffff" points="958,-324 904,-324 904,-288 958,-288 958,-324"/>
<text text-anchor="middle" x="931" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 46&#45;&gt;47 -->
<g id="edge47" class="edge">
<title>46&#45;&gt;47</title>
<path fill="none" stroke="#000000" d="M901.0937,-359.8314C905.5597,-351.7925 910.9075,-342.1666 915.8379,-333.2918"/>
<polygon fill="#000000" stroke="#000000" points="918.9735,-334.8546 920.7704,-324.4133 912.8544,-331.4551 918.9735,-334.8546"/>
</g>
<!-- 49 -->
<g id="node50" class="node">
<title>49</title>
<polygon fill="none" stroke="#ffffff" points="997,-396 943,-396 943,-360 997,-360 997,-396"/>
<text text-anchor="middle" x="970" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">&gt;</text>
</g>
<!-- 48&#45;&gt;49 -->
<g id="edge49" class="edge">
<title>48&#45;&gt;49</title>
<path fill="none" stroke="#000000" d="M953.5515,-431.8314C955.9303,-424.0463 958.7638,-414.7729 961.4033,-406.1347"/>
<polygon fill="#000000" stroke="#000000" points="964.7987,-406.9996 964.3737,-396.4133 958.1042,-404.954 964.7987,-406.9996"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This derivation tree has the same structure as the one created from our <code>GrammarFuzzer</code> above. We see how the <code>&lt;tagged-text&gt;</code> is composed of three elements:</p>
<ol>
<li>an<code>&lt;opening-tag&gt;</code> (<code>&lt;foo&gt;</code>);</li>
<li>a <code>&lt;html&gt;</code> element which becomes <code>&lt;plain-text&gt;</code> (<code>"bar</code>); and</li>
<li>a <code>&lt;closing-tag&gt;</code> (<code>&lt;/foo&gt;</code>).</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can easily turn the tree back into a string. The method <code>tree_to_string()</code> traverses the tree left-to-right and joins all nonterminal symbols.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://www.fuzzingbook.org/html/GrammarFuzzer.html" class="import" target="_blank">fuzzingbook.GrammarFuzzer</a></span> <span class="kn">import</span> <span class="n">tree_to_string</span><span class="p">,</span> <span class="n">all_terminals</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_to_string</span><span class="p">(</span><span class="n">bad_input_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&lt;foo&gt;&#34;bar&lt;/foo&gt;&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">tree_to_string</span><span class="p">(</span><span class="n">bad_input_tree</span><span class="p">)</span> <span class="o">==</span> <span class="n">BAD_INPUT</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With this, we can now</p>
<ul>
<li>parse an input into a tree structure;</li>
<li>(re-)create parts of the tree structure; and</li>
<li>turn the tree back into an input string.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Mutating-the-Tree">Mutating the Tree<a class="anchor-link" href="#Mutating-the-Tree">&#182;</a></h2><p>We introduce a class <code>TreeMutator</code> that is set to mutate a tree. Its constructor takes a grammar and a tree.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://www.fuzzingbook.org/html/Grammars.html" class="import" target="_blank">fuzzingbook.Grammars</a></span> <span class="kn">import</span> <span class="n">is_valid_grammar</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeMutator</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Grammar-based mutations of derivation trees.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">,</span>
                 <span class="n">fuzzer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">GrammarFuzzer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor. </span>
<span class="sd">        `grammar` is the underlying grammar; </span>
<span class="sd">        `tree` is the tree to work on.</span>
<span class="sd">        `fuzzer` is the grammar fuzzer to use (default: `GrammarFuzzer`)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">is_valid_grammar</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="n">grammar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>

        <span class="k">if</span> <span class="n">fuzzer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fuzzer</span> <span class="o">=</span> <span class="n">GrammarFuzzer</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fuzzer</span> <span class="o">=</span> <span class="n">fuzzer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Referencing-Subtrees">Referencing Subtrees<a class="anchor-link" href="#Referencing-Subtrees">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To reference individual elements in the tree, we introduce the concept of a <em>path</em>. A path is a list of numbers indicating the children (starting with 0) we should follow. A path <code>[0, 0, 0, ..., 0]</code> stands for the leftmost child in a tree.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TreePath</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The method <code>get_subtree()</code> returns the subtree for a given path.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeMutator</span><span class="p">(</span><span class="n">TreeMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_subtree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">TreePath</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DerivationTree</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Access a subtree based on `path` (a list of children numbers)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>

        <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">tree</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span> <span class="ow">or</span> <span class="n">children</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tree</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtree</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">children</span><span class="p">[</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's <code>get_subtree()</code> in action. We instantiate a <code>TreeMutator</code> on the <code>BAD_INPUT</code> tree as shown above and return the element at the path <code>[0, 0, 1, 0]</code> – i.e. follow the leftmost edge twice, than the second-to-leftmost edge, then the leftmost edge again. This gives us the <code>&lt;plain-text&gt;</code> subtree representing the string <code>"bar</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bad_input_tree_mutator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">TreeMutator</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">TreeMutator</span><span class="p">(</span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">,</span> <span class="n">bad_input_tree</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>    
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plain_text_subtree</span> <span class="o">=</span> <span class="n">bad_input_tree_mutator</span><span class="p">()</span><span class="o">.</span><span class="n">get_subtree</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">plain_text_subtree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(&#39;&lt;plain-text&gt;&#39;,
 [(&#39;&lt;plain-char&gt;&#39;, [(&#39;&lt;other&gt;&#39;, [(&#39;&#34;&#39;, [])])]),
  (&#39;&lt;plain-text&gt;&#39;,
   [(&#39;&lt;plain-char&gt;&#39;, [(&#39;&lt;letter&gt;&#39;, [...])]),
    (&#39;&lt;plain-text&gt;&#39;, [(&#39;&lt;plain-char&gt;&#39;, [...]), (&#39;&lt;plain-text&gt;&#39;, [...])])])])
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_to_string</span><span class="p">(</span><span class="n">plain_text_subtree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&#34;bar&#39;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">In <code>bad_input_tree</code>, what is  the subtree at the path <code>[0, 0, 2, 1]</code> as string?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="5cfb6e10-82be-11eb-8748-acde48001122" id="5cfb6e10-82be-11eb-8748-acde48001122-1" onclick="clear_selection('5cfb6e10-82be-11eb-8748-acde48001122')">
        <label id="5cfb6e10-82be-11eb-8748-acde48001122-1-label" for="5cfb6e10-82be-11eb-8748-acde48001122-1"><code>&lt;</code></label><br>

        <input type="radio" name="5cfb6e10-82be-11eb-8748-acde48001122" id="5cfb6e10-82be-11eb-8748-acde48001122-2" onclick="clear_selection('5cfb6e10-82be-11eb-8748-acde48001122')">
        <label id="5cfb6e10-82be-11eb-8748-acde48001122-2-label" for="5cfb6e10-82be-11eb-8748-acde48001122-2"><code>/</code></label><br>

        <input type="radio" name="5cfb6e10-82be-11eb-8748-acde48001122" id="5cfb6e10-82be-11eb-8748-acde48001122-3" onclick="clear_selection('5cfb6e10-82be-11eb-8748-acde48001122')">
        <label id="5cfb6e10-82be-11eb-8748-acde48001122-3-label" for="5cfb6e10-82be-11eb-8748-acde48001122-3"><code>&lt;/foo&gt;</code></label><br>

        <input type="radio" name="5cfb6e10-82be-11eb-8748-acde48001122" id="5cfb6e10-82be-11eb-8748-acde48001122-4" onclick="clear_selection('5cfb6e10-82be-11eb-8748-acde48001122')">
        <label id="5cfb6e10-82be-11eb-8748-acde48001122-4-label" for="5cfb6e10-82be-11eb-8748-acde48001122-4"><code>&lt;foo&gt;</code></label><br>

    </div>
    </p>
    <input id="5cfb6e10-82be-11eb-8748-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('5cfb6e10-82be-11eb-8748-acde48001122', 4, 0, 'next(prime_numbers)')">
    <span class="quiz_hint" id="5cfb6e10-82be-11eb-8748-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Creating-new-Subtrees">Creating new Subtrees<a class="anchor-link" href="#Creating-new-Subtrees">&#182;</a></h3><p>The method <code>new_tree()</code> creates a new subtree for the given <code>&lt;start_symbol&gt;</code> according to the rules of the grammar. It invokes <code>expand_tree()</code> on the given <code>GrammarFuzzer</code> – a method that takes an initial (empty) tree and expands it until no more expansions are left.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeMutator</span><span class="p">(</span><span class="n">TreeMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">new_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new subtree for &lt;start_symbol&gt;.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating new tree for </span><span class="si">{</span><span class="n">start_symbol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">tree</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_symbol</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">expand_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is an example of <code>new_tree()</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plain_text_tree</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TreeMutator</span><span class="p">,</span> <span class="n">bad_input_tree_mutator</span><span class="p">())</span><span class="o">.</span><span class="n">new_tree</span><span class="p">(</span><span class="s1">&#39;&lt;plain-text&gt;&#39;</span><span class="p">)</span>
<span class="n">display_tree</span><span class="p">(</span><span class="n">plain_text_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Creating new tree for &lt;plain-text&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="228pt" height="260pt"
 viewBox="0.00 0.00 228.00 260.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 256)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-256 224,-256 224,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="none" stroke="#ffffff" points="160,-252 59,-252 59,-216 160,-216 160,-252"/>
<text text-anchor="middle" x="109.5" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="none" stroke="#ffffff" points="101,-180 0,-180 0,-144 101,-144 101,-180"/>
<text text-anchor="middle" x="50.5" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;char&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M94.6118,-215.8314C87.747,-207.454 79.4699,-197.3531 71.9489,-188.1749"/>
<polygon fill="#000000" stroke="#000000" points="74.6341,-185.9297 65.5886,-180.4133 69.2197,-190.3665 74.6341,-185.9297"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<polygon fill="none" stroke="#ffffff" points="220,-180 119,-180 119,-144 220,-144 220,-180"/>
<text text-anchor="middle" x="169.5" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 0&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>0&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M124.6405,-215.8314C131.6217,-207.454 140.0391,-197.3531 147.6876,-188.1749"/>
<polygon fill="#000000" stroke="#000000" points="150.4425,-190.3362 154.1556,-180.4133 145.0649,-185.8548 150.4425,-190.3362"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="none" stroke="#ffffff" points="101,-108 0,-108 0,-72 101,-72 101,-108"/>
<text text-anchor="middle" x="50.5" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;whitespace&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M50.5,-143.8314C50.5,-136.131 50.5,-126.9743 50.5,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="54.0001,-118.4132 50.5,-108.4133 47.0001,-118.4133 54.0001,-118.4132"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="none" stroke="#ffffff" points="77.5,-36 23.5,-36 23.5,0 77.5,0 77.5,-36"/>
<text text-anchor="middle" x="50.5" y="-14.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060"> </text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M50.5,-71.8314C50.5,-64.131 50.5,-54.9743 50.5,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="54.0001,-46.4132 50.5,-36.4133 47.0001,-46.4133 54.0001,-46.4132"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<polygon fill="none" stroke="#ffffff" points="196.5,-108 142.5,-108 142.5,-72 196.5,-72 196.5,-108"/>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M169.5,-143.8314C169.5,-136.131 169.5,-126.9743 169.5,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="173.0001,-118.4132 169.5,-108.4133 166.0001,-118.4133 173.0001,-118.4132"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_to_string</span><span class="p">(</span><span class="n">plain_text_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39; &#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Mutating-the-Tree">Mutating the Tree<a class="anchor-link" href="#Mutating-the-Tree">&#182;</a></h3><p>With us now being able to</p>
<ul>
<li>access a particular path in the tree (<code>get_subtree()</code>) and</li>
<li>create a new subtree (<code>new_tree()</code>),</li>
</ul>
<p>we can mutate the tree at a given path. This is the task of <code>mutate()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeMutator</span><span class="p">(</span><span class="n">TreeMutator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">TreePath</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DerivationTree</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a new tree mutated at `path`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>
        <span class="k">assert</span> <span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">tree</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span> <span class="ow">or</span> <span class="n">children</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_tree</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>

        <span class="n">head</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">new_children</span> <span class="o">=</span> <span class="p">(</span><span class="n">children</span><span class="p">[:</span><span class="n">head</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">children</span><span class="p">[</span><span class="n">head</span><span class="p">])]</span> <span class="o">+</span>
                        <span class="n">children</span><span class="p">[</span><span class="n">head</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">new_children</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is an example of <code>mutate()</code> in action. We mutate <code>bad_input_tree</code> at the path <code>[0, 0, 1, 0]</code> – that is, <code>&lt;plain-text&gt;</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mutated_tree</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TreeMutator</span><span class="p">,</span> <span class="n">bad_input_tree_mutator</span><span class="p">())</span><span class="o">.</span><span class="n">mutate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">display_tree</span><span class="p">(</span><span class="n">mutated_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Creating new tree for &lt;plain-text&gt;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_image output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="847pt" height="620pt"
 viewBox="0.00 0.00 847.00 620.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 616)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-616 843,-616 843,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="none" stroke="#ffffff" points="415.5,-612 356.5,-612 356.5,-576 415.5,-576 415.5,-612"/>
<text text-anchor="middle" x="386" y="-590.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;start&gt;</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<polygon fill="none" stroke="#ffffff" points="413,-540 359,-540 359,-504 413,-504 413,-540"/>
<text text-anchor="middle" x="386" y="-518.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;html&gt;</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M386,-575.8314C386,-568.131 386,-558.9743 386,-550.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-550.4132 386,-540.4133 382.5001,-550.4133 389.5001,-550.4132"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="none" stroke="#ffffff" points="441,-468 331,-468 331,-432 441,-432 441,-468"/>
<text text-anchor="middle" x="386" y="-446.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;tagged&#45;text&gt;</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M386,-503.8314C386,-496.131 386,-486.9743 386,-478.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-478.4132 386,-468.4133 382.5001,-478.4133 389.5001,-478.4132"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<polygon fill="none" stroke="#ffffff" points="304,-396 194,-396 194,-360 304,-360 304,-396"/>
<text text-anchor="middle" x="249" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;opening&#45;tag&gt;</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M351.4291,-431.8314C333.5815,-422.4516 311.6226,-410.9112 292.62,-400.9244"/>
<polygon fill="#000000" stroke="#000000" points="294.0401,-397.7168 283.5598,-396.1628 290.7836,-403.9132 294.0401,-397.7168"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<polygon fill="none" stroke="#ffffff" points="413,-396 359,-396 359,-360 413,-360 413,-396"/>
<text text-anchor="middle" x="386" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;html&gt;</text>
</g>
<!-- 2&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>2&#45;&gt;17</title>
<path fill="none" stroke="#000000" d="M386,-431.8314C386,-424.131 386,-414.9743 386,-406.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-406.4132 386,-396.4133 382.5001,-406.4133 389.5001,-406.4132"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<polygon fill="none" stroke="#ffffff" points="709,-396 599,-396 599,-360 709,-360 709,-396"/>
<text text-anchor="middle" x="654" y="-374.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;closing&#45;tag&gt;</text>
</g>
<!-- 2&#45;&gt;24 -->
<g id="edge24" class="edge">
<title>2&#45;&gt;24</title>
<path fill="none" stroke="#000000" d="M441.2048,-435.1689C484.174,-423.6249 543.9084,-407.5768 589.1536,-395.4214"/>
<polygon fill="#000000" stroke="#000000" points="590.1174,-398.7867 598.8668,-392.8119 588.3011,-392.0264 590.1174,-398.7867"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<polygon fill="none" stroke="#ffffff" points="108,-324 54,-324 54,-288 108,-288 108,-324"/>
<text text-anchor="middle" x="81" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;lt&gt;</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M206.6065,-359.8314C179.0764,-348.0328 143.5695,-332.8155 117.3345,-321.5719"/>
<polygon fill="#000000" stroke="#000000" points="118.6906,-318.3453 108.1204,-317.623 115.9331,-324.7793 118.6906,-318.3453"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<polygon fill="none" stroke="#ffffff" points="219,-324 165,-324 165,-288 219,-288 219,-324"/>
<text text-anchor="middle" x="192" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 3&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>3&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M234.6165,-359.8314C228.0514,-351.5386 220.1493,-341.557 212.9422,-332.4533"/>
<polygon fill="#000000" stroke="#000000" points="215.5284,-330.0813 206.5772,-324.4133 210.0401,-334.4262 215.5284,-330.0813"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<polygon fill="none" stroke="#ffffff" points="295,-324 241,-324 241,-288 295,-288 295,-324"/>
<text text-anchor="middle" x="268" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;gt&gt;</text>
</g>
<!-- 3&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>3&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M253.7945,-359.8314C255.8489,-352.0463 258.296,-342.7729 260.5756,-334.1347"/>
<polygon fill="#000000" stroke="#000000" points="263.9735,-334.9753 263.1409,-324.4133 257.2052,-333.1892 263.9735,-334.9753"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<polygon fill="none" stroke="#ffffff" points="68,-252 14,-252 14,-216 68,-216 68,-252"/>
<text text-anchor="middle" x="41" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M70.9063,-287.8314C66.4403,-279.7925 61.0925,-270.1666 56.1621,-261.2918"/>
<polygon fill="#000000" stroke="#000000" points="59.1456,-259.4551 51.2296,-252.4133 53.0265,-262.8546 59.1456,-259.4551"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<polygon fill="none" stroke="#ffffff" points="140,-252 86,-252 86,-216 140,-216 140,-252"/>
<text text-anchor="middle" x="113" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>6&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M172.065,-287.8314C162.5217,-279.1337 150.9401,-268.5783 140.5694,-259.1265"/>
<polygon fill="#000000" stroke="#000000" points="142.6772,-256.3121 132.9287,-252.1628 137.962,-261.4857 142.6772,-256.3121"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<polygon fill="none" stroke="#ffffff" points="226,-252 158,-252 158,-216 226,-216 226,-252"/>
<text text-anchor="middle" x="192" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 6&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>6&#45;&gt;13</title>
<path fill="none" stroke="#000000" d="M192,-287.8314C192,-280.131 192,-270.9743 192,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="195.5001,-262.4132 192,-252.4133 188.5001,-262.4133 195.5001,-262.4132"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<polygon fill="none" stroke="#ffffff" points="61,-180 7,-180 7,-144 61,-144 61,-180"/>
<text text-anchor="middle" x="34" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7&#45;&gt;8</title>
<path fill="none" stroke="#000000" d="M93.065,-215.8314C83.5217,-207.1337 71.9401,-196.5783 61.5694,-187.1265"/>
<polygon fill="#000000" stroke="#000000" points="63.6772,-184.3121 53.9287,-180.1628 58.962,-189.4857 63.6772,-184.3121"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<polygon fill="none" stroke="#ffffff" points="147,-180 79,-180 79,-144 147,-144 147,-180"/>
<text text-anchor="middle" x="113" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 7&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>7&#45;&gt;11</title>
<path fill="none" stroke="#000000" d="M113,-215.8314C113,-208.131 113,-198.9743 113,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="116.5001,-190.4132 113,-180.4133 109.5001,-190.4133 116.5001,-190.4132"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<polygon fill="none" stroke="#ffffff" points="68,-108 0,-108 0,-72 68,-72 68,-108"/>
<text text-anchor="middle" x="34" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8&#45;&gt;9</title>
<path fill="none" stroke="#000000" d="M34,-143.8314C34,-136.131 34,-126.9743 34,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="37.5001,-118.4132 34,-108.4133 30.5001,-118.4133 37.5001,-118.4132"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<polygon fill="none" stroke="#ffffff" points="61,-36 7,-36 7,0 61,0 61,-36"/>
<text text-anchor="middle" x="34" y="-14.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">f</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9&#45;&gt;10</title>
<path fill="none" stroke="#000000" d="M34,-71.8314C34,-64.131 34,-54.9743 34,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="37.5001,-46.4132 34,-36.4133 30.5001,-46.4133 37.5001,-46.4132"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<polygon fill="none" stroke="#ffffff" points="140,-108 86,-108 86,-72 140,-72 140,-108"/>
<text text-anchor="middle" x="113" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 11&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>11&#45;&gt;12</title>
<path fill="none" stroke="#000000" d="M113,-143.8314C113,-136.131 113,-126.9743 113,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="116.5001,-118.4132 113,-108.4133 109.5001,-118.4133 116.5001,-118.4132"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<polygon fill="none" stroke="#ffffff" points="219,-180 165,-180 165,-144 219,-144 219,-180"/>
<text text-anchor="middle" x="192" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 13&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>13&#45;&gt;14</title>
<path fill="none" stroke="#000000" d="M192,-215.8314C192,-208.131 192,-198.9743 192,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="195.5001,-190.4132 192,-180.4133 188.5001,-190.4133 195.5001,-190.4132"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<polygon fill="none" stroke="#ffffff" points="298,-252 244,-252 244,-216 298,-216 298,-252"/>
<text text-anchor="middle" x="271" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">&gt;</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15&#45;&gt;16</title>
<path fill="none" stroke="#000000" d="M268.757,-287.8314C269.0779,-280.131 269.4594,-270.9743 269.816,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="273.3133,-262.5503 270.2328,-252.4133 266.3194,-262.2589 273.3133,-262.5503"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<polygon fill="none" stroke="#ffffff" points="436.5,-324 335.5,-324 335.5,-288 436.5,-288 436.5,-324"/>
<text text-anchor="middle" x="386" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 17&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>17&#45;&gt;18</title>
<path fill="none" stroke="#000000" d="M386,-359.8314C386,-352.131 386,-342.9743 386,-334.4166"/>
<polygon fill="#000000" stroke="#000000" points="389.5001,-334.4132 386,-324.4133 382.5001,-334.4133 389.5001,-334.4132"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<polygon fill="none" stroke="#ffffff" points="417.5,-252 316.5,-252 316.5,-216 417.5,-216 417.5,-252"/>
<text text-anchor="middle" x="367" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;char&gt;</text>
</g>
<!-- 18&#45;&gt;19 -->
<g id="edge19" class="edge">
<title>18&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M381.2055,-287.8314C379.1511,-280.0463 376.704,-270.7729 374.4244,-262.1347"/>
<polygon fill="#000000" stroke="#000000" points="377.7948,-261.1892 371.8591,-252.4133 371.0265,-262.9753 377.7948,-261.1892"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<polygon fill="none" stroke="#ffffff" points="536.5,-252 435.5,-252 435.5,-216 536.5,-216 536.5,-252"/>
<text text-anchor="middle" x="486" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;plain&#45;text&gt;</text>
</g>
<!-- 18&#45;&gt;22 -->
<g id="edge22" class="edge">
<title>18&#45;&gt;22</title>
<path fill="none" stroke="#000000" d="M411.2342,-287.8314C423.788,-278.7927 439.1283,-267.7476 452.6391,-258.0198"/>
<polygon fill="#000000" stroke="#000000" points="454.7036,-260.8463 460.7739,-252.1628 450.6134,-255.1655 454.7036,-260.8463"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<polygon fill="none" stroke="#ffffff" points="417.5,-180 316.5,-180 316.5,-144 417.5,-144 417.5,-180"/>
<text text-anchor="middle" x="367" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;whitespace&gt;</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge20" class="edge">
<title>19&#45;&gt;20</title>
<path fill="none" stroke="#000000" d="M367,-215.8314C367,-208.131 367,-198.9743 367,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="370.5001,-190.4132 367,-180.4133 363.5001,-190.4133 370.5001,-190.4132"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<polygon fill="none" stroke="#ffffff" points="394,-108 340,-108 340,-72 394,-72 394,-108"/>
<text text-anchor="middle" x="367" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060"> </text>
</g>
<!-- 20&#45;&gt;21 -->
<g id="edge21" class="edge">
<title>20&#45;&gt;21</title>
<path fill="none" stroke="#000000" d="M367,-143.8314C367,-136.131 367,-126.9743 367,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="370.5001,-118.4132 367,-108.4133 363.5001,-118.4133 370.5001,-118.4132"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<polygon fill="none" stroke="#ffffff" points="513,-180 459,-180 459,-144 513,-144 513,-180"/>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge23" class="edge">
<title>22&#45;&gt;23</title>
<path fill="none" stroke="#000000" d="M486,-215.8314C486,-208.131 486,-198.9743 486,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="489.5001,-190.4132 486,-180.4133 482.5001,-190.4133 489.5001,-190.4132"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<polygon fill="none" stroke="#ffffff" points="609,-324 555,-324 555,-288 609,-288 609,-324"/>
<text text-anchor="middle" x="582" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;lt&gt;</text>
</g>
<!-- 24&#45;&gt;25 -->
<g id="edge25" class="edge">
<title>24&#45;&gt;25</title>
<path fill="none" stroke="#000000" d="M635.8314,-359.8314C627.2848,-351.2848 616.9443,-340.9443 607.6198,-331.6198"/>
<polygon fill="#000000" stroke="#000000" points="609.9592,-329.0095 600.4133,-324.4133 605.0095,-333.9592 609.9592,-329.0095"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<polygon fill="none" stroke="#ffffff" points="681,-324 627,-324 627,-288 681,-288 681,-324"/>
<text text-anchor="middle" x="654" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">/</text>
</g>
<!-- 24&#45;&gt;27 -->
<g id="edge27" class="edge">
<title>24&#45;&gt;27</title>
<path fill="none" stroke="#000000" d="M654,-359.8314C654,-352.131 654,-342.9743 654,-334.4166"/>
<polygon fill="#000000" stroke="#000000" points="657.5001,-334.4132 654,-324.4133 650.5001,-334.4133 657.5001,-334.4132"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<polygon fill="none" stroke="#ffffff" points="753,-324 699,-324 699,-288 753,-288 753,-324"/>
<text text-anchor="middle" x="726" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 24&#45;&gt;28 -->
<g id="edge28" class="edge">
<title>24&#45;&gt;28</title>
<path fill="none" stroke="#000000" d="M672.1686,-359.8314C680.7152,-351.2848 691.0557,-340.9443 700.3802,-331.6198"/>
<polygon fill="#000000" stroke="#000000" points="702.9905,-333.9592 707.5867,-324.4133 698.0408,-329.0095 702.9905,-333.9592"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<polygon fill="none" stroke="#ffffff" points="832,-324 778,-324 778,-288 832,-288 832,-324"/>
<text text-anchor="middle" x="805" y="-302.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;gt&gt;</text>
</g>
<!-- 24&#45;&gt;37 -->
<g id="edge37" class="edge">
<title>24&#45;&gt;37</title>
<path fill="none" stroke="#000000" d="M692.1037,-359.8314C715.6009,-348.6274 745.5634,-334.3406 768.7156,-323.3012"/>
<polygon fill="#000000" stroke="#000000" points="770.3426,-326.403 777.8626,-318.9397 767.3297,-320.0845 770.3426,-326.403"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<polygon fill="none" stroke="#ffffff" points="609,-252 555,-252 555,-216 609,-216 609,-252"/>
<text text-anchor="middle" x="582" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;</text>
</g>
<!-- 25&#45;&gt;26 -->
<g id="edge26" class="edge">
<title>25&#45;&gt;26</title>
<path fill="none" stroke="#000000" d="M582,-287.8314C582,-280.131 582,-270.9743 582,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="585.5001,-262.4132 582,-252.4133 578.5001,-262.4133 585.5001,-262.4132"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<polygon fill="none" stroke="#ffffff" points="681,-252 627,-252 627,-216 681,-216 681,-252"/>
<text text-anchor="middle" x="654" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 28&#45;&gt;29 -->
<g id="edge29" class="edge">
<title>28&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M707.8314,-287.8314C699.2848,-279.2848 688.9443,-268.9443 679.6198,-259.6198"/>
<polygon fill="#000000" stroke="#000000" points="681.9592,-257.0095 672.4133,-252.4133 677.0095,-261.9592 681.9592,-257.0095"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<polygon fill="none" stroke="#ffffff" points="767,-252 699,-252 699,-216 767,-216 767,-252"/>
<text text-anchor="middle" x="733" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 28&#45;&gt;35 -->
<g id="edge35" class="edge">
<title>28&#45;&gt;35</title>
<path fill="none" stroke="#000000" d="M727.7664,-287.8314C728.515,-280.131 729.4053,-270.9743 730.2373,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="733.7256,-262.7051 731.2098,-252.4133 726.7585,-262.0276 733.7256,-262.7051"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<polygon fill="none" stroke="#ffffff" points="602,-180 548,-180 548,-144 602,-144 602,-180"/>
<text text-anchor="middle" x="575" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;id&gt;</text>
</g>
<!-- 29&#45;&gt;30 -->
<g id="edge30" class="edge">
<title>29&#45;&gt;30</title>
<path fill="none" stroke="#000000" d="M634.065,-215.8314C624.5217,-207.1337 612.9401,-196.5783 602.5694,-187.1265"/>
<polygon fill="#000000" stroke="#000000" points="604.6772,-184.3121 594.9287,-180.1628 599.962,-189.4857 604.6772,-184.3121"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<polygon fill="none" stroke="#ffffff" points="688,-180 620,-180 620,-144 688,-144 688,-180"/>
<text text-anchor="middle" x="654" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 29&#45;&gt;33 -->
<g id="edge33" class="edge">
<title>29&#45;&gt;33</title>
<path fill="none" stroke="#000000" d="M654,-215.8314C654,-208.131 654,-198.9743 654,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="657.5001,-190.4132 654,-180.4133 650.5001,-190.4133 657.5001,-190.4132"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<polygon fill="none" stroke="#ffffff" points="609,-108 541,-108 541,-72 609,-72 609,-108"/>
<text text-anchor="middle" x="575" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#0060a0">&lt;letter&gt;</text>
</g>
<!-- 30&#45;&gt;31 -->
<g id="edge31" class="edge">
<title>30&#45;&gt;31</title>
<path fill="none" stroke="#000000" d="M575,-143.8314C575,-136.131 575,-126.9743 575,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="578.5001,-118.4132 575,-108.4133 571.5001,-118.4133 578.5001,-118.4132"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<polygon fill="none" stroke="#ffffff" points="602,-36 548,-36 548,0 602,0 602,-36"/>
<text text-anchor="middle" x="575" y="-14.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">f</text>
</g>
<!-- 31&#45;&gt;32 -->
<g id="edge32" class="edge">
<title>31&#45;&gt;32</title>
<path fill="none" stroke="#000000" d="M575,-71.8314C575,-64.131 575,-54.9743 575,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="578.5001,-46.4132 575,-36.4133 571.5001,-46.4133 578.5001,-46.4132"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<polygon fill="none" stroke="#ffffff" points="681,-108 627,-108 627,-72 681,-72 681,-108"/>
<text text-anchor="middle" x="654" y="-86.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 33&#45;&gt;34 -->
<g id="edge34" class="edge">
<title>33&#45;&gt;34</title>
<path fill="none" stroke="#000000" d="M654,-143.8314C654,-136.131 654,-126.9743 654,-118.4166"/>
<polygon fill="#000000" stroke="#000000" points="657.5001,-118.4132 654,-108.4133 650.5001,-118.4133 657.5001,-118.4132"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<polygon fill="none" stroke="#ffffff" points="760,-180 706,-180 706,-144 760,-144 760,-180"/>
<text text-anchor="middle" x="733" y="-158.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">o</text>
</g>
<!-- 35&#45;&gt;36 -->
<g id="edge36" class="edge">
<title>35&#45;&gt;36</title>
<path fill="none" stroke="#000000" d="M733,-215.8314C733,-208.131 733,-198.9743 733,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="736.5001,-190.4132 733,-180.4133 729.5001,-190.4133 736.5001,-190.4132"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<polygon fill="none" stroke="#ffffff" points="839,-252 785,-252 785,-216 839,-216 839,-252"/>
<text text-anchor="middle" x="812" y="-230.3" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="14.00" fill="#00a060">&gt;</text>
</g>
<!-- 37&#45;&gt;38 -->
<g id="edge38" class="edge">
<title>37&#45;&gt;38</title>
<path fill="none" stroke="#000000" d="M806.7664,-287.8314C807.515,-280.131 808.4053,-270.9743 809.2373,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="812.7256,-262.7051 810.2098,-252.4133 805.7585,-262.0276 812.7256,-262.7051"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that the <code>&lt;plain-text&gt;</code> subtree is now different, which also becomes evident in the string representation.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_to_string</span><span class="p">(</span><span class="n">mutated_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&lt;foo&gt; &lt;/foo&gt;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Generalizing-Trees">Generalizing Trees<a class="anchor-link" href="#Generalizing-Trees">&#182;</a></h2><p>Now for the main part – finding out which parts of a tree can be generalized. Our idea is to <em>test</em> a finite number of mutations to a subtree (say, 10). If all of these tests fail as well, then we assume we can generalize the subtree to a placeholder.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We introduce a class <code>TreeGeneralizer</code> for this purpose. On top of <code>grammar</code> and <code>tree</code> already used for the <code>TreeMutator</code> constructor, the <code>TreeGeneralizer</code> also takes a <code>test</code> function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeGeneralizer</span><span class="p">(</span><span class="n">TreeMutator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine which parts of a derivation tree can be generalized.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
                 <span class="n">max_tries_for_generalization</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor. `grammar` and `tree` are as in `TreeMutator`.</span>
<span class="sd">        `test` is a function taking a string that either</span>
<span class="sd">          * raises an exception, indicating test failure;</span>
<span class="sd">          * or not, indicating test success.</span>
<span class="sd">        `max_tries_for_generalization` is the number of times</span>
<span class="sd">        an instantiation has to fail before it is generalized.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">grammar</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test</span> <span class="o">=</span> <span class="n">test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_tries_for_generalization</span> <span class="o">=</span> <span class="n">max_tries_for_generalization</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>test</code> function is used in <code>test_tree()</code>, returning <code>False</code> if the test fails (raising an exception), and <code>True</code> if the test passes (no exception).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeGeneralizer</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return True if testing `tree` passes, else False&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">tree_to_string</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FAIL (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PASS&quot;</span><span class="p">)</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">ret</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Testing-for-Generalization">Testing for Generalization<a class="anchor-link" href="#Testing-for-Generalization">&#182;</a></h3><p>The <code>can_generalize()</code> method brings the above methods together. It creates a number of tree mutations at the given path, and returns True if all of them produce a failure. (Note that this is not as sophisticated as our <a href="DeltaDebugger.html">delta debugger</a> implementation, which also checks that the <em>same</em> error occurs.)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeGeneralizer</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">can_generalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">TreePath</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DerivationTree</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return True if the subtree at `path` can be generalized.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_tries_for_generalization</span><span class="p">):</span>
            <span class="n">mutated_tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tree</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_tree</span><span class="p">(</span><span class="n">mutated_tree</span><span class="p">):</span>
                <span class="c1"># Failure no longer occurs; cannot abstract</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us put <code>TreeGeneralizer</code> into action. We can directly use <code>remove_html_markup()</code> as test function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bad_input_tree_generalizer</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreeGeneralizer</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">TreeGeneralizer</span><span class="p">(</span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">,</span> <span class="n">bad_input_tree</span><span class="p">,</span>
                           <span class="n">remove_html_markup</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>On our <code>BAD_INPUT</code> (and its tree), can we generalize the root <code>&lt;html&gt;</code> node? In other words, does the failure occur for all possible <code>&lt;html&gt;</code> inputs?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_input_tree_generalizer</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">can_generalize</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing &#39;&#39;...PASS
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>False
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The answer is no. The first alternative passes the test; hence no generalization.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How about the middle <code>&lt;plain_text&gt;</code> part? Can we generalize this?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_input_tree_generalizer</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">can_generalize</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing &#39;&lt;foo&gt;/Ie&lt;/foo&gt;&#39;...PASS
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>False
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The answer is no – just as above.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How about the closing tag? Can we generalize this one?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_input_tree_generalizer</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">can_generalize</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing &#39;&lt;foo&gt;&#34;bar&lt;/kz35Z9&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/Q4&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/N68Px6&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/E&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/o&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/C&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/W&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/Y&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/l37&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;foo&gt;&#34;bar&lt;/Hfi3&gt;&#39;...FAIL (AssertionError)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>True
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Yes, we can! All alternate instantiations of <code>&lt;closing-tag&gt;</code> result in a failure.</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">Is this also true for <code>&lt;opening-tag&gt;</code>?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="5dcb4ec8-82be-11eb-9199-acde48001122" id="5dcb4ec8-82be-11eb-9199-acde48001122-1" onclick="clear_selection('5dcb4ec8-82be-11eb-9199-acde48001122')">
        <label id="5dcb4ec8-82be-11eb-9199-acde48001122-1-label" for="5dcb4ec8-82be-11eb-9199-acde48001122-1">Yes</label><br>

        <input type="radio" name="5dcb4ec8-82be-11eb-9199-acde48001122" id="5dcb4ec8-82be-11eb-9199-acde48001122-2" onclick="clear_selection('5dcb4ec8-82be-11eb-9199-acde48001122')">
        <label id="5dcb4ec8-82be-11eb-9199-acde48001122-2-label" for="5dcb4ec8-82be-11eb-9199-acde48001122-2">No</label><br>

    </div>
    </p>
    <input id="5dcb4ec8-82be-11eb-9199-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('5dcb4ec8-82be-11eb-9199-acde48001122', 4, 0, '(&quot;No&quot; == &quot;No&quot;) + (&quot;No&quot; is &quot;No&quot;)')">
    <span class="quiz_hint" id="5dcb4ec8-82be-11eb-9199-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Note that the above does not hold for <code>&lt;opening-tag&gt;</code>. If the attribute value contains a quote character, it will extend to the end of the input. This is another error, but not caught by our assertion; hence, the input will be flagged as passing:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">BAD_ATTR_INPUT</span> <span class="o">=</span> <span class="s1">&#39;&lt;foo attr=&quot;</span><span class="se">\&#39;</span><span class="s1">&quot;&gt;bar&lt;/foo&gt;&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup</span><span class="p">(</span><span class="n">BAD_ATTR_INPUT</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The effect of this is that there are patterns for <code>&lt;opening-tag&gt;</code> which do not cause the failure to occur; hence, <code>&lt;opening-tag&gt;</code> is not a fully valid generalization.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This, however, becomes apparent only if one of our generated tests includes a quote character in the attribute value. Since quote characters are as likely (or as unlikely) to appear as other characters, this effect may not become apparent in our default 10 tests:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_input_tree_generalizer</span><span class="p">()</span><span class="o">.</span><span class="n">can_generalize</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>True
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>It will become apparent, however, as we increase the number of tests:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_input_tree_generalizer</span><span class="p">(</span><span class="n">max_tries_for_generalization</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">can_generalize</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing &#39;&lt;C25 a=\&#39;;t\&#39; J=&#34;&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;r&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;s&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;W43V&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;Yn Xa=\&#39;\r\&#39; pk2=\&#39;\&#39; w2U7e=&#34;$&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;w584 h9=&#34;&#34; O=&#34;&#34; j=&#34;&#34; y=&#34;&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;Xd&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;J&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;tM69sbm5n n4H1546=\&#39;\r_\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;R&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;X&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;Ada np=\&#39;7\&#39; y7v=\&#39;\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;B V=\&#39;\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;K v=&#34;$&#34; s5F=&#34;\x0b&#34; q=&#34;&#34; E=\&#39;\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;Fcdt8 v7A4u=\&#39;.\t\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;s n=&#34;&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;W&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;ap&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;B1&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;Q00wY M=\&#39;\r \&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;O6 d7=&#34;&#34; H=\&#39;\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;v1IH w=&#34;&#34; ZI=&#34;&#34; O=&#34;&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;T1 w998=\&#39;a\&#39; j=\&#39;z\n7\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;Dnh1&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;D F9=&#34;&#34; x4=\&#39;\&#39; Hup=\&#39;7\n\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;l62E&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;k11 P8x5=&#34;&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;V6LBVu&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;k9S&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;tU2J913 lQ6N=\&#39;\&#39; f=\&#39;*\&#39; V=\&#39;\&#39; b=&#34;&#34; l=&#34;&#34; G=\&#39;\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;X O=&#34;U~&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;q4 W=\&#39;\&#39; i=\&#39;aA9\&#39; I=\&#39;9\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;HK&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;T&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;NJc j32=&#34;\x0b&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;G&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;w B=&#34;\r&#34;&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;Ac1&gt;&#34;bar&lt;/foo&gt;&#39;...FAIL (AssertionError)
Testing &#39;&lt;vB y2=\&#39;7x\&#39;\&#39;&gt;&#34;bar&lt;/foo&gt;&#39;...PASS
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>False
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that our approach may <em>overgeneralize</em> – producing a generalization that may be too lenient. In practice, this is not too much of a problem, as we would be interested in characterizing cases that trigger the failure, rather than characterizing a small subset that does not trigger the failure.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Generalizable-Paths">Generalizable Paths<a class="anchor-link" href="#Generalizable-Paths">&#182;</a></h3><p>Using <code>can_generalize()</code>, we can devise a method <code>generalizable_paths()</code> that returns all paths in the tree that can be generalized.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeGeneralizer</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">find_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                   <span class="n">predicate</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">TreePath</span><span class="p">,</span> <span class="n">DerivationTree</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span> 
                   <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TreePath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                   <span class="n">tree</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DerivationTree</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TreePath</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of all paths for which `predicate` holds.</span>
<span class="sd">        `predicate` is a function `predicate`(`path`, `tree`), where</span>
<span class="sd">        `path` denotes a subtree in `tree`. If `predicate()` returns</span>
<span class="sd">        True, `path` is included in the returned list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">assert</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>
        <span class="k">assert</span> <span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subtree</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">predicate</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tree</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>

        <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">children</span><span class="p">):</span>
                <span class="n">child_symbol</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">child</span>
                <span class="k">if</span> <span class="n">child_symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">:</span>
                    <span class="n">paths</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_paths</span><span class="p">(</span><span class="n">predicate</span><span class="p">,</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">paths</span>

    <span class="k">def</span> <span class="nf">generalizable_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TreePath</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all paths whose subtrees can be generalized.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_paths</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">can_generalize</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is <code>generalizable_paths()</code> in action. We obtain all (paths to) subtrees that can be generalized:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_input_generalizable_paths</span> <span class="o">=</span> \
    <span class="n">cast</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">,</span> <span class="n">bad_input_tree_generalizer</span><span class="p">())</span><span class="o">.</span><span class="n">generalizable_paths</span><span class="p">()</span>
<span class="n">bad_input_generalizable_paths</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[[0, 0, 0], [0, 0, 1, 0, 1, 0], [0, 0, 1, 0, 1, 1], [0, 0, 2]]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To convert these subtrees into abstract failure-inducing patterns, the method <code>generalize_path()</code> returns a copy of the tree with the subtree replaced by a nonterminal without children:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeGeneralizer</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">generalize_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">TreePath</span><span class="p">,</span> 
                        <span class="n">tree</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DerivationTree</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a copy of the tree in which the subtree at `path`</span>
<span class="sd">        is generalized (= replaced by a nonterminal without children)&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">tree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>
        <span class="k">assert</span> <span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">symbol</span><span class="p">,</span> <span class="n">children</span> <span class="o">=</span> <span class="n">tree</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span> <span class="ow">or</span> <span class="n">children</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="kc">None</span>  <span class="c1"># Nonterminal without children</span>

        <span class="n">head</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">new_children</span> <span class="o">=</span> <span class="p">(</span><span class="n">children</span><span class="p">[:</span><span class="n">head</span><span class="p">]</span> <span class="o">+</span>
                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">generalize_path</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">children</span><span class="p">[</span><span class="n">head</span><span class="p">])]</span> <span class="o">+</span>
                        <span class="n">children</span><span class="p">[</span><span class="n">head</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">new_children</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The function <code>all_terminals()</code> expands these placeholders:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_terminals</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">,</span> <span class="n">bad_input_tree_generalizer</span><span class="p">())</span><span class="o">.</span><span class="n">generalize_path</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&lt;opening-tag&gt;&#34;bar&lt;plain-text&gt;&lt;/foo&gt;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Finally, the method <code>generalize()</code> obtains a tree in which all generalizable paths actually are generalized:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeGeneralizer</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">generalize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns a copy of the tree in which all generalizable subtrees</span>
<span class="sd">        are generalized (= replaced by nonterminals without children)&quot;&quot;&quot;</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span>
        <span class="k">assert</span> <span class="n">tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalizable_paths</span><span class="p">():</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalize_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tree</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">abstract_failure_inducing_input</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">,</span> <span class="n">bad_input_tree_generalizer</span><span class="p">())</span><span class="o">.</span><span class="n">generalize</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This gives us the final generalization of <code>BAD_INPUT</code>. In the abstract failure-inducing input, all generalizable elements are generalized.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_terminals</span><span class="p">(</span><span class="n">abstract_failure_inducing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&lt;opening-tag&gt;&#34;&lt;plain-text&gt;&lt;closing-tag&gt;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that to obtain the failure, it suffices to have an <code>&lt;opening-tag&gt;</code>, followed by a quote and (any) <code>&lt;plain-text&gt;</code> and (any) <code>&lt;closing-tag&gt;</code>. Clearly, all that it takes to produce the failure is to have a double quote in the plain text.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Also note how this diagnosis was reached through <em>experiments</em> only – just as with <a href="DeltaDebugger.html">delta debugging</a>, we could treat the program under test as a black box. In contrast to delta debugging, however, we obtain an <em>abstraction</em> that generalizes the circumstances under which a given failure occurs.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Fuzzing-with-Patterns">Fuzzing with Patterns<a class="anchor-link" href="#Fuzzing-with-Patterns">&#182;</a></h2><p>One neat side effect of abstract failure-inducing patterns is that they can be easily instantiated into further test cases, all set to reproduce the failure in question. This gives us a test suite we can later test our fix against.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The method <code>fuzz_tree()</code> takes a tree representing an abstract failure-inducing input and instantiates all missing subtrees.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/copy.html" class="import" target="_blank">copy</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TreeGeneralizer</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fuzz_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">DerivationTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DerivationTree</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return an instantiated copy of `tree`.&quot;&quot;&quot;</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzer</span><span class="o">.</span><span class="n">expand_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bitg</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TreeGeneralizer</span><span class="p">,</span> <span class="n">bad_input_tree_generalizer</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">all_terminals</span><span class="p">(</span><span class="n">bitg</span><span class="o">.</span><span class="n">fuzz_tree</span><span class="p">(</span><span class="n">abstract_failure_inducing_input</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;UzL3Ct6&gt;&#34;&lt;/p&gt;
&lt;nw10E6&gt;&#34;&lt;/W&gt;
&lt;h lV=&#34;&#39;&#34;&gt;&#34;&lt;/x8&gt;
&lt;k&gt;&#34;&lt;/u&gt;
&lt;a0 l0820650g=&#39;3&#39;&gt;&#34;&lt;/v5t&gt;
&lt;zTg&gt;&#34;&lt;/o1Z&gt;
&lt;yMgT02p s=&#34;&#34; g94e=&#39;R&#39;&gt;&#34;&lt;/P2&gt;
&lt;Y&gt;&#34;&lt;/S9b&gt;
&lt;X2566xS8v2&gt;&#34;&lt;/r13&gt;
&lt;D48&gt;&#34;	&lt;/R&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can take these inputs and see whether they reproduce the failure in question:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">successes</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">failures</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">trials</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trials</span><span class="p">):</span>
    <span class="n">test_input</span> <span class="o">=</span> <span class="n">all_terminals</span><span class="p">(</span>
        <span class="n">bitg</span><span class="o">.</span><span class="n">fuzz_tree</span><span class="p">(</span><span class="n">abstract_failure_inducing_input</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">remove_html_markup</span><span class="p">(</span><span class="n">test_input</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
        <span class="n">successes</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">failures</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">successes</span><span class="p">,</span> <span class="n">failures</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>(982, 18)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We get an overall failure rate of ~98%, which is not bad at all.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">failures</span> <span class="o">/</span> <span class="mi">1000</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>0.018
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In our case, it is <em>overgeneralization</em> (as discussed above) that is responsible for not reaching a 100% rate. (In all generality, we are trying to approximate the behavior of a Turing machine with a context free grammar, which is, well, always an approximation.) However, even a lower rate would still be useful, as any additional test case that reproduces a failure helps in ensuring the final fix is complete.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Putting-it-all-Together">Putting it all Together<a class="anchor-link" href="#Putting-it-all-Together">&#182;</a></h2><p>Let us now put together all this in a more convenient package that does not require the user to parse and unparse derivation trees.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>DDSetDebugger</code> is modeled after the <code>DeltaDebugger</code> from <a href="DeltaDebugger.html">the chapter on delta debugging</a>. It is to be used as</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DDSetDebugger</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">some_failing_function</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
<p>After that, evaluating <code>dd</code> yields a generalized abstract failure-inducing input as a string.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Since <code>DDSetDebugger</code> accepts only one grammar, the function to be debugged should have exactly one string argument (besides other arguments); this string must fit the grammar.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Constructor">Constructor<a class="anchor-link" href="#Constructor">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The constructor puts together the various components. It allows for customization by subclassing.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="DeltaDebugger.html" class="import" target="_blank">DeltaDebugger</a></span> <span class="kn">import</span> <span class="n">CallCollector</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DDSetDebugger</span><span class="p">(</span><span class="n">CallCollector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Debugger implementing the DDSET algorithm for abstracting failure-inducing inputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grammar</span><span class="p">:</span> <span class="n">Grammar</span><span class="p">,</span> 
                 <span class="n">generalizer_class</span><span class="p">:</span> <span class="n">Type</span> <span class="o">=</span> <span class="n">TreeGeneralizer</span><span class="p">,</span>
                 <span class="n">parser</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Parser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Constructor.</span>
<span class="sd">        `grammar` is an input grammar in fuzzingbook format.</span>
<span class="sd">        `generalizer_class` is the tree generalizer class to use</span>
<span class="sd">        (default: `TreeGeneralizer`)</span>
<span class="sd">        `parser` is the parser to use (default: `EarleyParser(grammar)`).</span>
<span class="sd">        All other keyword args are passed to the tree generalizer, notably:</span>
<span class="sd">        `fuzzer` - the fuzzer to use (default: `GrammarFuzzer`), and</span>
<span class="sd">        `log` - enables debugging output if True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grammar</span> <span class="o">=</span> <span class="n">grammar</span>
        <span class="k">assert</span> <span class="n">is_valid_grammar</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">generalizer_class</span> <span class="o">=</span> <span class="n">generalizer_class</span>

        <span class="k">if</span> <span class="n">parser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="n">EarleyParser</span><span class="p">(</span><span class="n">grammar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="c1"># These save state for further fuzz() calls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generalized_args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generalized_trees</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DerivationTree</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generalizers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TreeGeneralizer</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Generalizing-Arguments">Generalizing Arguments<a class="anchor-link" href="#Generalizing-Arguments">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The method <code>generalize()</code> is the many entry point. For all string arguments collected in the first function call, it generalizes the arguments and returns an abstract failure-inducing string.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DDSetDebugger</span><span class="p">(</span><span class="n">DDSetDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">generalize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generalize arguments seen. For each function argument,</span>
<span class="sd">        produce an abstract failure-inducing input that characterizes</span>
<span class="sd">        the set of inputs for which the function fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalized_args</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalized_args</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">generalized_args</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generalized_trees</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generalizers</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">():</span>
            <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">call</span><span class="p">({</span><span class="n">arg</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">()[</span><span class="n">arg</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">tree</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalizer_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grammar</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> 
                                             <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">generalized_tree</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">generalize</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">generalizers</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">gen</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">generalized_trees</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">generalized_tree</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">generalized_args</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_terminals</span><span class="p">(</span><span class="n">generalized_tree</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalized_args</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DDSetDebugger</span><span class="p">(</span><span class="n">DDSetDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a string representation of the generalized call.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generalize</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is an example of how <code>DDSetDebugger</code> would be used on our <code>BAD_INPUT</code> example. Simply evaluating the debugger yields a call with a generalized input.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DDSetDebugger</span><span class="p">(</span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="n">BAD_INPUT</span><span class="p">)</span>
<span class="n">dd</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>remove_html_markup(s=&#39;&lt;opening-tag&gt;&#34;&lt;plain-text&gt;&lt;closing-tag&gt;&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Fuzzing">Fuzzing<a class="anchor-link" href="#Fuzzing">&#182;</a></h3><p>The <code>fuzz()</code> method produces instantiations of the abstract failure-inducing pattern.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DDSetDebugger</span><span class="p">(</span><span class="n">DDSetDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fuzz_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return arguments randomly instantiated</span>
<span class="sd">        from the abstract failure-inducing pattern.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalized_trees</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generalize</span><span class="p">()</span>

        <span class="n">args</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generalized_args</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalized_trees</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">tree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalized_trees</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generalizers</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span>
            <span class="n">instantiated_tree</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">fuzz_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="n">args</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_terminals</span><span class="p">(</span><span class="n">instantiated_tree</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">fuzz</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a call with arguments randomly instantiated</span>
<span class="sd">        from the abstract failure-inducing pattern.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzz_args</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here are some axamples of <code>fuzz()</code> in action:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DDSetDebugger</span><span class="p">(</span><span class="n">SIMPLE_HTML_GRAMMAR</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="n">BAD_INPUT</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;remove_html_markup(s=\&#39;&lt;Xq&gt;&#34;&lt;/j&gt;\&#39;)&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;remove_html_markup(s=\&#39;&lt;L89B6b9vz&gt;&#34;\\t&lt;/a3&gt;\&#39;)&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">fuzz</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;remove_html_markup(s=\&#39;&lt;Z VF=\\\&#39;\\\&#39; l=&#34;_-(&#34;&gt;&#34;)&lt;/Y&gt;\&#39;)&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>These can be fed into <code>eval()</code>, set to produce more failing calls.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="nb">eval</span><span class="p">(</span><span class="n">dd</span><span class="o">.</span><span class="n">fuzz</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-3087e00969df&gt;&#34;, line 2, in &lt;module&gt;
    eval(dd.fuzz())
  File &#34;&lt;string&gt;&#34;, line 1, in &lt;module&gt;
  File &#34;&lt;ipython-input-1-02fa29ebf01a&gt;&#34;, line 17, in remove_html_markup
    assert &#39;&lt;&#39; not in out and &#39;&gt;&#39; not in out
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="More-Examples">More Examples<a class="anchor-link" href="#More-Examples">&#182;</a></h2><p>Let us apply <code>DDSetDebugger</code> on more examples.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Square-Root">Square Root<a class="anchor-link" href="#Square-Root">&#182;</a></h3><p>Our first example is the <code>square_root()</code> function from <a href="Assertions.html">the chapter on assertions</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Assertions.html" class="import" target="_blank">Assertions</a></span> <span class="kn">import</span> <span class="n">square_root</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>square_root()</code> function fails on a value of <code>-1</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">square_root</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-d80ffca057e6&gt;&#34;, line 2, in &lt;module&gt;
    square_root(-1)
  File &#34;Assertions.ipynb&#34;, line 55, in square_root
    assert x &gt;= 0  # precondition
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We define a grammar for its arguments:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">INT_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;int&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;int&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;positive-int&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;-&lt;positive-int&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;positive-int&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;nonzero-digit&gt;&lt;positive-int&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;nonzero-digit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;123456789&quot;</span><span class="p">),</span>

    <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The test function takes a string and converts it into an integer:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">square_root_test</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">square_root</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With this, we can go and see whether we can generalize a failing input:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DDSetDebugger</span><span class="p">(</span><span class="n">INT_GRAMMAR</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd_square_root</span><span class="p">:</span>
    <span class="n">square_root_test</span><span class="p">(</span><span class="s2">&quot;-1&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd_square_root</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing &#39;-8&#39;...FAIL (AssertionError)
Testing &#39;-316&#39;...FAIL (AssertionError)
Testing &#39;8&#39;...PASS
Testing &#39;684&#39;...PASS
Testing &#39;-3&#39;...FAIL (AssertionError)
Testing &#39;-870&#39;...FAIL (AssertionError)
Testing &#39;-3&#39;...FAIL (AssertionError)
Testing &#39;-3451&#39;...FAIL (AssertionError)
Testing &#39;-8&#39;...FAIL (AssertionError)
Testing &#39;-63213&#39;...FAIL (AssertionError)
Testing &#39;-26&#39;...FAIL (AssertionError)
Testing &#39;-4&#39;...FAIL (AssertionError)
Testing &#39;-6&#39;...FAIL (AssertionError)
Testing &#39;-8&#39;...FAIL (AssertionError)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>square_root_test(s=&#39;-&lt;positive-int&gt;&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Success! We see that have nicely generalized the failure-inducing input to a pattern that translates into "any negative number".</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Middle">Middle<a class="anchor-link" href="#Middle">&#182;</a></h3><p>The <code>middle()</code> function from <a href="StatisticalDebugger.html">the chapter on statistical debugging</a> returns the middle of three numerical values <code>x</code>, <code>y</code>, and <code>z</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="StatisticalDebugger.html" class="import" target="_blank">StatisticalDebugger</a></span> <span class="kn">import</span> <span class="n">middle</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We set up a test function that evaluates a string – a tuple of three arguments – and then tests <code>middle()</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">middle_test</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">middle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The grammar for the three numbers simply puts three integers together:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">XYZ_GRAMMAR</span><span class="p">:</span> <span class="n">Grammar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;start&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;int&gt;, &lt;int&gt;, &lt;int&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;int&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;positive-int&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;-&lt;positive-int&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;positive-int&gt;&quot;</span><span class="p">:</span>
        <span class="p">[</span><span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;nonzero-digit&gt;&lt;positive-int&gt;&quot;</span><span class="p">],</span>

    <span class="s2">&quot;&lt;nonzero-digit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;123456789&quot;</span><span class="p">),</span>

    <span class="s2">&quot;&lt;digit&gt;&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is an example of <code>middle()</code> failing:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">middle_test</span><span class="p">(</span><span class="s2">&quot;2, 1, 3&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;&lt;ipython-input-1-66d8f3f75b66&gt;&#34;, line 2, in &lt;module&gt;
    middle_test(&#34;2, 1, 3&#34;)
  File &#34;&lt;ipython-input-1-5682ed7df528&gt;&#34;, line 3, in middle_test
    assert middle(x, y, z) == sorted([x, y, z])[1]
AssertionError (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>What happens if we debug this with <code>DDSetDebugger</code>? We see that there is no abstraction at the syntax level that could characterize this failure:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DDSetDebugger</span><span class="p">(</span><span class="n">XYZ_GRAMMAR</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd_middle</span><span class="p">:</span>
    <span class="n">middle_test</span><span class="p">(</span><span class="s2">&quot;2, 1, 3&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd_middle</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing &#39;7, 4591, -0&#39;...PASS
Testing &#39;6, 1, 3&#39;...PASS
Testing &#39;7, 1, 3&#39;...PASS
Testing &#39;7, 1, 3&#39;...PASS
Testing &#39;2, -7, 3&#39;...FAIL (AssertionError)
Testing &#39;2, 0, 3&#39;...FAIL (AssertionError)
Testing &#39;2, -89, 3&#39;...FAIL (AssertionError)
Testing &#39;2, 973, 3&#39;...PASS
Testing &#39;2, 11, 3&#39;...PASS
Testing &#39;2, 8, 3&#39;...PASS
Testing &#39;2, 1, 9&#39;...FAIL (AssertionError)
Testing &#39;2, 1, -16&#39;...PASS
Testing &#39;2, 1, 35&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 6&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 53&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 5&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 737&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 28&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 3&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 5&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 5&#39;...FAIL (AssertionError)
Testing &#39;2, 1, 56&#39;...FAIL (AssertionError)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>middle_test(s=&#39;2, 1, &lt;positive-int&gt;&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>So, while there are failures that can be nicely characterized using abstractions of input elements, <code>middle()</code> is not one of them. Which is good, because this means that all our other techniques such as <a href="StatisticalDebugger.html">statistical debugging</a> and <a href="DynamicInvariants.html">dynamic invariants</a> still have a use case :-)</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Lessons-Learned">Lessons Learned<a class="anchor-link" href="#Lessons-Learned">&#182;</a></h2><ul>
<li>Generalizing failure-inducing inputs can yield important information for which inputs and under which circumstances a failure occurs.</li>
<li>Generalizing failure-inducing inputs is most useful if the input can be split into multiple elements, of which only a part are relevant for producing the error.</li>
<li>As they help in <em>parsing</em> and <em>producing</em> input, <em>grammars</em> can play an important role in testing and debugging.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Next-Steps">Next Steps<a class="anchor-link" href="#Next-Steps">&#182;</a></h2><p>Our <a href="Repairer.html">next chapter</a> introduces <em>automated repair</em> of programs, building on the fault localization and generalization mechanisms introduced so far.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background<a class="anchor-link" href="#Background">&#182;</a></h2><p>Our <code>DDSetDebugger</code> class implements the DDSET algorithm as introduced by Gopinath et al. in [<a href="https://doi.org/10.1145/3395363.3397349">Gopinath <em>et al</em>, 2020.</a>]. A <a href="https://rahul.gopinath.org/post/2020/07/15/ddset/">full-fledged implementation of DDSET</a> with plenty of details and experiments is available as a Jupyter Notebook. Our implementation follows the <a href="https://rahul.gopinath.org/post/2020/08/03/simple-ddset/">simplified implementation of DDSET, as described by Gopinath</a>.</p>
<p>The potential for determining how input features relate to bugs is not nearly explored yet. 
The ALHAZEN work by Kampmann et al. [<a href="https://doi.org/10.1145/3368089.3409687">Kampmann <em>et al</em>, 2020.</a>] generalizes over DDSET in a different way, by investigating <em>semantic</em> features of input elements such as their numeric interpretation or length and their correlation with failures. Like DDSET, ALHAZEN also uses a feedback loop to strengthen or refute its hypotheses.</p>
<p>In recent work [<a href="https://publications.cispa.saarland/3208/">Gopinath <em>et al</em>, 2021.</a>], Gopinath has extended the concept of DDSET further. His work on <em>evocative expressions</em> introduces a <em>pattern language</em> in which arbitrary DDSET-like patterns can be combined into Boolean formula that even more precisely capture and produce failure circumstances. In particular, evocative expressions can <em>specialize</em> grammars towards Boolean pattern combinations, thus allowing for great flexibility in testing and debugging.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercises">Exercises<a class="anchor-link" href="#Exercises">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-1:-Generalization-and-Specialization">Exercise 1: Generalization and Specialization<a class="anchor-link" href="#Exercise-1:-Generalization-and-Specialization">&#182;</a></h3><p>Consider the abstract failure-inducing input for <code>BAD_INPUT</code> we determined:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_terminals</span><span class="p">(</span><span class="n">abstract_failure_inducing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&lt;opening-tag&gt;&#34;&lt;plain-text&gt;&lt;closing-tag&gt;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><ol>
<li>How does it change if you increase the number of test runs, using <code>max_tries_for_generalization</code>?</li>
<li>What is the success rate of the new pattern?</li>
</ol>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DDSetDebugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-2:-Hierarchical-Delta-Debugging">Exercise 2: Hierarchical Delta Debugging<a class="anchor-link" href="#Exercise-2:-Hierarchical-Delta-Debugging">&#182;</a></h3><p>Implement Hierarchical Delta Debugging on trees.</p>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DDSetDebugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Solution.</strong> Here is a solution:</p>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DDSetDebugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercise-3:-Reducing-Trees">Exercise 3: Reducing Trees<a class="anchor-link" href="#Exercise-3:-Reducing-Trees">&#182;</a></h2><p>Produce minimal trees when reducing.</p>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DDSetDebugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Solution.</strong> Here is a solution:</p>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DDSetDebugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Creative Commons License">
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target=_blank>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/debuggingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/debuggingbook/commits/master/notebooks/DDSetDebugger.ipynb" target=_blank)>Last change: 2021-03-09 12:54:50+01:00</a> &bull; 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> &bull;
<a href="https://cispa.de/en/impressum" target=_blank>Imprint</a>
</p>

<script>
function revealCitation() {
    var c = document.getElementById("citation");
    c.style.display = "block";
}
</script>

<div id="citation" class="citation" style="display: none;">
<a name="citation"></a>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller: "<a href="https://www.debuggingbook.org/beta/html/DDSetDebugger.html">Generalizing Failure Circumstances</a>".  In Andreas Zeller, "<a href="https://www.debuggingbook.org/beta/">The Debugging Book</a>", <a href="https://www.debuggingbook.org/beta/html/DDSetDebugger.html">https://www.debuggingbook.org/beta/html/DDSetDebugger.html</a>.  Retrieved 2021-03-09 12:54:50+01:00.
</p>
<pre>
@incollection{debuggingbook2021:DDSetDebugger,
    author = {Andreas Zeller},
    booktitle = {The Debugging Book},
    title = {Generalizing Failure Circumstances},
    year = {2021},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.debuggingbook.org/beta/html/DDSetDebugger.html}},
    note = {Retrieved 2021-03-09 12:54:50+01:00},
    url = {https://www.debuggingbook.org/beta/html/DDSetDebugger.html},
    urldate = {2021-03-09 12:54:50+01:00}
}
</pre>
</div>

      </div>
    </div>
    </article>

 </body>

</html>