<!-- A html document -->
<!-- 
with standard nbconvert css layout
with standard nbconvert input/output content
standard html tag wrapping
with mathjax loaded
with jupyter wigets
 caption and label elements according to ipub meta tags  
with fuzzingbook adaptations -->None
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /><title>Reducing Failure-Inducing Inputs - The Debugging Book</title>

<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
    </style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  }
  div.output_wrapper {
    display: block;
    page-break-inside: avoid;
  }
  div.output {
    display: block;
    page-break-inside: avoid;
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true }
    }
});
</script>
<!-- End of mathjax configuration --><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<!--[if IE lte 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<style type="text/css">
.ipyfigure { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipyfigure>div { flex:1; }
.ipytable { display: -ms-flex; display: -webkit-flex; display: flex;}
.ipytable>div { flex:1; }

</style>

<link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,500,700|Raleway:300|Source+Code+Pro|Open+Sans' rel='stylesheet' type='text/css'>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<meta property="og:url" content="https://www.debuggingbook.org/beta/html/DeltaDebugger.html" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Reducing Failure-Inducing Inputs - The Debugging Book" />
<meta property="og:description" content="A standard problem in debugging is this: Your program fails after processing some large input. Only a part of this input, however, is responsible for the failure. Reducing the input to a failure-inducing minimum not only eases debugging – it also helps in understanding why and when the program fails. In this chapter, we present techniques that automatically reduce and simplify failure-inducing inputs to a minimum, notably the popular Delta Debugging technique.Prerequisites Using the &quot;delta debugging&quot; technique for reduction has no specific prerequisites. To understand the `DeltaDebugger` implementation, reading the chapter on tracing is recommended.This chapter is adapted from a similar chapter in &quot;The Fuzzing Book&quot;. The material has been adapted to be independent from the `fuzzingbook` infrastructure, to build on general delta debugging (`dd`), and to provide a simpler invocation interface." />
<meta property="og:image" content="https://www.debuggingbook.org/beta/html/PICS/wordcloud.png" />

<meta name="twitter:dnt" content="on">

<link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-touch-icon.png">

<meta name="msapplication-TileColor" content="#B03A2E">
<meta name="msapplication-config" content="favicon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/site.webmanifest">

<meta name="viewport" content="width=device-width, initial-scale=1"></head>
 <body>

    <script>
    var close_menus = function() {
        /* doesn't work yet - AZ
        console.log("Closing menus")
        var cssmenu = document.getElementById("cssmenu")
        var all_items = cssmenu.getElementsByTagName("li");
        var i;
        for (i = 0; i < all_items.length; i++) {
            item = all_items[i];
            // console.log("<li>: ")
            // console.log(item.innerHTML);
            var j;
            var all_ul = item.getElementsByTagName("ul");
            for (j = 0; j < all_ul.length; j++) {
                console.log("<ul>: ")
                console.log(all_ul[j].innerHTML);
                all_ul[j].style.display = "none";
            }
            var all_ol = item.getElementsByTagName("ol");
            for (j = 0; j < all_ol.length; j++) {
                console.log("<ol>: ")
                console.log(all_ol[j].innerHTML);
                all_ol[j].style.display = "none";
            }
        }
        */
    };

    $( document ).ready( close_menus );

    // Let navbar fade away when scrolling down
    var prevScrollpos = window.pageYOffset;
    window.onscroll = function() {
        var currentScrollPos = window.pageYOffset;
        if (currentScrollPos > 10 && currentScrollPos > prevScrollpos) {
            // Hide navbar
            var cssmenu = document.getElementById("cssmenu")
            cssmenu.style.opacity = 0;

            // When scrolling, also close all sub-menus
            close_menus();
        }
        else {
            // Make navbar visible
            document.getElementById("cssmenu").style.opacity = 1;
        }
        prevScrollpos = currentScrollPos;
    };
    </script>
    
<nav>
<div id="cssmenu">
  <ul>
     <li class="has-sub"><a href="#"><span title="The Debugging Book"><i class="fa fa-fw fa-bars"></i> </span><span class="menu_1">The Debugging Book&nbsp;<i class="fa fa-fw fa-wrench"></i></span></a>
        <ol>
           
<li><a href="https://www.debuggingbook.org/beta/"><span class="part_number"><i class="fa fa-fw fa-home"></i></span> About this book</a></li>
<li><a href="https://www.debuggingbook.org/beta/html/00_Table_of_Contents.html"><i class="fa fa-fw fa-sitemap"></i></span> Sitemap</a></li>
<li class="has-sub"><a href="01_Intro.html" class="chapters"><span class="part_number">I</span> Whetting Your Appetite <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tours.html">Tours through the Book</a></li>
<li><a href="Intro_Debugging.html">Introduction to Debugging</a></li>
</ul><li class="has-sub"><a href="02_Observing.html" class="chapters"><span class="part_number">II</span> Observing Executions <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracer.html">Tracing Executions</a></li>
<li><a href="Debugger.html">How Debuggers Work</a></li>
<li><a href="Assertions.html">Asserting Expectations</a></li>
</ul><li class="has-sub"><a href="03_Dependencies.html" class="chapters"><span class="part_number">III</span> Flows and Dependencies <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Slicer.html">Tracking Failure Origins</a></li>
</ul><li class="has-sub"><a href="04_Reducing.html" class="chapters"><span class="part_number">IV</span> Reducing Failure Causes <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="DeltaDebugger.html" class="this_page">Reducing Failure-Inducing Inputs</a></li>
<li><a href="ChangeDebugger.html">Isolating Failure-Inducing Changes</a></li>
</ul><li class="has-sub"><a href="05_Abstracting.html" class="chapters"><span class="part_number">V</span> Abstracting Failures <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="StatisticalDebugger.html">Statistical Debugging</a></li>
<li><a href="DynamicInvariants.html">Mining Function Specifications</a></li>
<li><a href="DDSetDebugger.html">Generalizing Failure Circumstances</a></li>
<li><a href="PerformanceDebugger.html">Debugging Performance Issues</a></li>
</ul><li class="has-sub"><a href="06_Repairing.html" class="chapters"><span class="part_number">VI</span> Automatic Repair <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Repairer.html">Repairing Code Automatically</a></li>
</ul><li class="has-sub"><a href="07_In_the_Large.html" class="chapters"><span class="part_number">VII</span> Debugging in the Large <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="Tracking.html">Tracking Bugs</a></li>
<li><a href="ChangeCounter.html">Where the Bugs are <strong class="new_chapter">&bull;</strong></a></li>
</ul><li class="has-sub"><a href="99_Appendices.html" class="chapters">Appendices <i class="fa fa-fw fa-caret-right"></i></a>
<ul>
<li><a href="ExpectError.html">Error Handling</a></li>
<li><a href="Timer.html">Timer</a></li>
<li><a href="ClassDiagram.html">Class Diagrams</a></li>
<li><a href="StackInspector.html">Inspecting Call Stacks</a></li>
</ul>
           <li><a href="https://www.debuggingbook.org/beta/html/00_Index.html">Index (beta)</a></i></li>
        </ol>
     </li>
     <li class="has-sub"><a href="#"><span title="Reducing Failure-Inducing Inputs"><i class="fa fa-fw fa-list-ul"></i></span> <span class="menu_2">Reducing Failure-Inducing Inputs</span></a>
           <ul><li class="has-sub"><a href="#Synopsis"><i class="fa fa-fw fa-map"></i> Synopsis</a>
</li><li class="has-sub"><a href="#Why-Reducing?">&nbsp;&bull;&nbsp;&nbsp; Why Reducing?</a>
</li><li class="has-sub"><a href="#Manual-Input-Reduction">&nbsp;&bull;&nbsp;&nbsp; Manual Input Reduction</a>
</li><li class="has-sub"><a href="#Delta-Debugging">&nbsp;&bull;&nbsp;&nbsp; Delta Debugging</a>
</li><li class="has-sub"><a href="#A-Simple-DeltaDebugger-Interface">&nbsp;&bull;&nbsp;&nbsp; A Simple DeltaDebugger Interface</a>
<ul><li class="has-sub"><a href="#Excursion:-Implementing-DeltaDebugger">Excursion: Implementing DeltaDebugger</a>
</ul></li><li class="has-sub"><a href="#Usage-Examples">&nbsp;&bull;&nbsp;&nbsp; Usage Examples</a>
<ul><li class="has-sub"><a href="#Reducing-remove_html_markup()">Reducing remove_html_markup()</a>
</li><li class="has-sub"><a href="#Reducing-Multiple-Arguments">Reducing Multiple Arguments</a>
</li><li class="has-sub"><a href="#Invoking-an-Interactive-Debugger">Invoking an Interactive Debugger</a>
</li><li class="has-sub"><a href="#Reducing-other-Collections">Reducing other Collections</a>
</ul></li><li class="has-sub"><a href="#Debugging-Inputs">&nbsp;&bull;&nbsp;&nbsp; Debugging Inputs</a>
</li><li class="has-sub"><a href="#Failure-Inducing-Differences">&nbsp;&bull;&nbsp;&nbsp; Failure-Inducing Differences</a>
</li><li class="has-sub"><a href="#Reducing-Program-Code">&nbsp;&bull;&nbsp;&nbsp; Reducing Program Code</a>
<ul><li class="has-sub"><a href="#Reducing-Code-Lines">Reducing Code Lines</a>
</li><li class="has-sub"><a href="#Reducing-Code-Characters">Reducing Code Characters</a>
</li><li class="has-sub"><a href="#Reducing-Syntax-Trees">Reducing Syntax Trees</a>
</ul></li><li class="has-sub"><a href="#Lessons-Learned"><i class="fa fa-fw fa-trophy"></i> Lessons Learned</a>
</li><li class="has-sub"><a href="#Next-Steps"><i class="fa fa-fw fa-arrows"></i> Next Steps</a>
</li><li class="has-sub"><a href="#Background"><i class="fa fa-fw fa-mortar-board"></i> Background</a>
</li><li class="has-sub"><a href="#Exercises"><i class="fa fa-fw fa-edit"></i> Exercises</a>
<ul><li class="has-sub"><a href="#Exercise-1:-Advanced-Syntactic-Code-Reduction">Exercise 1: Advanced Syntactic Code Reduction</a>
</ul></li></ul></li>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Resources"><i class="fa fa-fw fa-cube"></i> </span><span class="menu_3">Resources</span></a>
     <ul>
     <li><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DeltaDebugger.ipynb" target="_blank" class="edit_as_notebook"><i class="fa fa-fw fa-edit"></i> Edit as Notebook</a></li>
     <li><a href="https://www.debuggingbook.org/beta/slides/DeltaDebugger.slides.html" target="_blank"><i class="fa fa-fw fa-video-camera"></i> View Slides</a></li>
     <li><a href="https://www.debuggingbook.org/beta/code/DeltaDebugger.py"><i class="fa fa-fw fa-download"></i> Download Code (.py)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/notebooks/DeltaDebugger.ipynb"><i class="fa fa-fw fa-download"></i> Download Notebook (.ipynb)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-code.zip"><i class="fa fa-fw fa-cube"></i> All Code (.zip)</a></li>
     <li><a href="https://www.debuggingbook.org/beta/dist/debuggingbook-notebooks.zip"><i class="fa fa-fw fa-cube"></i> All Notebooks (.zip)</a></li>
     <li><a href="https://github.com/uds-se/debuggingbook/" target="_blank"><i class="fa fa-fw fa-github"></i> Project Page</a></li>
     <li><a href="ReleaseNotes.html" target="_blank"><i class="fa fa-fw fa-calendar"></i> Release Notes</a></li>
     </ul>
     </li>
     
     <li class="has-sub"><a href="#"><span title="Share"><i class="fa fa-fw fa-comments"></i> </span> <span class="menu_4">Share</span></a>
        <ul>
            <li><a href="https://twitter.com/intent/tweet?text=I%20just%20read%20%22Reducing%20Failure-Inducing%20Inputs%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDeltaDebugger.html" target="popup" 
onclick="window.open('https://twitter.com/intent/tweet?text=I%20just%20read%20%22Reducing%20Failure-Inducing%20Inputs%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDeltaDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-twitter"></i> Share on Twitter</a>
            <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDeltaDebugger.html" target="popup" 
onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDeltaDebugger.html','popup','width=600,height=600'); return false;"
><i class="fa fa-fw fa-facebook"></i> Share on Facebook</a>
            <li><a href="mailto:?subject=Reducing%20Failure-Inducing%20Inputs&body=I%20just%20read%20%22Reducing%20Failure-Inducing%20Inputs%22%20(part%20of%20@Debugging_Book)%20at%20https%3a%2f%2fwww.debuggingbook.org%2fbeta%2fhtml%2fDeltaDebugger.html"><i class="fa fa-fw fa-envelope"></i> Share by Email</a>
            <li><a href="#citation" id="cite" onclick="revealCitation()"><i class="fa fa-fw fa-mortar-board"></i> Cite</a>
        </ul>
     </li>
     <li class="has-sub"><a href="#"><span title="Help"><i class="fa fa-fw fa-question-circle"></i></span> <span class="menu_5">Help</span></a>
        <ul>
          <li><a href="https://www.debuggingbook.org/beta/#Troubleshooting"><i class="fa fa-fw fa-wrench"></i> Troubleshooting</a></li>
          <li><a href="https://docs.python.org/3/tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Python Tutorial</a>
          <li><a href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" target=_blank><i class="fa fa-fw fa-question-circle"></i> Jupyter Notebook Tutorial</a>
          <li><a href="https://github.com/uds-se/debuggingbook/issues/" target="_blank"><i class="fa fa-fw fa-commenting"></i> Report an Issue</a></li>
        </ul>
     </li>
  </ul>
</div>
</nav>

    <article>
   <div tabindex="-1" id="notebook" class="border-box-sizing">
     <div class="container" id="notebook-container">

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h1 id="Reducing-Failure-Inducing-Inputs">Reducing Failure-Inducing Inputs<a class="anchor-link" href="#Reducing-Failure-Inducing-Inputs">&#182;</a></h1><p>A standard problem in debugging is this: Your program fails after processing some large input. Only a <em>part</em> of this input, however, is responsible for the failure. <em>Reducing</em> the input to a failure-inducing minimum not only eases debugging – it also helps in understanding why and when the program fails. In this chapter, we present techniques that <em>automatically reduce and simplify failure-inducing inputs to a minimum</em>, notably the popular <em>Delta Debugging</em> technique.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;6fmJ5l257bM&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

        <iframe
            width="640"
            height="360"
            src="https://www.youtube-nocookie.com/embed/6fmJ5l257bM"
            frameborder="0"
            allowfullscreen

        ></iframe>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p><strong>Prerequisites</strong></p>
<ul>
<li>Using the "delta debugging" technique for reduction has no specific prerequisites.</li>
<li>To understand the <code>DeltaDebugger</code> implementation, reading <a href="Tracer.html">the chapter on tracing</a> is recommended.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This chapter is adapted from <a href="https://www.fuzzingbook.org/html/Reducer.html">a similar chapter in "The Fuzzing Book"</a>. The material has been adapted to be independent from the <code>fuzzingbook</code> infrastructure, to build on general delta debugging (<code>dd</code>), and to provide a simpler invocation interface.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><div class="synopsis"><h2 id="Synopsis">Synopsis<a class="anchor-link" href="#Synopsis">&#182;</a></h2><!-- Automatically generated. Do not edit. -->

<p>To <a href="Importing.html">use the code provided in this chapter</a>, write</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn"><a href="DeltaDebugger.html" class="import" target="_blank">debuggingbook.DeltaDebugger</a></span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span>
</pre></div>
<p>and then make use of the following features.</p>
<p>A <em>reducer</em> takes a failure-inducing input and reduces it to the minimum that still reproduces the failure.  This chapter provides a <code>DeltaDebugger</code> class that implements such a reducer.</p>
<p>Here is a simple example: An arithmetic expression causes an error in the Python interpreter:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">myeval</span><span class="p">(</span><span class="n">inp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">):</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">myeval</span><span class="p">(</span><span class="s1">&#39;1 + 2 * 3 / 0&#39;</span><span class="p">)</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4002351332.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">myeval</span><span class="p">(</span><span class="s1">&#39;1 + 2 * 3 / 0&#39;</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2200911420.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="n">myeval</span>
    <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span> <span class="p">(</span><span class="n">expected</span><span class="p">)</span>
</pre></div>
<p>Can we reduce this input to a minimum? <em>Delta Debugging</em> is a simple and robust reduction algorithm. We provide a <code>DeltaDebugger</code> class that is used in conjunction with a (failing) function call:</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">fun</span><span class="p">(</span><span class="n">args</span><span class="o">...</span><span class="p">)</span>
<span class="n">dd</span>
</pre></div>
<p>The class automatically determines minimal arguments that cause the function to fail with the same exception as the original. Printing out the class object reveals the minimized call.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
<span class="o">&gt;&gt;&gt;</span>     <span class="n">myeval</span><span class="p">(</span><span class="s1">&#39;1 + 2 * 3 / 0&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dd</span>
<span class="n">myeval</span><span class="p">(</span><span class="n">inp</span><span class="o">=</span><span class="s1">&#39;3/0&#39;</span><span class="p">)</span>
</pre></div>
<p>The input is reduced to the maximum: We get the essence of the division by zero.</p>
<p>There also is an interface to access the reduced input(s) programmatically. The method <code>min_args()</code> returns a dictionary in which all function arguments are minimized:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;3/0&#39;</span><span class="p">}</span>
</pre></div>
<p>In contrast, <code>max_args()</code> returns a dictionary in which all function arguments are maximized, but still pass:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">max_args</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;1 + 2 * 3  &#39;</span><span class="p">}</span>
</pre></div>
<p>The method <code>min_arg_diff()</code> returns a triple of</p>
<ul>
<li>passing input,</li>
<li>failing input, and</li>
<li>their minimal failure-inducing difference:</li>
</ul>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_arg_diff</span><span class="p">()</span>
<span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39; 3 &#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39; 3 /0&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;/0&#39;</span><span class="p">})</span>
</pre></div>
<p>And you can also access the function itself, as well as its original arguments.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">dd</span><span class="o">.</span><span class="n">function</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dd</span><span class="o">.</span><span class="n">args</span><span class="p">()</span>
<span class="p">(</span><span class="s1">&#39;myeval&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;1 + 2 * 3 / 0&#39;</span><span class="p">})</span>
</pre></div>
<p><code>DeltaDebugger</code> processes (i.e., minimizes or maximizes) all arguments that support a <code>len()</code> operation and that can be indexed – notably <em>strings</em> and <em>lists</em>. If a function has multiple arguments, all arguments that can be processed will be processed.</p>
<p>This chapter also provides a number of superclasses to <code>DeltaDebugger</code>, notably <code>CallCollector</code>, which obtains the first function call for <code>DeltaDebugger</code>. <code>CallReducer</code> classes allow for implementing alternate call reduction strategies.</p>
<p><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.49.1 (20210923.0004)
 -->
<!-- Pages: 1 -->
<svg width="306pt" height="749pt"
 viewBox="0.00 0.00 305.50 749.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 745)">
<g id="a_graph0"><a xlink:title="DeltaDebugger class hierarchy">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-745 301.5,-745 301.5,4 -4,4"/>
</a>
</g>
<!-- DeltaDebugger -->
<g id="node1" class="node">
<title>DeltaDebugger</title>
<g id="a_node1"><a xlink:href="#" xlink:title="class DeltaDebugger:&#10;Like CallReducer, but cache test outcomes.">
<polygon fill="none" stroke="black" points="6,-0.5 6,-119.5 161,-119.5 161,-0.5 6,-0.5"/>
<text text-anchor="start" x="35" y="-105.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">DeltaDebugger</text>
<polyline fill="none" stroke="black" points="6,-96.5 161,-96.5 "/>
<g id="a_node1_0"><a xlink:href="#" xlink:title="DeltaDebugger">
<g id="a_node1_1"><a xlink:href="#" xlink:title="__repr__(self) &#45;&gt; str:&#10;Return a string representation of the minimized call.">
<text text-anchor="start" x="14.5" y="-85.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__repr__()</text>
</a>
</g>
<g id="a_node1_2"><a xlink:href="#" xlink:title="dd(self, var_to_be_reduced: str, fail_args: Dict[str, Any], *, mode: str = &#39;&#45;&#39;) &#45;&gt; Tuple[Sequence, Sequence, Sequence]:&#10;General Delta Debugging.&#10;`var_to_be_reduced` &#45; the name of the variable to reduce.&#10;`fail_args` &#45; a dict of (failure&#45;inducing) function arguments,&#10;with `fail_args[var_to_be_reduced]` &#45; the input to apply dd on.&#10;`mode`&#45; how the algorithm should operate:&#10;&#39;&#45;&#39; (default): minimize input (`ddmin`),&#10;&#39;+&#39;: maximizing input (`ddmax`),&#10;&#39;+&#45;&#39;: minimizing pass/fail difference (`dd`)&#10;Returns a triple (`pass`, `fail`, `diff`) with&#10;* maximized passing input (`pass`),&#10;* minimized failing input (`fail`), and&#10;* their difference `diff`&#10;(elems that are in `fail`, but not in `pass`).">
<text text-anchor="start" x="14.5" y="-74.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">dd()</text>
</a>
</g>
<g id="a_node1_3"><a xlink:href="#" xlink:title="max_args(self) &#45;&gt; Dict[str, Any]:&#10;Return 1&#45;maximal arguments.">
<text text-anchor="start" x="14.5" y="-63.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">max_args()</text>
</a>
</g>
<g id="a_node1_4"><a xlink:href="#" xlink:title="min_arg_diff(self) &#45;&gt; Tuple[Dict[str, Any], Dict[str, Any], Dict[str, Any]]:&#10;Return 1&#45;minimal difference between arguments.">
<text text-anchor="start" x="14.5" y="-52.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">min_arg_diff()</text>
</a>
</g>
<g id="a_node1_5"><a xlink:href="#" xlink:title="min_args(self) &#45;&gt; Dict[str, Any]:&#10;Return 1&#45;minimal arguments.">
<text text-anchor="start" x="14.5" y="-41.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">min_args()</text>
</a>
</g>
<g id="a_node1_6"><a xlink:href="#" xlink:title="after_collection(self) &#45;&gt; None:&#10;Called after collection. To be defined in subclasses.">
<text text-anchor="start" x="14.5" y="-30.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">after_collection()</text>
</a>
</g>
<g id="a_node1_7"><a xlink:href="#" xlink:title="check_reproducibility(self) &#45;&gt; None">
<text text-anchor="start" x="14.5" y="-18.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">check_reproducibility()</text>
</a>
</g>
<g id="a_node1_8"><a xlink:href="#" xlink:title="process_args(self, strategy: Callable, **strategy_args: Any) &#45;&gt; Tuple[Dict[str, Any], Dict[str, Any], Dict[str, Any]]:&#10;Reduce all reducible arguments, using `strategy`(var, `strategy_args`).&#10;Can be overloaded in subclasses.">
<text text-anchor="start" x="14.5" y="-8.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">process_args()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CachingCallReducer -->
<g id="node2" class="node">
<title>CachingCallReducer</title>
<g id="a_node2"><a xlink:href="#" xlink:title="class CachingCallReducer:&#10;Like CallReducer, but cache test outcomes.">
<polygon fill="none" stroke="black" points="11,-156.5 11,-209.5 156,-209.5 156,-156.5 11,-156.5"/>
<text text-anchor="start" x="19" y="-195.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">CachingCallReducer</text>
<polyline fill="none" stroke="black" points="11,-186.5 156,-186.5 "/>
<g id="a_node2_9"><a xlink:href="#" xlink:title="CachingCallReducer">
<g id="a_node2_10"><a xlink:href="#" xlink:title="init(self) &#45;&gt; None:&#10;Reset for new collection.">
<text text-anchor="start" x="65.5" y="-175.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">init()</text>
</a>
</g>
<g id="a_node2_11"><a xlink:href="#" xlink:title="test(self, args: Dict[str, Any]) &#45;&gt; str:&#10;Like run(), but also log detail and keep statistics.">
<text text-anchor="start" x="65.5" y="-164.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">test()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- DeltaDebugger&#45;&gt;CachingCallReducer -->
<g id="edge1" class="edge">
<title>DeltaDebugger&#45;&gt;CachingCallReducer</title>
<path fill="none" stroke="black" d="M83.5,-119.73C83.5,-128.79 83.5,-137.9 83.5,-146.25"/>
<polygon fill="none" stroke="black" points="80,-146.37 83.5,-156.37 87,-146.37 80,-146.37"/>
</g>
<!-- CallReducer -->
<g id="node3" class="node">
<title>CallReducer</title>
<g id="a_node3"><a xlink:href="#" xlink:title="class CallReducer:&#10;Collect an exception&#45;raising function call f().&#10;Use as `with CallCollector(): f()`">
<polygon fill="none" stroke="black" points="36.5,-246.5 36.5,-332.5 130.5,-332.5 130.5,-246.5 36.5,-246.5"/>
<text text-anchor="start" x="44.5" y="-318.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">CallReducer</text>
<polyline fill="none" stroke="black" points="36.5,-309.5 130.5,-309.5 "/>
<g id="a_node3_12"><a xlink:href="#" xlink:title="CallReducer">
<g id="a_node3_13"><a xlink:href="#" xlink:title="__init__(self, *, log: Union[bool, int] = False) &#45;&gt; None:&#10;Initialize. If `log` is True, enable logging.">
<text text-anchor="start" x="47.5" y="-298" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node3_14"><a xlink:href="#" xlink:title="reduce_arg(self, var_to_be_reduced: str, args: Dict[str, Any]) &#45;&gt; Sequence:&#10;Determine and return a minimal value for var_to_be_reduced.&#10;To be overloaded in subclasses.">
<text text-anchor="start" x="47.5" y="-287" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">reduce_arg()</text>
</a>
</g>
<g id="a_node3_15"><a xlink:href="#" xlink:title="reset(self) &#45;&gt; None:&#10;Reset the number of tests.">
<text text-anchor="start" x="47.5" y="-275" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">reset()</text>
</a>
</g>
<g id="a_node3_16"><a xlink:href="#" xlink:title="run(self, args: Dict[str, Any]) &#45;&gt; str:&#10;Run collected function with `args`. Return&#10;* PASS if no exception occurred&#10;* FAIL if the collected exception occurred&#10;* UNRESOLVED if some other exception occurred.&#10;Not to be used directly; can be overloaded in subclasses.">
<text text-anchor="start" x="47.5" y="-265" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">run()</text>
</a>
</g>
<g id="a_node3_17"><a xlink:href="#" xlink:title="test(self, args: Dict[str, Any]) &#45;&gt; str:&#10;Like run(), but also log detail and keep statistics.">
<text text-anchor="start" x="47.5" y="-254" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">test()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CachingCallReducer&#45;&gt;CallReducer -->
<g id="edge2" class="edge">
<title>CachingCallReducer&#45;&gt;CallReducer</title>
<path fill="none" stroke="black" d="M83.5,-209.56C83.5,-217.55 83.5,-226.68 83.5,-235.83"/>
<polygon fill="none" stroke="black" points="80,-236.1 83.5,-246.1 87,-236.1 80,-236.1"/>
</g>
<!-- CallCollector -->
<g id="node4" class="node">
<title>CallCollector</title>
<g id="a_node4"><a xlink:href="#" xlink:title="class CallCollector:&#10;Collect an exception&#45;raising function call f().&#10;Use as `with CallCollector(): f()`">
<polygon fill="none" stroke="black" points="21,-369.5 21,-532.5 146,-532.5 146,-369.5 21,-369.5"/>
<text text-anchor="start" x="43" y="-518.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">CallCollector</text>
<polyline fill="none" stroke="black" points="21,-509.5 146,-509.5 "/>
<g id="a_node4_18"><a xlink:href="#" xlink:title="CallCollector">
<g id="a_node4_19"><a xlink:href="#" xlink:title="__enter__(self) &#45;&gt; Any:&#10;Called at begin of `with` block. Turn tracing on.">
<text text-anchor="start" x="29.5" y="-498.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__enter__()</text>
</a>
</g>
<g id="a_node4_20"><a xlink:href="#" xlink:title="__exit__(self, exc_tp: Type, exc_value: BaseException, exc_traceback: traceback) &#45;&gt; Optional[bool]:&#10;Called at end of `with` block. Turn tracing off.">
<text text-anchor="start" x="29.5" y="-487.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">__exit__()</text>
</a>
</g>
<g id="a_node4_21"><a xlink:href="#" xlink:title="__init__(self) &#45;&gt; None:&#10;Initialize collector">
<text text-anchor="start" x="29.5" y="-476.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-style="italic" font-size="10.00">__init__()</text>
</a>
</g>
<g id="a_node4_22"><a xlink:href="#" xlink:title="args(self) &#45;&gt; Dict[str, Any]:&#10;Return the dictionary of collected arguments.">
<text text-anchor="start" x="29.5" y="-465.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">args()</text>
</a>
</g>
<g id="a_node4_23"><a xlink:href="#" xlink:title="call(self, new_args: Optional[Dict[str, Any]] = None) &#45;&gt; Any:&#10;Call collected function. If `new_args` is given,&#10;override arguments from its {var: value} entries.">
<text text-anchor="start" x="29.5" y="-454.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">call()</text>
</a>
</g>
<g id="a_node4_24"><a xlink:href="#" xlink:title="exception(self) &#45;&gt; Optional[BaseException]:&#10;Return the exception produced, or `None` if none.">
<text text-anchor="start" x="29.5" y="-443.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">exception()</text>
</a>
</g>
<g id="a_node4_25"><a xlink:href="#" xlink:title="function(self) &#45;&gt; Callable:&#10;Return the function called.">
<text text-anchor="start" x="29.5" y="-432.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">function()</text>
</a>
</g>
<g id="a_node4_26"><a xlink:href="#" xlink:title="after_collection(self) &#45;&gt; None:&#10;Called after collection. To be defined in subclasses.">
<text text-anchor="start" x="29.5" y="-421.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">after_collection()</text>
</a>
</g>
<g id="a_node4_27"><a xlink:href="#" xlink:title="format_call(self, args: Optional[Dict[str, Any]] = None) &#45;&gt; str:&#10;Return a string representing a call of the function with given args.">
<text text-anchor="start" x="29.5" y="-409.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">format_call()</text>
</a>
</g>
<g id="a_node4_28"><a xlink:href="#" xlink:title="format_exception(self, exc: Optional[BaseException] = None) &#45;&gt; str:&#10;Return a string representing the given exception.">
<text text-anchor="start" x="29.5" y="-398.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">format_exception()</text>
</a>
</g>
<g id="a_node4_29"><a xlink:href="#" xlink:title="init(self) &#45;&gt; None:&#10;Reset for new collection.">
<text text-anchor="start" x="29.5" y="-388.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="10.00">init()</text>
</a>
</g>
<g id="a_node4_30"><a xlink:href="#" xlink:title="traceit(self, frame: frame, event: str, arg: Any) &#45;&gt; None:&#10;Tracing function. Collect first call, then turn tracing off.">
<text text-anchor="start" x="29.5" y="-376.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">traceit()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CallReducer&#45;&gt;CallCollector -->
<g id="edge3" class="edge">
<title>CallReducer&#45;&gt;CallCollector</title>
<path fill="none" stroke="black" d="M83.5,-332.82C83.5,-341 83.5,-349.87 83.5,-358.92"/>
<polygon fill="none" stroke="black" points="80,-359.21 83.5,-369.21 87,-359.21 80,-359.21"/>
</g>
<!-- StackInspector -->
<g id="node5" class="node">
<title>StackInspector</title>
<g id="a_node5"><a xlink:href="StackInspector.html" xlink:title="class StackInspector:&#10;Provide functions to inspect the stack">
<polygon fill="none" stroke="black" points="0,-569.5 0,-740.5 167,-740.5 167,-569.5 0,-569.5"/>
<text text-anchor="start" x="37" y="-726.3" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="14.00" fill="#6a0dad">StackInspector</text>
<polyline fill="none" stroke="black" points="0,-717.5 167,-717.5 "/>
<g id="a_node5_31"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node5_32"><a xlink:href="StackInspector.html" xlink:title="_generated_function_cache = {}">
<text text-anchor="start" x="8.5" y="-705" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">_generated_function_cache</text>
</a>
</g>
</a>
</g>
<polyline fill="none" stroke="black" points="0,-698.5 167,-698.5 "/>
<g id="a_node5_33"><a xlink:href="#" xlink:title="StackInspector">
<g id="a_node5_34"><a xlink:href="StackInspector.html" xlink:title="caller_frame(self) &#45;&gt; frame:&#10;Return the frame of the caller.">
<text text-anchor="start" x="26.5" y="-687" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_frame()</text>
</a>
</g>
<g id="a_node5_35"><a xlink:href="StackInspector.html" xlink:title="caller_function(self) &#45;&gt; Callable:&#10;Return the calling function">
<text text-anchor="start" x="26.5" y="-676" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_function()</text>
</a>
</g>
<g id="a_node5_36"><a xlink:href="StackInspector.html" xlink:title="caller_globals(self) &#45;&gt; Dict[str, Any]:&#10;Return the globals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-665" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_globals()</text>
</a>
</g>
<g id="a_node5_37"><a xlink:href="StackInspector.html" xlink:title="caller_locals(self) &#45;&gt; Dict[str, Any]:&#10;Return the locals() environment of the caller.">
<text text-anchor="start" x="26.5" y="-654" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_locals()</text>
</a>
</g>
<g id="a_node5_38"><a xlink:href="StackInspector.html" xlink:title="caller_location(self) &#45;&gt; Tuple[Callable, int]:&#10;Return the location (func, lineno) of the caller.">
<text text-anchor="start" x="26.5" y="-643" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">caller_location()</text>
</a>
</g>
<g id="a_node5_39"><a xlink:href="StackInspector.html" xlink:title="is_internal_error(self, exc_tp: Type, exc_value: BaseException, exc_traceback: traceback) &#45;&gt; bool:&#10;Return True if exception was raised from `StackInspector` or a subclass.">
<text text-anchor="start" x="26.5" y="-632" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">is_internal_error()</text>
</a>
</g>
<g id="a_node5_40"><a xlink:href="StackInspector.html" xlink:title="our_frame(self, frame: frame) &#45;&gt; bool:&#10;Return true if `frame` is in the current (inspecting) class.">
<text text-anchor="start" x="26.5" y="-621" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">our_frame()</text>
</a>
</g>
<g id="a_node5_41"><a xlink:href="StackInspector.html" xlink:title="search_frame(self, name: str, frame: Optional[frame] = None) &#45;&gt; Tuple[Optional[frame], Optional[Callable]]:&#10;Return a pair (`frame`, `item`)&#10;in which the function `name` is defined as `item`.">
<text text-anchor="start" x="26.5" y="-610" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">search_frame()</text>
</a>
</g>
<g id="a_node5_42"><a xlink:href="StackInspector.html" xlink:title="search_func(self, name: str, frame: Optional[frame] = None) &#45;&gt; Optional[Callable]:&#10;Search in callers for a definition of the function `name`">
<text text-anchor="start" x="26.5" y="-599" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="10.00">search_func()</text>
</a>
</g>
<g id="a_node5_43"><a xlink:href="StackInspector.html" xlink:title="create_function(self, frame: frame) &#45;&gt; Callable:&#10;Create function for given frame">
<text text-anchor="start" x="26.5" y="-587" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">create_function()</text>
</a>
</g>
<g id="a_node5_44"><a xlink:href="StackInspector.html" xlink:title="unknown(self) &#45;&gt; None">
<text text-anchor="start" x="26.5" y="-576" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="10.00">unknown()</text>
</a>
</g>
</a>
</g>
</a>
</g>
</g>
<!-- CallCollector&#45;&gt;StackInspector -->
<g id="edge4" class="edge">
<title>CallCollector&#45;&gt;StackInspector</title>
<path fill="none" stroke="black" d="M83.5,-532.71C83.5,-541.49 83.5,-550.49 83.5,-559.41"/>
<polygon fill="none" stroke="black" points="80,-559.45 83.5,-569.45 87,-559.45 80,-559.45"/>
</g>
<!-- Legend -->
<g id="node6" class="node">
<title>Legend</title>
<text text-anchor="start" x="179.5" y="-77.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-weight="bold" font-size="10.00" fill="#6a0dad">Legend</text>
<text text-anchor="start" x="179.5" y="-67.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="186.5" y="-67.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-weight="bold" font-size="8.00">public_method()</text>
<text text-anchor="start" x="179.5" y="-57.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="186.5" y="-57.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-size="8.00">private_method()</text>
<text text-anchor="start" x="179.5" y="-47.5" font-family="Raleway, Helvetica, Arial, sans-serif" font-size="10.00">• </text>
<text text-anchor="start" x="186.5" y="-47.5" font-family="'Fira Mono', 'Source Code Pro', 'Courier', monospace" font-style="italic" font-size="8.00">overloaded_method()</text>
<text text-anchor="start" x="179.5" y="-38.3" font-family="Helvetica,sans-Serif" font-size="9.00">Hover over names to see doc</text>
</g>
</g>
</svg>
</p>
</div>
</div>
</div>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Why-Reducing?">Why Reducing?<a class="anchor-link" href="#Why-Reducing?">&#182;</a></h2><p>A common problem in debugging is that given an input, only a <em>small part of that input may be responsible for the failure</em>. A central part of debugging is to <em>identify</em> these parts – and to simplify (or <em>reduce</em>) the input to a minimal form that reproduces the failure – but does and contains as little else as possible.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's an example of such a situation.  We have a <code>mystery()</code> method that – given its code – can occasionally fail.  But under which circumstances does this actually happen?  We have deliberately obscured the exact condition in order to make this non-obvious.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="Tracer.html" class="import" target="_blank">Tracer</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">quiz</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mystery</span><span class="p">(</span><span class="n">inp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mo">0o17</span> <span class="o">+</span> <span class="mo">0o31</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mo">0o27</span> <span class="o">+</span> <span class="mo">0o22</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid input&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To find an input that causes the function to fail, let us <em>fuzz</em> it – that is, feed it with random inputs – until we find a failing input. There's <a href="https://fuzzingbook.org">entire books about fuzzing</a>; but here, a very simple <code>fuzz()</code> function for this purpose will already suffice.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To build a fuzzer, we need random inputs – and thus a source for randomness. The function <code>random.randrange(a, b)</code> returns a random number in the range (a, b).</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/random.html" class="import" target="_blank">random</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>107
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can use <code>random.randrange()</code> to compose random (printable) characters:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fuzz</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
    <span class="n">fuzz</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">fuzz</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">127</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fuzz</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here are some random strings produced by our <code>fuzz()</code> function:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">fuzz</span><span class="p">()))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&#39;N&amp;+slk%hyp5&#39;
&#34;&#39;@[3(rW*M5W]tMFPU4\\P@tz%[X?uo\\1?b4T;1bDeYtHx #UJ5&#34;
&#39;w}pMmPodJM,_%%BC~dYN6*g|Y*Ou9I&lt;P94}7,99ivb(9`=%jJj*Y*d~OLXk!;J&#39;
&#34;!iOU8]hqg00?u(c);&gt;:\\=V&lt;ZV1=*g#UJA&#39;No5QZ)~--[})Sdv#m*L&#34;
&#39;0iHh[-MzS.U.X}fG7aA:G&lt;bEI\&#39;Ofn[&#34;,Mx{@jfto}i3D?7%V7XdtO6BjYEa#Il)~]&#39;
&#34;E`h7h)ChX0G*m,|sosJ.mu/\\c&#39;EpaPi0(n{&#34;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us now use <code>fuzz()</code> to find an input where <code>mistery()</code> fails:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">fuzz_input</span> <span class="o">=</span> <span class="n">fuzz</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mystery</span><span class="p">(</span><span class="n">fuzz_input</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is an input that causes <code>mystery()</code> to fail:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">failing_input</span> <span class="o">=</span> <span class="n">fuzz_input</span>
<span class="n">failing_input</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>26
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="ExpectError.html" class="import" target="_blank">ExpectError</a></span> <span class="kn">import</span> <span class="n">ExpectError</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/3137704634.py&#34;, line 2, in &lt;module&gt;
    mystery(failing_input)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4141878445.py&#34;, line 5, in mystery
    raise ValueError(&#34;Invalid input&#34;)
ValueError: Invalid input (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Something in this input causes <code>mystery()</code> to fail.  But what is it?</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Manual-Input-Reduction">Manual Input Reduction<a class="anchor-link" href="#Manual-Input-Reduction">&#182;</a></h2><p>One important step in the debugging process is <em>reduction</em> – that is, to identify those circumstances of a failure that are relevant for the failure to occur, and to <em>omit</em> (if possible) those parts that are not.  As Kernighan and Pike [Kernighan <em>et al</em>, 1999] put it:</p>
<blockquote><p>For every circumstance of the problem, check whether it is relevant for the problem to occur.  If it is not, remove it from the problem report or the test case in question.</p>
</blockquote>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Specifically for inputs, they suggest a <em>divide and conquer</em> process:</p>
<blockquote><p>Proceed by binary search.  Throw away half the input and see if the output is still wrong; if not, go back to the previous state and discard the other half of the input.</p>
</blockquote>
<p>This is something we can easily try out, using our last generated input:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">failing_input</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For instance, we can see whether the error still occurs if we only feed in the first half:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">half_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>   <span class="c1"># // is integer division</span>
<span class="n">first_half</span> <span class="o">=</span> <span class="n">failing_input</span><span class="p">[:</span><span class="n">half_length</span><span class="p">]</span>
<span class="n">first_half</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;V&#34;/+!aF-(V4EO&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">first_half</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Nope – the first half alone does not suffice.  Maybe the second half?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">second_half</span> <span class="o">=</span> <span class="n">failing_input</span><span class="p">[</span><span class="n">half_length</span><span class="p">:]</span>
<span class="k">assert</span> <span class="n">first_half</span> <span class="o">+</span> <span class="n">second_half</span> <span class="o">==</span> <span class="n">failing_input</span>
<span class="n">second_half</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;z*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">second_half</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This did not go so well either.  We may still proceed by cutting away <em>smaller chunks</em> – say, one character after another.  If our test is deterministic and easily repeated, it is clear that this process eventually will yield a reduced input.  But still, it is a rather inefficient process, especially for long inputs.  What we need is a <em>strategy</em> that effectively minimizes a failure-inducing input – a strategy that can be automated.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Delta-Debugging">Delta Debugging<a class="anchor-link" href="#Delta-Debugging">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>One strategy to effectively reduce failure-inducing inputs is <em>delta debugging</em> [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002</a>].  Delta Debugging implements the "binary search" strategy, as listed above, but with a twist: If neither half fails (also as above), it keeps on cutting away smaller and smaller chunks from the input, until it eliminates individual characters.  Thus, after cutting away the first half, we cut away
the first quarter, the second quarter, and so on.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us illustrate this on our example, and see what happens if we cut away the first quarter.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">quarter_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
<span class="n">input_without_first_quarter</span> <span class="o">=</span> <span class="n">failing_input</span><span class="p">[</span><span class="n">quarter_length</span><span class="p">:]</span>
<span class="n">input_without_first_quarter</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;F-(V4EOz*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">input_without_first_quarter</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2963114098.py&#34;, line 2, in &lt;module&gt;
    mystery(input_without_first_quarter)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4141878445.py&#34;, line 5, in mystery
    raise ValueError(&#34;Invalid input&#34;)
ValueError: Invalid input (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Ah! This has failed, and reduced our failing input by 25%.  Let's remove another quarter.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_without_first_and_second_quarter</span> <span class="o">=</span> <span class="n">failing_input</span><span class="p">[</span><span class="n">quarter_length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:]</span>
<span class="n">input_without_first_and_second_quarter</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;Oz*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">input_without_first_and_second_quarter</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is not too surprising, as we had that one before:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">second_half</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;z*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_without_first_and_second_quarter</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;Oz*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How about removing the third quarter, then?</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_without_first_and_third_quarter</span> <span class="o">=</span> <span class="n">failing_input</span><span class="p">[</span><span class="n">quarter_length</span><span class="p">:</span>
                                                      <span class="n">quarter_length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">failing_input</span><span class="p">[</span><span class="n">quarter_length</span> <span class="o">*</span> <span class="mi">3</span><span class="p">:]</span>
<span class="n">input_without_first_and_third_quarter</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;F-(V4EQ,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">input_without_first_and_third_quarter</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4218135276.py&#34;, line 2, in &lt;module&gt;
    mystery(input_without_first_and_third_quarter)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4141878445.py&#34;, line 5, in mystery
    raise ValueError(&#34;Invalid input&#34;)
ValueError: Invalid input (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Yes!  This has succeeded.  Our input is now 50% smaller.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We have now tried to remove pieces that make up $\frac{1}{2}$ and $\frac{1}{4}$ of the original failing string.  In the next iteration, we would go and remove even smaller pieces – $\frac{1}{8}$, $\frac{1}{16}$ and so on.  We continue until we are down to $\frac{1}{26}$ – that is, individual characters.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>However, this is something we happily let a computer do for us – and this is what the <em>Delta Debugging</em> algorithm does.  Delta Debugging implements the strategy sketched above: It first removes larger chunks of size $\frac{1}{2}$; if this does not fail, then we proceed to chunks of size $\frac{1}{4}$, then $\frac{1}{8}$ and so on.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>ddmin()</code> implementation uses the exact same Python code as Zeller in [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002</a>]; the only difference is that it has been adapted to work on Python 3.  The variable <code>n</code> (initially 2) indicates the granularity – in each step, chunks of size $\frac{1}{n}$ are cut away.  If none of the test fails (<code>some_complement_is_failing</code> is False), then <code>n</code> is doubled – until it reaches the length of the input.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">PASS</span> <span class="o">=</span> <span class="s1">&#39;PASS&#39;</span>
<span class="n">FAIL</span> <span class="o">=</span> <span class="s1">&#39;FAIL&#39;</span>
<span class="n">UNRESOLVED</span> <span class="o">=</span> <span class="s1">&#39;UNRESOLVED&#39;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ddmin</span><span class="p">(</span><span class="n">test</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="o">*</span><span class="n">test_args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Reduce the input inp, using the outcome of test(fun, inp).&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">test</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="o">*</span><span class="n">test_args</span><span class="p">)</span> <span class="o">!=</span> <span class="n">PASS</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>     <span class="c1"># Initial granularity</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">subset_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">some_complement_is_failing</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">while</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
            <span class="n">complement</span> <span class="o">=</span> <span class="p">(</span><span class="n">inp</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">)]</span> <span class="o">+</span> <span class="n">inp</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">subset_length</span><span class="p">):])</span>

            <span class="k">if</span> <span class="n">test</span><span class="p">(</span><span class="n">complement</span><span class="p">,</span> <span class="o">*</span><span class="n">test_args</span><span class="p">)</span> <span class="o">==</span> <span class="n">FAIL</span><span class="p">:</span>
                <span class="n">inp</span> <span class="o">=</span> <span class="n">complement</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">some_complement_is_failing</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

            <span class="n">start</span> <span class="o">+=</span> <span class="n">subset_length</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">some_complement_is_failing</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">inp</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To see how <code>ddmin()</code> works, let us run it on our failing input. We need to define a <code>test</code> function that returns PASS or FAIL, depending on the test outcome. This <code>generic_test()</code> assumes that the function fails if it raises an exception (such as an <code>AssertException</code>), and passes otherwise. The optional argument <code>expected_exc</code> specifies the name of exception to be checked for; this ensures we reduce only for the kind of error raised in the original failure.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">generic_test</span><span class="p">(</span><span class="n">inp</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
                 <span class="n">expected_exc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">detail</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">PASS</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">detail</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">if</span> <span class="n">expected_exc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="n">FAIL</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">expected_exc</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">expected_exc</span><span class="p">):</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="n">FAIL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="n">UNRESOLVED</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">outcome</span><span class="si">}{</span><span class="n">detail</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outcome</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can now invoke <code>ddmin()</code> in our setting. With each step, we see how the remaining input gets smaller and smaller, until only two characters remain:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ddmin</span><span class="p">(</span><span class="n">generic_test</span><span class="p">,</span> <span class="n">failing_input</span><span class="p">,</span> <span class="n">mystery</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid input&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>mystery(&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
mystery(&#39;z*+s/Q,7)2@0_&#39;): PASS
mystery(&#39;V&#34;/+!aF-(V4EO&#39;): PASS
mystery(&#39;F-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
mystery(&#39;Oz*+s/Q,7)2@0_&#39;): PASS
mystery(&#39;F-(V4EQ,7)2@0_&#39;): FAIL (ValueError: Invalid input)
mystery(&#39;,7)2@0_&#39;): PASS
mystery(&#39;F-(V4EQ&#39;): PASS
mystery(&#39;V4EQ,7)2@0_&#39;): PASS
mystery(&#39;F-(Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
mystery(&#39;Q,7)2@0_&#39;): PASS
mystery(&#39;F-()2@0_&#39;): FAIL (ValueError: Invalid input)
mystery(&#39;2@0_&#39;): PASS
mystery(&#39;F-()&#39;): FAIL (ValueError: Invalid input)
mystery(&#39;()&#39;): FAIL (ValueError: Invalid input)
mystery(&#39;)&#39;): PASS
mystery(&#39;(&#39;): PASS
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;()&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Now we know why <code>mystery()</code> fails – it suffices that the input contains two matching parentheses.  Delta Debugging determines this in 25 steps.  Its result is <em>1-minimal</em>, meaning that every character contained is required to produce the error; removing any (as seen in the last two tests, above) no longer causes the test to fail.  This property is guaranteed by the delta debugging algorithm, which in its last stage always tries to delete characters one by one.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A reduced test case such as the one above has many advantages:</p>
<ul>
<li><p>A reduced test case <strong>reduces the <em>cognitive load</em> of the programmer</strong>.  The test case is shorter and focused, and thus does not burden the programmer with irrelevant details.  A reduced input typically leads to shorter executions and smaller program states, both of which reduce the search space as it comes to understanding the bug.  In our case, we have eliminated lots of irrelevant input – only the two characters the reduced input contains are relevant.</p>
</li>
<li><p>A reduced test case <strong>is easier to communicate</strong>.  All one needs here is the summary: <code>mystery() fails on "()"</code>, which is much better than <code>mystery() fails on a 4100-character input (attached)</code>.</p>
</li>
<li><p>A reduced test case helps in <strong>identifying duplicates</strong>.  If similar bugs have been reported already, and all of them have been reduced to the same cause (namely that the input contains matching parentheses), then it becomes obvious that all these bugs are different symptoms of the same underlying cause – and would all be resolved at once with one code fix.</p>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How effective is delta debugging?  In the best case (when the left half or the right half fails), the number of tests is logarithmic proportional to the length $n$ of an input (i.e., $O(\log_2 n)$); this is the same complexity as binary search.  In the worst case, though, delta debugging can require a number of tests proportional to $n^2$  (i.e., $O(n^2)$) – this happens in the case when we are down to character granularity, and we have to repeatedly tried to delete all characters, only to find that deleting the last character results in a failure [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002</a>].  (This is a pretty pathological situation, though.)</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In general, delta debugging is a robust algorithm that is easy to implement, easy to deploy, and easy to use – provided that the underlying test case is deterministic and runs quickly enough to warrant a number of experiments. In general, any debugging task should start with simplifying the test case as much as possible – and this is where delta debugging can help.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="A-Simple-DeltaDebugger-Interface">A Simple DeltaDebugger Interface<a class="anchor-link" href="#A-Simple-DeltaDebugger-Interface">&#182;</a></h2><p>As defined above, using <code>ddmin()</code> still requires the developer to set up a special testing function – and writing or using even a generic tester (like <code>generic_test()</code>) takes some effort.  We want to simplify the setup such that only two lines of Python is required.</p>
<p>Our aim is to have a <code>DeltaDebugger</code> class that we can use in conjunction with a failing (i.e., exception raising) function call:</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
<span class="n">dd</span>
</pre></div>
<p>Here, at the end of the <code>with</code> statement, printing out <code>dd</code> shows us the minimal input that causes the failure.</p>
</div>
</div>
</div>
</div>

<details id="Excursion:-Implementing-DeltaDebugger">
<summary>Implementing DeltaDebugger</summary>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our interface consist of six building blocks:</p>
<ol>
<li>We collect the name and args of the first call in the <code>with</code> body, as well as the exception it raises.</li>
<li>We set up an infrastructure such that we can repeat calls with different arguments.</li>
<li>We make sure that multiple tests with the same arguments can return outcomes from a cache.</li>
<li>We create a <code>DeltaDebugger</code> class that implements the general Delta Debugging algorithm – an algorithm than can minimize failing inputs as well as maximize passing inputs.</li>
<li>We provide an infrastructure that applies Delta Debugging on multiple arguments.</li>
<li>Finally, custom methods like <code>min_args()</code> allow to invoke delta debugging on arguments.</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Collecting-a-Call">Collecting a Call<a class="anchor-link" href="#Collecting-a-Call">&#182;</a></h4><p>We start by creating an infrastructure that collects a call. The <code>CallCollector</code> class saves the first call observed in <code>_function</code>, <code>_args</code>, and <code>_exception</code> attributes, respectively; it then turns tracing off.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/sys.html" class="import" target="_blank">sys</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/types.html" class="import" target="_blank">types</a></span> <span class="kn">import</span> <span class="n">FunctionType</span><span class="p">,</span> <span class="n">FrameType</span><span class="p">,</span> <span class="n">TracebackType</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="StackInspector.html" class="import" target="_blank">StackInspector</a></span> <span class="kn">import</span> <span class="n">StackInspector</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NoCallError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CallCollector</span><span class="p">(</span><span class="n">StackInspector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collect an exception-raising function call f().</span>
<span class="sd">    Use as `with CallCollector(): f()`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize collector&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reset for new collection.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_function</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_trace_function</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">traceit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="n">FrameType</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Tracing function. Collect first call, then turn tracing off.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;call&#39;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
                <span class="c1"># Internal function</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Already set</span>
                <span class="k">return</span>

            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_func</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">func</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="n">func</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Create new function from given code</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_function</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Create a local copy of args</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_freevars</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># Local var, not an argument</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>

            <span class="c1"># Turn tracing off</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_trace_function</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">after_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Called after collection. To be defined in subclasses.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return the dictionary of collected arguments.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span>

    <span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the function called.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoCallError</span><span class="p">(</span><span class="s2">&quot;No function call collected&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span>

    <span class="k">def</span> <span class="nf">exception</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return the exception produced, or `None` if none.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span>

    <span class="k">def</span> <span class="nf">format_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">format_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>A <code>CallCollector</code> is used like a <code>Tracer</code> from the <a href="Tracer.html">chapter on tracing</a>, using a <code>with</code> block to collect a single function call.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CallCollector</span><span class="p">(</span><span class="n">CallCollector</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Called at begin of `with` block. Turn tracing on.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_trace_function</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traceit</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_tp</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span>
                 <span class="n">exc_traceback</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Called at end of `with` block. Turn tracing off.&quot;&quot;&quot;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">settrace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_trace_function</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">exc_tp</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># re-raise exception</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NoCallError</span><span class="p">(</span><span class="s2">&quot;No call collected&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_internal_error</span><span class="p">(</span><span class="n">exc_tp</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">exc_traceback</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Re-raise exception</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span> <span class="o">=</span> <span class="n">exc_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">after_collection</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># Ignore exception</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here are the attributes as collected by <code>CallCollector</code> for our <code>mystery()</code> function. Note that the <code>mystery()</code> exception is "swallowed" by the <code>CallCollector</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">CallCollector</span><span class="p">()</span> <span class="k">as</span> <span class="n">call_collector</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_collector</span><span class="o">.</span><span class="n">function</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&lt;function __main__.mystery(inp: str) -&gt; None&gt;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_collector</span><span class="o">.</span><span class="n">args</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;inp&#39;: &#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;}
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_collector</span><span class="o">.</span><span class="n">exception</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>ValueError(&#39;Invalid input&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If an error occurs <em>before</em> the first function call takes place, the exception is simply re-raised.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">NameError</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">CallCollector</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
        <span class="n">some_error</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/700237621.py&#34;, line 3, in &lt;module&gt;
    some_error()  # type: ignore
NameError: name &#39;some_error&#39; is not defined (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Repeating-a-Call">Repeating a Call<a class="anchor-link" href="#Repeating-a-Call">&#182;</a></h4><p>Our second step is an infrastructure such that we can call the function collected earlier with alternate arguments. We can call the function directly via the collected <code>_function</code> attribute:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_collector</span><span class="o">.</span><span class="n">function</span><span class="p">()(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">call_collector</span><span class="o">.</span><span class="n">function</span><span class="p">()(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/3898025015.py&#34;, line 2, in &lt;module&gt;
    call_collector.function()(failing_input)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4141878445.py&#34;, line 5, in mystery
    raise ValueError(&#34;Invalid input&#34;)
ValueError: Invalid input (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can also provide the arguments collected during the call:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">call_collector</span><span class="o">.</span><span class="n">function</span><span class="p">()(</span><span class="o">**</span><span class="n">call_collector</span><span class="o">.</span><span class="n">args</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/1915817655.py&#34;, line 2, in &lt;module&gt;
    call_collector.function()(**call_collector.args())
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4141878445.py&#34;, line 5, in mystery
    raise ValueError(&#34;Invalid input&#34;)
ValueError: Invalid input (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>call()</code> method calls the collected function using this construct. It also allows to <em>change</em> individual arguments by providing a <code>new_args</code> dictionary of variable names to new values.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CallCollector</span><span class="p">(</span><span class="n">CallCollector</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call collected function. If `new_args` is given,</span>
<span class="sd">        override arguments from its {var: value} entries.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">new_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_args</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Create local copy</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">():</span>
            <span class="n">args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">()[</span><span class="n">var</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">new_args</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">()(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Using simply <code>call()</code> without arguments reproduces the failure:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">CallCollector</span><span class="p">()</span> <span class="k">as</span> <span class="n">call_collector</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
<span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">call_collector</span><span class="o">.</span><span class="n">call</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/460230734.py&#34;, line 4, in &lt;module&gt;
    call_collector.call()
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/3952656613.py&#34;, line 17, in call
    return self.function()(**args)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4141878445.py&#34;, line 5, in mystery
    raise ValueError(&#34;Invalid input&#34;)
ValueError: Invalid input (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can also supply alternate arguments (and get alternate outcomes):</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_collector</span><span class="o">.</span><span class="n">call</span><span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We close with two helper functions that come handy for logging and error messages:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CallCollector</span><span class="p">(</span><span class="n">CallCollector</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">format_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a string representing a call of the function with given args.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">()</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> \
            <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">arg</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

    <span class="k">def</span> <span class="nf">format_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a string representing the given exception.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">exc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">exc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">CallCollector</span><span class="p">()</span> <span class="k">as</span> <span class="n">call_collector</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_collector</span><span class="o">.</span><span class="n">format_call</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;mystery(inp=\&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_\&#39;)&#39;
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">call_collector</span><span class="o">.</span><span class="n">format_exception</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;ValueError: Invalid input&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Testing,-Logging,-and-Caching">Testing, Logging, and Caching<a class="anchor-link" href="#Testing,-Logging,-and-Caching">&#182;</a></h4><p>Our next to last step is an infrastructure that implements delta debugging for the collected call.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We first introduce a <code>CallReducer</code> class as an abstract superclass for all kinds of reducers.
Its <code>run()</code> method tests the function and returns PASS, FAIL, or UNRESOLVED. As with <code>generic_test()</code>, above, we check for exception type and exact error message.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CallReducer</span><span class="p">(</span><span class="n">CallCollector</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initialize. If `log` is True, enable logging.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reset the number of tests.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tests</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run collected function with `args`. Return</span>
<span class="sd">        * PASS if no exception occurred</span>
<span class="sd">        * FAIL if the collected exception occurred</span>
<span class="sd">        * UNRESOLVED if some other exception occurred.</span>
<span class="sd">        Not to be used directly; can be overloaded in subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_exception</span> <span class="o">=</span> <span class="n">exc</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">())</span> <span class="ow">and</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">())):</span>
                <span class="k">return</span> <span class="n">FAIL</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">UNRESOLVED</span>  <span class="c1"># Some other failure</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_result</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">PASS</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>test()</code> method runs a single test (with logging, if wanted); the <code>reduce_arg()</code> method will eventually reduce an input to the minimum.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CallReducer</span><span class="p">(</span><span class="n">CallReducer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Like run(), but also log detail and keep statistics.&quot;&quot;&quot;</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">PASS</span><span class="p">:</span>
            <span class="n">detail</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">detail</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_exception</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tests</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test #</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tests</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">outcome</span><span class="si">}{</span><span class="n">detail</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">outcome</span>

    <span class="k">def</span> <span class="nf">reduce_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_to_be_reduced</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine and return a minimal value for var_to_be_reduced.</span>
<span class="sd">        To be overloaded in subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="n">var_to_be_reduced</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's some logging output from the <code>test()</code> function:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">CallReducer</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">reducer</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>

<span class="n">reducer</span><span class="o">.</span><span class="n">test</span><span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="n">failing_input</span><span class="p">})</span>
<span class="n">reducer</span><span class="o">.</span><span class="n">test</span><span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">})</span>
<span class="n">reducer</span><span class="o">.</span><span class="n">test</span><span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Test #1 mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #2 mystery(inp=&#39;123&#39;): PASS
Test #3 mystery(inp=&#39;123&#39;): PASS
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;PASS&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>CachingCallReducer</code> variant saves test results, such that we don't have to run the same tests again and again:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CachingCallReducer</span><span class="p">(</span><span class="n">CallReducer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Like CallReducer, but cache test outcomes.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">FrozenSet</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Create a hashable index</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="p">:</span>
            <span class="c1"># Non-hashable value – do not use cache</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="n">outcome</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">outcome</span>

        <span class="k">return</span> <span class="n">outcome</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we now repeat a test with the same argument, its outcome can be found in the cache:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">CachingCallReducer</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">reducer</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>

<span class="n">reducer</span><span class="o">.</span><span class="n">test</span><span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="n">failing_input</span><span class="p">})</span>
<span class="n">reducer</span><span class="o">.</span><span class="n">test</span><span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">})</span>
<span class="n">reducer</span><span class="o">.</span><span class="n">test</span><span class="p">({</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Test #1 mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #2 mystery(inp=&#39;123&#39;): PASS
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;PASS&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="General-Delta-Debugging">General Delta Debugging<a class="anchor-link" href="#General-Delta-Debugging">&#182;</a></h4><p>The <code>DeltaDebugger</code> class finally implements Delta Debugging on arguments. Our implementation uses the <em>general</em> <code>dd</code> delta debugging algorithm from [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002</a>]. In contrast to <code>ddmin</code>, it returns a <em>pair</em> of a maximized passing input and a minimized failing input. The algorithm can be customized, however, to leave the passing input fixed and <em>only</em> to minimize the failing input (as with <code>ddmin</code>), or vice versa.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Internally, <code>dd</code> does not directly work on a list of elements; instead, it works on sets of <em>indices</em> into such a list. The function <code>to_set()</code> converts a collection into such a set.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">to_set</span><span class="p">(</span><span class="n">inp</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert inp into a set of indices&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">)))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to_set</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{0, 1, 2, 3}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The function <code>from_set()</code> converts a set of indices back into the original collection. For this, it uses a function <code>empty()</code> that returns an empty collection that has the same type as the given input <code>inp</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="n">inp</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return an &quot;empty&quot; element of the same type as inp&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">inp</span><span class="p">)()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">),</span> <span class="n">empty</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">empty</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>(&#39;&#39;, [], set())
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The function <code>add_to()</code> tries out various ways to add an element to a given collection.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add_to</span><span class="p">(</span><span class="n">collection</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Add element to collection; return new collection.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">collection</span> <span class="o">+</span> <span class="n">elem</span>  <span class="c1"># Strings</span>

    <span class="k">try</span><span class="p">:</span>  <span class="c1"># Lists and other collections</span>
        <span class="k">return</span> <span class="n">collection</span> <span class="o">+</span> <span class="nb">type</span><span class="p">(</span><span class="n">collection</span><span class="p">)([</span><span class="n">elem</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>  <span class="c1"># Sets</span>
        <span class="k">return</span> <span class="n">collection</span> <span class="o">|</span> <span class="nb">type</span><span class="p">(</span><span class="n">collection</span><span class="p">)([</span><span class="n">elem</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot add element to collection&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add_to</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">),</span> <span class="n">add_to</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="n">add_to</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>(&#39;abcd&#39;, [1, 2, 3, 4], {1, 2, 3, 4})
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Using <code>empty()</code> and <code>add_to()</code>, we can now implement <code>from_set()</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">from_set</span><span class="p">(</span><span class="n">the_set</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">inp</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert a set of indices into `inp` back into a collection.&quot;&quot;&quot;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">the_set</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">add_to</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ret</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">from_set</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> <span class="s2">&quot;abcd&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;bc&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To split a set of elements into <code>n</code> subsets of equal size, we use this helper function, based on <a href="https://stackoverflow.com/questions/2130016/splitting-a-list-into-n-parts-of-approximately-equal-length/37414115#37414115">this discussion in StackOverflow</a>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="n">elems</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
    <span class="k">assert</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">elems</span><span class="p">)</span>

    <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elems</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">subsets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">elems</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">):(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1"># Convert to list and back</span>
        <span class="n">subsets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">elems</span><span class="p">)(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="n">elems</span><span class="p">)[</span><span class="n">i</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">):(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)])</span>
                       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">subsets</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span>
    <span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">subsets</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">elems</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">subsets</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">subsets</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">n</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1, 2, 3, 4, 5, 6, 7]]
[[1, 2, 3, 4], [5, 6, 7]]
[[1, 2, 3], [4, 5], [6, 7]]
[[1, 2], [3, 4], [5, 6], [7]]
[[1, 2], [3, 4], [5], [6], [7]]
[[1, 2], [3], [4], [5], [6], [7]]
[[1], [2], [3], [4], [5], [6], [7]]
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;ab&#39;, &#39;c&#39;, &#39;d&#39;]
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">split</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">},</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[{1, 2, 3}, {4, 5}, {6, 7}]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With these, we can now implement general delta debugging. Our implementation follows [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002</a>] with the following optimizations:</p>
<ol>
<li>We can control whether only to minimize or to maximize ("mode")</li>
<li>The operations "Reduce to subset" and "Increase to subset" are only taken while the number of subsets is still 2.</li>
<li>If "Reduce to subset" and "Increase to subset" are successful, the offset is set to <code>i</code> (not <code>0</code>) to distribute reduction operations more evenly across the input. (Thanks to Olaf Chitil and Joanna Sharrad to point out this issue!)</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NotFailingError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NotPassingError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">CachingCallReducer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">dd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_to_be_reduced</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fail_args</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> 
           <span class="o">*</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;General Delta Debugging.</span>
<span class="sd">        `var_to_be_reduced` - the name of the variable to reduce.</span>
<span class="sd">        `fail_args` - a dict of (failure-inducing) function arguments, </span>
<span class="sd">            with `fail_args[var_to_be_reduced]` - the input to apply dd on.</span>
<span class="sd">        `mode`- how the algorithm should operate:</span>
<span class="sd">            &#39;-&#39; (default): minimize input (`ddmin`),</span>
<span class="sd">            &#39;+&#39;: maximizing input (`ddmax`),</span>
<span class="sd">            &#39;+-&#39;: minimizing pass/fail difference (`dd`)</span>
<span class="sd">        Returns a triple (`pass`, `fail`, `diff`) with</span>
<span class="sd">        * maximized passing input (`pass`), </span>
<span class="sd">        * minimized failing input (`fail`), and</span>
<span class="sd">        * their difference `diff`</span>
<span class="sd">          (elems that are in `fail`, but not in `pass`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">c</span><span class="p">:</span> <span class="n">Set</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># Set up args</span>
            <span class="n">test_args</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">fail_args</span><span class="p">:</span>
                <span class="n">test_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">fail_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
            <span class="n">test_args</span><span class="p">[</span><span class="n">var_to_be_reduced</span><span class="p">]</span> <span class="o">=</span> <span class="n">from_set</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">test_args</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">ret</span><span class="p">(</span><span class="n">c_pass</span><span class="p">:</span> <span class="n">Set</span><span class="p">,</span> <span class="n">c_fail</span><span class="p">:</span> <span class="n">Set</span><span class="p">)</span> <span class="o">-&gt;</span> \
            <span class="n">Tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">from_set</span><span class="p">(</span><span class="n">c_pass</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">),</span>
                    <span class="n">from_set</span><span class="p">(</span><span class="n">c_fail</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">),</span>
                    <span class="n">from_set</span><span class="p">(</span><span class="n">c_fail</span> <span class="o">-</span> <span class="n">c_pass</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">))</span>

        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Initial granularity</span>

        <span class="n">fail_inp</span> <span class="o">=</span> <span class="n">fail_args</span><span class="p">[</span><span class="n">var_to_be_reduced</span><span class="p">]</span>

        <span class="n">c_pass</span> <span class="o">=</span> <span class="n">to_set</span><span class="p">([])</span>
        <span class="n">c_fail</span> <span class="o">=</span> <span class="n">to_set</span><span class="p">(</span><span class="n">fail_inp</span><span class="p">)</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">minimize_fail</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">mode</span>
        <span class="n">maximize_pass</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">mode</span>

        <span class="c1"># Validate inputs</span>
        <span class="k">if</span> <span class="n">test</span><span class="p">(</span><span class="n">c_pass</span><span class="p">)</span> <span class="o">==</span> <span class="n">FAIL</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">maximize_pass</span><span class="p">:</span>
                <span class="n">s_pass</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">from_set</span><span class="p">(</span><span class="n">c_pass</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">))</span>
                <span class="k">raise</span> <span class="n">NotPassingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Input </span><span class="si">{</span><span class="n">s_pass</span><span class="si">}</span><span class="s2"> expected to pass, but fails&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ret</span><span class="p">(</span><span class="n">c_pass</span><span class="p">,</span> <span class="n">c_pass</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">test</span><span class="p">(</span><span class="n">c_fail</span><span class="p">)</span> <span class="o">==</span> <span class="n">PASS</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">minimize_fail</span><span class="p">:</span>
                <span class="n">s_fail</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">from_set</span><span class="p">(</span><span class="n">c_fail</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">))</span>
                <span class="k">raise</span> <span class="n">NotFailingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Input </span><span class="si">{</span><span class="n">s_fail</span><span class="si">}</span><span class="s2"> expected to fail, but passes&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ret</span><span class="p">(</span><span class="n">c_fail</span><span class="p">,</span> <span class="n">c_fail</span><span class="p">)</span>

        <span class="c1"># Main loop</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Passing input:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">from_set</span><span class="p">(</span><span class="n">c_pass</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">)))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failing input:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">from_set</span><span class="p">(</span><span class="n">c_fail</span><span class="p">,</span> <span class="n">fail_inp</span><span class="p">)))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Granularity:  &quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

            <span class="n">delta</span> <span class="o">=</span> <span class="n">c_fail</span> <span class="o">-</span> <span class="n">c_pass</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ret</span><span class="p">(</span><span class="n">c_pass</span><span class="p">,</span> <span class="n">c_fail</span><span class="p">)</span>

            <span class="n">deltas</span> <span class="o">=</span> <span class="n">split</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

            <span class="n">reduction_found</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
                <span class="n">next_c_pass</span> <span class="o">=</span> <span class="n">c_pass</span> <span class="o">|</span> <span class="n">deltas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">next_c_fail</span> <span class="o">=</span> <span class="n">c_fail</span> <span class="o">-</span> <span class="n">deltas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">minimize_fail</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">test</span><span class="p">(</span><span class="n">next_c_pass</span><span class="p">)</span> <span class="o">==</span> <span class="n">FAIL</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reduce to subset&quot;</span><span class="p">)</span>
                    <span class="n">c_fail</span> <span class="o">=</span> <span class="n">next_c_pass</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="n">i</span>  <span class="c1"># was offset = 0 in original dd()</span>
                    <span class="n">reduction_found</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

                <span class="k">elif</span> <span class="n">maximize_pass</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">test</span><span class="p">(</span><span class="n">next_c_fail</span><span class="p">)</span> <span class="o">==</span> <span class="n">PASS</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Increase to subset&quot;</span><span class="p">)</span>
                    <span class="n">c_pass</span> <span class="o">=</span> <span class="n">next_c_fail</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="n">i</span>  <span class="c1"># was offset = 0 in original dd()</span>
                    <span class="n">reduction_found</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

                <span class="k">elif</span> <span class="n">minimize_fail</span> <span class="ow">and</span> <span class="n">test</span><span class="p">(</span><span class="n">next_c_fail</span><span class="p">)</span> <span class="o">==</span> <span class="n">FAIL</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reduce to complement&quot;</span><span class="p">)</span>
                    <span class="n">c_fail</span> <span class="o">=</span> <span class="n">next_c_fail</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="n">reduction_found</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

                <span class="k">elif</span> <span class="n">maximize_pass</span> <span class="ow">and</span> <span class="n">test</span><span class="p">(</span><span class="n">next_c_pass</span><span class="p">)</span> <span class="o">==</span> <span class="n">PASS</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Increase to complement&quot;</span><span class="p">)</span>
                    <span class="n">c_pass</span> <span class="o">=</span> <span class="n">next_c_pass</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="n">reduction_found</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># choose next subset</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">reduction_found</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No reduction found&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">ret</span><span class="p">(</span><span class="n">c_pass</span><span class="p">,</span> <span class="n">c_fail</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Increase granularity&quot;</span><span class="p">)</span>

                <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>By default, <code>dd()</code> minimizes inputs – just like <code>ddmin()</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Its output is a triple of maximized passing input (if wanted), minimized failing input, and difference. Here is this triple for <code>mystery()</code>, just as with <code>ddmin()</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mystery_pass</span><span class="p">,</span> <span class="n">mystery_fail</span><span class="p">,</span> <span class="n">mystery_diff</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">dd</span><span class="p">(</span><span class="s1">&#39;inp&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="n">failing_input</span><span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The first element (<code>mystery_pass</code>) is the maximal passing input:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mystery_pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The second element (<code>mystery_fail</code>) is the minimal failing input:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mystery_fail</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;()&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And the third element (<code>mystery_diff</code>) is the difference between the two:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mystery_diff</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;()&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>(Note that we will introduce more comfortable APIs later.)</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can follow the operation of <code>dd()</code> by increasing the logging level. We see how with every test, the difference between the passing and the failing input gets smaller and smaller.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">dd</span><span class="p">(</span><span class="s1">&#39;inp&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="n">failing_input</span><span class="p">})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Test #1 mystery(inp=&#39;&#39;): PASS
Test #2 mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Passing input: &#39;&#39;
Failing input: &#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;
Granularity:   2
Test #3 mystery(inp=&#39;V&#34;/+!aF-(V4EO&#39;): PASS
Test #4 mystery(inp=&#39;z*+s/Q,7)2@0_&#39;): PASS
No reduction found
Increase granularity
Passing input: &#39;&#39;
Failing input: &#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;
Granularity:   4
Test #5 mystery(inp=&#39;-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;-(V4EOz*+s/Q,7)2@0_&#39;
Granularity:   3
Test #6 mystery(inp=&#39;*+s/Q,7)2@0_&#39;): PASS
Test #7 mystery(inp=&#39;-(V4EOz7)2@0_&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;-(V4EOz7)2@0_&#39;
Granularity:   2
Test #8 mystery(inp=&#39;7)2@0_&#39;): PASS
Test #9 mystery(inp=&#39;-(V4EOz&#39;): PASS
No reduction found
Increase granularity
Passing input: &#39;&#39;
Failing input: &#39;-(V4EOz7)2@0_&#39;
Granularity:   4
Test #10 mystery(inp=&#39;-(V47)2@0_&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;-(V47)2@0_&#39;
Granularity:   3
Test #11 mystery(inp=&#39;-(V4@0_&#39;): PASS
Test #12 mystery(inp=&#39;-(V47)2&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;-(V47)2&#39;
Granularity:   2
Test #13 mystery(inp=&#39;-7)2&#39;): PASS
Test #14 mystery(inp=&#39;(V4&#39;): PASS
No reduction found
Increase granularity
Passing input: &#39;&#39;
Failing input: &#39;-(V47)2&#39;
Granularity:   4
Test #15 mystery(inp=&#39;-47)2&#39;): PASS
Test #16 mystery(inp=&#39;-(V7)2&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;-(V7)2&#39;
Granularity:   3
Test #17 mystery(inp=&#39;-(V2&#39;): PASS
Test #18 mystery(inp=&#39;(V7)&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;(V7)&#39;
Granularity:   2
Test #19 mystery(inp=&#39;7)&#39;): PASS
Test #20 mystery(inp=&#39;(V&#39;): PASS
No reduction found
Increase granularity
Passing input: &#39;&#39;
Failing input: &#39;(V7)&#39;
Granularity:   4
Test #21 mystery(inp=&#39;(7)&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;(7)&#39;
Granularity:   3
Test #22 mystery(inp=&#39;()&#39;): FAIL (ValueError: Invalid input)
Reduce to complement
Passing input: &#39;&#39;
Failing input: &#39;()&#39;
Granularity:   2
Test #23 mystery(inp=&#39;)&#39;): PASS
Test #24 mystery(inp=&#39;(&#39;): PASS
No reduction found
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>(&#39;&#39;, &#39;()&#39;, &#39;()&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Processing-Multiple-Arguments">Processing Multiple Arguments<a class="anchor-link" href="#Processing-Multiple-Arguments">&#182;</a></h4><p>What happens if a function has multiple arguments? First, we check if they are <em>reducible</em> – that is, they provide a <code>len()</code> length function and a way to access indexed elements. This holds for all strings and all lists, as well as other ordered collections.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_reducible</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="c1"># Return True if `value` supports len() and indexing.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our method <code>process_args()</code> processes recorded call arguments, one after the one, until all are minimized or maximized. Processing them individually (rather than, say, all at once) allows to maintain a stable <em>context</em> during reduction.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This method also does all the housekeeping, checking arguments and results, and raising errors if need be.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">FailureNotReproducedError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">DeltaDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">check_reproducibility</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Check whether running the function again fails</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(),</span> \
            <span class="s2">&quot;No call collected. Use `with dd: func()` first.&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">(),</span> \
            <span class="s2">&quot;No arguments collected. Use `with dd: func(args)` first.&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">UNRESOLVED</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FailureNotReproducedError</span><span class="p">(</span>
                <span class="s2">&quot;When called again, &quot;</span> <span class="o">+</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">())</span> <span class="o">+</span> 
                <span class="s2">&quot; raised &quot;</span> <span class="o">+</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">format_exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_exception</span><span class="p">)</span> <span class="o">+</span>
                <span class="s2">&quot; instead of &quot;</span> <span class="o">+</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">format_exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">()))</span>

        <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">PASS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFailingError</span><span class="p">(</span><span class="s2">&quot;When called again, &quot;</span> <span class="o">+</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">())</span> <span class="o">+</span> 
                                  <span class="s2">&quot; did not fail&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">outcome</span> <span class="o">==</span> <span class="n">FAIL</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">DeltaDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">process_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">**</span><span class="n">strategy_args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> \
        <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduce all reducible arguments, using `strategy`(var, `strategy_args`).</span>
<span class="sd">        Can be overloaded in subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pass_args</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Local copy</span>
        <span class="n">fail_args</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Local copy</span>
        <span class="n">diff_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">():</span>
            <span class="n">fail_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">()[</span><span class="n">var</span><span class="p">]</span>
            <span class="n">diff_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">()[</span><span class="n">var</span><span class="p">]</span>
            <span class="n">pass_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">()[</span><span class="n">var</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">is_reducible</span><span class="p">(</span><span class="n">pass_args</span><span class="p">[</span><span class="n">var</span><span class="p">]):</span>
                <span class="n">pass_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">pass_args</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>

        <span class="n">vars_to_be_processed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fail_args</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">pass_processed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fail_processed</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_reproducibility</span><span class="p">()</span>

        <span class="c1"># We take turns in processing variables until all are processed</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">vars_to_be_processed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">vars_to_be_processed</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_reducible</span><span class="p">(</span><span class="n">fail_args</span><span class="p">[</span><span class="n">var</span><span class="p">]):</span>
                    <span class="n">vars_to_be_processed</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                    <span class="k">break</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

                <span class="n">maximized_pass_value</span><span class="p">,</span> <span class="n">minimized_fail_value</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> \
                    <span class="n">strategy</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">fail_args</span><span class="p">,</span> <span class="o">**</span><span class="n">strategy_args</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">maximized_pass_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> 
                    <span class="nb">len</span><span class="p">(</span><span class="n">maximized_pass_value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">pass_args</span><span class="p">[</span><span class="n">var</span><span class="p">])):</span>
                    <span class="n">pass_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">maximized_pass_value</span>
                    <span class="c1"># FIXME: diff_args may not be correct for multiple args</span>
                    <span class="n">diff_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximized </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> to&quot;</span><span class="p">,</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">maximized_pass_value</span><span class="p">))</span>
                    <span class="n">vars_to_be_processed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fail_args</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="n">pass_processed</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">minimized_fail_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> 
                    <span class="nb">len</span><span class="p">(</span><span class="n">minimized_fail_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fail_args</span><span class="p">[</span><span class="n">var</span><span class="p">])):</span>
                    <span class="n">fail_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">minimized_fail_value</span>
                    <span class="n">diff_args</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimized </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> to&quot;</span><span class="p">,</span>
                              <span class="nb">repr</span><span class="p">(</span><span class="n">minimized_fail_value</span><span class="p">))</span>
                    <span class="n">vars_to_be_processed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fail_args</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="n">fail_processed</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">vars_to_be_processed</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="k">assert</span> <span class="n">pass_processed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">pass_args</span><span class="p">)</span> <span class="o">==</span> <span class="n">PASS</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="n">pass_args</span><span class="p">)</span><span class="si">}</span><span class="s2"> does not pass&quot;</span>
        <span class="k">assert</span> <span class="n">fail_processed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">fail_args</span><span class="p">)</span> <span class="o">==</span> <span class="n">FAIL</span><span class="p">,</span> \
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="n">fail_args</span><span class="p">)</span><span class="si">}</span><span class="s2"> does not fail&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="ow">and</span> <span class="n">pass_processed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximized passing call to&quot;</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="n">pass_args</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="ow">and</span> <span class="n">fail_processed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimized failing call to&quot;</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="n">fail_args</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">pass_args</span><span class="p">,</span> <span class="n">fail_args</span><span class="p">,</span> <span class="n">diff_args</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>For more housekeeping, we define the <code>after_collection()</code> method that will be invoked at the end of the <code>with</code> block. It checks for a number of additional preconditions.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">DeltaDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">after_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Some post-collection checks</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NoCallError</span><span class="p">(</span><span class="s2">&quot;No function call observed&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFailingError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">()</span><span class="si">}</span><span class="s2"> did not raise an exception&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observed </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span>
                  <span class="sa">f</span><span class="s2">&quot; raising </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_exception</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exception</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Public-API">Public API<a class="anchor-link" href="#Public-API">&#182;</a></h4><p>We finish the implementation with public methods that allow users to run delta debugging and obtain the diagnostics.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">DeltaDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">min_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return 1-minimal arguments.&quot;&quot;&quot;</span>
        <span class="n">pass_args</span><span class="p">,</span> <span class="n">fail_args</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dd</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fail_args</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">DeltaDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">max_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return 1-maximal arguments.&quot;&quot;&quot;</span>
        <span class="n">pass_args</span><span class="p">,</span> <span class="n">fail_args</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dd</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pass_args</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">DeltaDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">min_arg_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Return 1-minimal difference between arguments.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dd</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;+-&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>__repr__()</code> method returns a string representation of the minimized call.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DeltaDebugger</span><span class="p">(</span><span class="n">DeltaDebugger</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a string representation of the minimized call.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_args</span><span class="p">())</span>
</pre></div>

</div>
</div></div>
</div>
</div>

</details>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To see how the <code>DeltaDebugger</code> works, let us run it on our failing input. The expected usage is as introduced earlier – we wrap the failing function in a <code>with</code> block, and then print out the debugger to see the reduced arguments. We see that <code>DeltaDebugger</code> easily reduces the arguments to the minimal failure-inducing input:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
<span class="n">dd</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>mystery(inp=&#39;()&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can turn on logging for <code>DeltaDebugger</code> to see how it proceeds. With each step, we see how the remaining input gets smaller and smaller, until only two characters remain:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
<span class="n">dd</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;) raising ValueError: Invalid input
Test #1 mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Processing inp...
Test #2 mystery(inp=&#39;&#39;): PASS
Test #3 mystery(inp=&#39;V&#34;/+!aF-(V4EO&#39;): PASS
Test #4 mystery(inp=&#39;z*+s/Q,7)2@0_&#39;): PASS
Test #5 mystery(inp=&#39;-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #6 mystery(inp=&#39;*+s/Q,7)2@0_&#39;): PASS
Test #7 mystery(inp=&#39;-(V4EOz7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #8 mystery(inp=&#39;7)2@0_&#39;): PASS
Test #9 mystery(inp=&#39;-(V4EOz&#39;): PASS
Test #10 mystery(inp=&#39;-(V47)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #11 mystery(inp=&#39;-(V4@0_&#39;): PASS
Test #12 mystery(inp=&#39;-(V47)2&#39;): FAIL (ValueError: Invalid input)
Test #13 mystery(inp=&#39;-7)2&#39;): PASS
Test #14 mystery(inp=&#39;(V4&#39;): PASS
Test #15 mystery(inp=&#39;-47)2&#39;): PASS
Test #16 mystery(inp=&#39;-(V7)2&#39;): FAIL (ValueError: Invalid input)
Test #17 mystery(inp=&#39;-(V2&#39;): PASS
Test #18 mystery(inp=&#39;(V7)&#39;): FAIL (ValueError: Invalid input)
Test #19 mystery(inp=&#39;7)&#39;): PASS
Test #20 mystery(inp=&#39;(V&#39;): PASS
Test #21 mystery(inp=&#39;(7)&#39;): FAIL (ValueError: Invalid input)
Test #22 mystery(inp=&#39;()&#39;): FAIL (ValueError: Invalid input)
Test #23 mystery(inp=&#39;)&#39;): PASS
Test #24 mystery(inp=&#39;(&#39;): PASS
Minimized inp to &#39;()&#39;
Minimized failing call to mystery(inp=&#39;()&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>mystery(inp=&#39;()&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>It is also possible to access the debugger programmatically:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">args</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;inp&#39;: &#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;}
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;inp&#39;: &#39;()&#39;}
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">What happens if the function under test does not raise an exception?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="1c9f93a0-2c19-11ec-8cbd-acde48001122" id="1c9f93a0-2c19-11ec-8cbd-acde48001122-1" onclick="clear_selection('1c9f93a0-2c19-11ec-8cbd-acde48001122')">
        <label id="1c9f93a0-2c19-11ec-8cbd-acde48001122-1-label" for="1c9f93a0-2c19-11ec-8cbd-acde48001122-1">Delta debugging searches for the minimal input that produces the same result</label><br>

        <input type="radio" name="1c9f93a0-2c19-11ec-8cbd-acde48001122" id="1c9f93a0-2c19-11ec-8cbd-acde48001122-2" onclick="clear_selection('1c9f93a0-2c19-11ec-8cbd-acde48001122')">
        <label id="1c9f93a0-2c19-11ec-8cbd-acde48001122-2-label" for="1c9f93a0-2c19-11ec-8cbd-acde48001122-2">Delta debugging starts a fuzzer to find an exception</label><br>

        <input type="radio" name="1c9f93a0-2c19-11ec-8cbd-acde48001122" id="1c9f93a0-2c19-11ec-8cbd-acde48001122-3" onclick="clear_selection('1c9f93a0-2c19-11ec-8cbd-acde48001122')">
        <label id="1c9f93a0-2c19-11ec-8cbd-acde48001122-3-label" for="1c9f93a0-2c19-11ec-8cbd-acde48001122-3">Delta debugging raises an exceptionDelta debugging runs forever in a loop</label><br>

    </div>
    </p>
    <input id="1c9f93a0-2c19-11ec-8cbd-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('1c9f93a0-2c19-11ec-8cbd-acde48001122', 8, 0, '0 ** 0 + 1 ** 0 + 0 ** 1 + 1 ** 1')">
    <span class="quiz_hint" id="1c9f93a0-2c19-11ec-8cbd-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Indeed, <code>DeltaDebugger</code> checks if an exception occurs. If not, you obtain a <code>NotFailingError</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="n">NotFailingError</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
        <span class="n">mystery</span><span class="p">(</span><span class="s2">&quot;An input that does not fail&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/3784387889.py&#34;, line 3, in &lt;module&gt;
    mystery(&#34;An input that does not fail&#34;)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4114738534.py&#34;, line 24, in __exit__
    self.after_collection()
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/1934034330.py&#34;, line 7, in after_collection
    raise NotFailingError(
NotFailingError: mystery(inp=&#39;An input that does not fail&#39;) did not raise an exception (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Delta Debugging also assumes that the function under test is <em>deterministic</em>. If it occasionally fails and occasionally passes, you will get random results.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Usage-Examples">Usage Examples<a class="anchor-link" href="#Usage-Examples">&#182;</a></h2><p>Let us apply <code>DeltaDebugger</code> on a number of examples.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Reducing-remove_html_markup()">Reducing remove_html_markup()<a class="anchor-link" href="#Reducing-remove_html_markup()">&#182;</a></h3><p>For our ongoing <code>remove_html_markup()</code> example, we can reduce the failure-inducing input to a minimum, too:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Assertions.html" class="import" target="_blank">Assertions</a></span> <span class="kn">import</span> <span class="n">remove_html_markup</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">remove_html_markup</span><span class="p">(</span><span class="s1">&#39;&quot;x &gt; y&quot;&#39;</span><span class="p">)</span>
<span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed remove_html_markup(s=&#39;&#34;x &gt; y&#34;&#39;) raising AssertionError
Test #1 remove_html_markup(s=&#39;&#34;x &gt; y&#34;&#39;): FAIL (AssertionError)
Processing s...
Test #2 remove_html_markup(s=&#39;&#39;): PASS
Test #3 remove_html_markup(s=&#39;&#34;x &gt;&#39;): FAIL (AssertionError)
Test #4 remove_html_markup(s=&#39;&#34;x&#39;): PASS
Test #5 remove_html_markup(s=&#39; &gt;&#39;): PASS
Test #6 remove_html_markup(s=&#39;x &gt;&#39;): PASS
Test #7 remove_html_markup(s=&#39;&#34; &gt;&#39;): FAIL (AssertionError)
Test #8 remove_html_markup(s=&#39;&#34;&gt;&#39;): FAIL (AssertionError)
Test #9 remove_html_markup(s=&#39;&gt;&#39;): PASS
Test #10 remove_html_markup(s=&#39;&#34;&#39;): PASS
Minimized s to &#39;&#34;&gt;&#39;
Minimized failing call to remove_html_markup(s=&#39;&#34;&gt;&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;s&#39;: &#39;&#34;&gt;&#39;}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Reducing-Multiple-Arguments">Reducing Multiple Arguments<a class="anchor-link" href="#Reducing-Multiple-Arguments">&#182;</a></h3><p>If a function has multiple reducible variables, they get reduced in turns. This <code>string_error()</code> function fails whenever <code>s1</code> is a substring of <code>s2</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">string_error</span><span class="p">(</span><span class="n">s1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s2</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">s1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s2</span><span class="p">,</span> <span class="s2">&quot;no substrings&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Running <code>DeltaDebugger</code> on <code>string_error</code> shows how first <code>s1</code> is reduced, then <code>s2</code>, then <code>s1</code> again.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">string_error</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;foobar&quot;</span><span class="p">)</span>

<span class="n">string_error_args</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()</span>
<span class="n">string_error_args</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed string_error(s1=&#39;foo&#39;, s2=&#39;foobar&#39;) raising AssertionError: no substrings
Test #1 string_error(s1=&#39;foo&#39;, s2=&#39;foobar&#39;): FAIL (AssertionError: no substrings)
Processing s2...
Test #2 string_error(s1=&#39;foo&#39;, s2=&#39;&#39;): PASS
Test #3 string_error(s1=&#39;foo&#39;, s2=&#39;foo&#39;): FAIL (AssertionError: no substrings)
Test #4 string_error(s1=&#39;foo&#39;, s2=&#39;fo&#39;): PASS
Test #5 string_error(s1=&#39;foo&#39;, s2=&#39;o&#39;): PASS
Test #6 string_error(s1=&#39;foo&#39;, s2=&#39;oo&#39;): PASS
Minimized s2 to &#39;foo&#39;
Processing s1...
Test #7 string_error(s1=&#39;&#39;, s2=&#39;foo&#39;): FAIL (AssertionError: no substrings)
Minimized s1 to &#39;&#39;
Processing s2...
Test #8 string_error(s1=&#39;&#39;, s2=&#39;&#39;): FAIL (AssertionError: no substrings)
Minimized s2 to &#39;&#39;
Minimized failing call to string_error(s1=&#39;&#39;, s2=&#39;&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>{&#39;s1&#39;: &#39;&#39;, &#39;s2&#39;: &#39;&#39;}
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that the failure also occurs if both strings are empty:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">string_error</span><span class="p">(</span><span class="n">string_error_args</span><span class="p">[</span><span class="s1">&#39;s1&#39;</span><span class="p">],</span> <span class="n">string_error_args</span><span class="p">[</span><span class="s1">&#39;s2&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/3257360882.py&#34;, line 2, in &lt;module&gt;
    string_error(string_error_args[&#39;s1&#39;], string_error_args[&#39;s2&#39;])
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/773514021.py&#34;, line 2, in string_error
    assert s1 not in s2, &#34;no substrings&#34;
AssertionError: no substrings (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Invoking-an-Interactive-Debugger">Invoking an Interactive Debugger<a class="anchor-link" href="#Invoking-an-Interactive-Debugger">&#182;</a></h3><p>The results from delta debugging can be immediately used to invoke an nvoke an <a href="Debugger">interactive debugger</a> on the minimized input. To this end, we need to turn the dictionary returned by <code>min_args()</code> into a arguments of the (failing) function call.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Python provides a simple way to turn dictionaries into function calls. The construct</p>
<div class="highlight"><pre><span></span><span class="n">fun</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
</pre></div>
<p>invokes the function <code>fun</code>, with all parameters assigned from the respective values in the dictionary.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With this, we can immediately invoke a <code>Debugger</code> on the failing run with minimized arguments:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Debugger.html" class="import" target="_blank">Debugger</a></span> <span class="kn">import</span> <span class="n">Debugger</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;print&#39;, &#39;quit&#39;]
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">Debugger</span><span class="p">():</span>
        <span class="n">string_error</span><span class="p">(</span><span class="o">**</span><span class="n">string_error_args</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Calling string_error(s1 = &#39;&#39;, s2 = &#39;&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>print</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>s1 = &#39;&#39;
s2 = &#39;&#39;
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea ">

<samp>(debugger) <b>quit</b></samp>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2680174709.py&#34;, line 3, in &lt;module&gt;
    string_error(**string_error_args)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/773514021.py&#34;, line 2, in string_error
    assert s1 not in s2, &#34;no substrings&#34;
AssertionError: no substrings (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Reducing-other-Collections">Reducing other Collections<a class="anchor-link" href="#Reducing-other-Collections">&#182;</a></h3><p>Our <code>DeltaDebugger</code> is not limited to strings. It can reduce any argument <code>x</code> for which a <code>len(x)</code> operation and an indexing operation <code>x[i]</code> is defined – notably lists. Here is how to apply <code>DeltaDebugger</code> on a list:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">list_error</span><span class="p">(</span><span class="n">l1</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">l2</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">maxlen</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">maxlen</span><span class="p">,</span> <span class="s2">&quot;invalid string length&quot;</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">list_error</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">l2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">dd</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>list_error(l1=[], l2=[], maxlen=5)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Debugging-Inputs">Debugging Inputs<a class="anchor-link" href="#Debugging-Inputs">&#182;</a></h2><p>Sometimes, it may be useful to not <em>minimize</em> the input, but rather <em>maximize</em> it – that is, to find the <em>maximum</em> input that does <em>not</em> fail. For instance, you may have an input of which you want to <em>preserve</em> as much as possible – to repair it, or to establish a <em>context</em> that is as close as possible to the real input.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is possible by using the <code>max_arg()</code> method. It implements the <code>ddmax</code> variant of the general Delta Debugging algorithm [<a href="https://publications.cispa.saarland/3060/">Kirschner <em>et al</em>, 2020</a>]. With each step, it tries to add more and more characters to the passing input until it is <em>1-maximal</em> – that is, any additional character that would be added from the failing input also would cause the function to fail.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
<span class="n">max_passing_input</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">max_args</span><span class="p">()[</span><span class="s1">&#39;inp&#39;</span><span class="p">]</span>
<span class="n">max_passing_input</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;) raising ValueError: Invalid input
Test #1 mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Processing inp...
Test #2 mystery(inp=&#39;&#39;): PASS
Test #3 mystery(inp=&#39;z*+s/Q,7)2@0_&#39;): PASS
Test #4 mystery(inp=&#39;-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #5 mystery(inp=&#39;V&#34;/+!aFz*+s/Q,7)2@0_&#39;): PASS
Test #6 mystery(inp=&#39;V&#34;/+!aF4EOz*+s/Q,7)2@0_&#39;): PASS
Test #7 mystery(inp=&#39;V&#34;/+!aF-4EOz*+s/Q,7)2@0_&#39;): PASS
Test #8 mystery(inp=&#39;V&#34;/+!aF-V4EOz*+s/Q,7)2@0_&#39;): PASS
Maximized inp to &#39;V&#34;/+!aF-V4EOz*+s/Q,7)2@0_&#39;
Maximized passing call to mystery(inp=&#39;V&#34;/+!aF-V4EOz*+s/Q,7)2@0_&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;V&#34;/+!aF-V4EOz*+s/Q,7)2@0_&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Note that this is precisely the failure-inducing input <em>except</em> for the first parenthesis. Adding this single character would cause the input to cause a failure.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Failure-Inducing-Differences">Failure-Inducing Differences<a class="anchor-link" href="#Failure-Inducing-Differences">&#182;</a></h2></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If one wants to look for <em>differences</em> that distinguish passing from failing runs, Delta Debugging also has a direct method for this – by both maximizing the passing input and minimizing the failing input until they meet somewhere in the middle. The remaining difference is what makes the difference between passing and failing.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To compute the failure-inducing differences for <code>mystery()</code>, use the <code>min_arg_diff()</code> method:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">mystery</span><span class="p">(</span><span class="n">failing_input</span><span class="p">)</span>
<span class="n">max_passing_args</span><span class="p">,</span> <span class="n">min_failing_args</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_arg_diff</span><span class="p">()</span>
<span class="n">max_passing_args</span><span class="p">[</span><span class="s1">&#39;inp&#39;</span><span class="p">],</span> <span class="n">min_failing_args</span><span class="p">[</span><span class="s1">&#39;inp&#39;</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="s1">&#39;inp&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;) raising ValueError: Invalid input
Test #1 mystery(inp=&#39;V&#34;/+!aF-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Processing inp...
Test #2 mystery(inp=&#39;&#39;): PASS
Test #3 mystery(inp=&#39;V&#34;/+!aF-(V4EO&#39;): PASS
Test #4 mystery(inp=&#39;z*+s/Q,7)2@0_&#39;): PASS
Test #5 mystery(inp=&#39;V&#34;/+!aFz*+s/Q,7)2@0_&#39;): PASS
Test #6 mystery(inp=&#39;-(V4EOz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #7 mystery(inp=&#39;-(Vz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #8 mystery(inp=&#39;(Vz*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Test #9 mystery(inp=&#39;(z*+s/Q,7)2@0_&#39;): FAIL (ValueError: Invalid input)
Maximized inp to &#39;z*+s/Q,7)2@0_&#39;
Minimized inp to &#39;(z*+s/Q,7)2@0_&#39;
Maximized passing call to mystery(inp=&#39;z*+s/Q,7)2@0_&#39;)
Minimized failing call to mystery(inp=&#39;(z*+s/Q,7)2@0_&#39;)
</pre>
</div>

</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>(&#39;z*+s/Q,7)2@0_&#39;, &#39;(z*+s/Q,7)2@0_&#39;, &#39;(&#39;)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Minimizing failure-inducing differences is especially efficient on large inputs, since the number of differences between a passing and a failing input is much smaller than the inputs themselves. Here is the failure-inducing difference as determined by Delta Debugging:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diff</span><span class="p">[</span><span class="s1">&#39;inp&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;(&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Reducing-Program-Code">Reducing Program Code<a class="anchor-link" href="#Reducing-Program-Code">&#182;</a></h2><p>One particularly fun application of reducers is on <em>program code</em>. Technically speaking, program code is just another input to a computation; and we can actually automatically determine which minimum of program code is required to produce a failure, using Delta Debugging. Such minimization of code is typically used as it comes to debugging programs that accept code as their input, such as <em>compilers</em> and <em>interpreters</em>. However, it can also pinpoint failure causes in the (input) code itself.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>As an example, let us apply Delta Debugging on the code from <a href="Assertions.html">the chapter on assertions</a>. You do not need to have read the chapter; the important part is that this chapter provides an implementation of <code>remove_html_markup()</code> that we want to use.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="Assertions.html" class="import" target="_blank">Assertions</a></span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here is the source code of all the chapter; this is several hundred lines long.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/inspect.html" class="import" target="_blank">inspect</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">assertions_source_lines</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">Assertions</span><span class="p">)</span>
<span class="c1"># print_content(&quot;&quot;.join(assertions_source_lines), &quot;.py&quot;)</span>
<span class="n">assertions_source_lines</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&#39;from bookutils import YouTubeVideo\n&#39;,
 &#39;YouTubeVideo(&#34;9mI9sbKFkwU&#34;)\n&#39;,
 &#39;\n&#39;,
 &#39;import bookutils\n&#39;,
 &#39;\n&#39;,
 &#39;from bookutils import quiz\n&#39;,
 &#39;\n&#39;,
 &#39;import Tracer\n&#39;,
 &#39;\n&#39;,
 &#39;from ExpectError import ExpectError\n&#39;]
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">assertions_source_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>552
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can take this code and execute it. Nothing particular should happen here, as our imports only import definitions of functions, classes, and global variables.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compile_and_run</span><span class="p">(</span><span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># To execute &#39;Assertions&#39; in place, we need to define __name__ and __package__</span>
    <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">),</span> <span class="p">{</span><span class="s1">&#39;__name__&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;string&gt;&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;__package__&#39;</span><span class="p">:</span> <span class="s1">&#39;debuggingbook&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Any&#39;</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
                         <span class="s1">&#39;Type&#39;</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span>
                         <span class="s1">&#39;TracebackType&#39;</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">,</span>
                         <span class="s1">&#39;Optional&#39;</span><span class="p">:</span> <span class="n">Optional</span><span class="p">},</span>
         <span class="p">{})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">compile_and_run</span><span class="p">(</span><span class="n">assertions_source_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Assertions.html" class="import" target="_blank">Assertions</a></span> <span class="kn">import</span> <span class="n">remove_html_markup</span>  <span class="c1"># minor dependency</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us add some code to it – a "My Test" assertion that tests that <code>remove_html_markup()</code>, applied on a string with double quotes, should keep these in place:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compile_and_test_html_markup_simple</span><span class="p">(</span><span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">compile_and_run</span><span class="p">(</span><span class="n">lines</span> <span class="o">+</span> 
        <span class="p">[</span>
            <span class="sd">&#39;&#39;&#39;&#39;&#39;&#39;</span><span class="p">,</span>
            <span class="sd">&#39;&#39;&#39;assert remove_html_markup(&#39;&quot;foo&quot;&#39;) == &#39;&quot;foo&quot;&#39;, &quot;My Test&quot;\n&#39;&#39;&#39;</span>
        <span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This assertion fails. (As always, <code>remove_html_markup()</code> is buggy.)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">compile_and_test_html_markup_simple</span><span class="p">(</span><span class="n">assertions_source_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2334363057.py&#34;, line 2, in &lt;module&gt;
    compile_and_test_html_markup_simple(assertions_source_lines)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/1838190689.py&#34;, line 2, in compile_and_test_html_markup_simple
    compile_and_run(lines +
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2075409738.py&#34;, line 3, in compile_and_run
    exec(&#34;&#34;.join(lines), {&#39;__name__&#39;: &#39;&lt;string&gt;&#39;,
  File &#34;&lt;string&gt;&#34;, line 553, in &lt;module&gt;
AssertionError: My Test (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The question we want to address in this section is: Given this assertion, can we automatically determine which part of the <code>Assertions</code> code lines in <code>assertions_source_lines</code> is relevant for producing the failure?</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Reducing-Code-Lines">Reducing Code Lines<a class="anchor-link" href="#Reducing-Code-Lines">&#182;</a></h3><p>Since our <code>Assertions</code> source code comes as a list of lines, we can apply our <code>DeltaDebugger</code> on it. The result will be the list of source lines that is necessary to make the assertion fail.</p>
</div>
</div>
</div>
</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">What will the reduced set of lines contain?</div>
    </p>
    <p>
    <div class="quiz_options" title="Pick a choice.">

        <input type="radio" name="1d111516-2c19-11ec-8cbd-acde48001122" id="1d111516-2c19-11ec-8cbd-acde48001122-1" onclick="clear_selection('1d111516-2c19-11ec-8cbd-acde48001122')">
        <label id="1d111516-2c19-11ec-8cbd-acde48001122-1-label" for="1d111516-2c19-11ec-8cbd-acde48001122-1">All of the source code in the assertions chapter.</label><br>

        <input type="radio" name="1d111516-2c19-11ec-8cbd-acde48001122" id="1d111516-2c19-11ec-8cbd-acde48001122-2" onclick="clear_selection('1d111516-2c19-11ec-8cbd-acde48001122')">
        <label id="1d111516-2c19-11ec-8cbd-acde48001122-2-label" for="1d111516-2c19-11ec-8cbd-acde48001122-2">Only the source code of <code>remove_html_markup()</code></label><br>

        <input type="radio" name="1d111516-2c19-11ec-8cbd-acde48001122" id="1d111516-2c19-11ec-8cbd-acde48001122-3" onclick="clear_selection('1d111516-2c19-11ec-8cbd-acde48001122')">
        <label id="1d111516-2c19-11ec-8cbd-acde48001122-3-label" for="1d111516-2c19-11ec-8cbd-acde48001122-3">Only a subset of <code>remove_html_markup()</code></label><br>

        <input type="radio" name="1d111516-2c19-11ec-8cbd-acde48001122" id="1d111516-2c19-11ec-8cbd-acde48001122-4" onclick="clear_selection('1d111516-2c19-11ec-8cbd-acde48001122')">
        <label id="1d111516-2c19-11ec-8cbd-acde48001122-4-label" for="1d111516-2c19-11ec-8cbd-acde48001122-4">No lines at all.</label><br>

    </div>
    </p>
    <input id="1d111516-2c19-11ec-8cbd-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('1d111516-2c19-11ec-8cbd-acde48001122', 8, 0, '[x for x in range((1 + 1) ** (1 + 1)) if x % (1 + 1) == 1][1]')">
    <span class="quiz_hint" id="1d111516-2c19-11ec-8cbd-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us see what the <code>DeltaDebugger</code> produces.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">compile_and_test_html_markup_simple</span><span class="p">(</span><span class="n">assertions_source_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We get exactly <em>two</em> lines of code:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reduced_lines</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()[</span><span class="s1">&#39;lines&#39;</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">reduced_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>2
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And these are:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">print_content</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">reduced_lines</span><span class="p">),</span> <span class="s2">&quot;.py&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>On these lines, our test actually still fails:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">compile_and_test_html_markup_simple</span><span class="p">(</span><span class="n">reduced_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2457905094.py&#34;, line 2, in &lt;module&gt;
    compile_and_test_html_markup_simple(reduced_lines)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/1838190689.py&#34;, line 2, in compile_and_test_html_markup_simple
    compile_and_run(lines +
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2075409738.py&#34;, line 3, in compile_and_run
    exec(&#34;&#34;.join(lines), {&#39;__name__&#39;: &#39;&lt;string&gt;&#39;,
  File &#34;&lt;string&gt;&#34;, line 3, in &lt;module&gt;
AssertionError: My Test (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This failure may come as a surprise – <code>remove_html_markup()</code> is reduced to a function which does not even return a value. However, this is how it causes our "My Test" assertion to fail: In Python, a function without an explicit <code>return</code> statement returns <code>None</code>. This value is definitely not the string the "My Test" assertion expects, so it fails.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>At the same time, we also have a function <code>test_square_root()</code> which is equally devoid of any meaning – its code line does not even stem from its original implementation. Note, however, how the set of four lines is actually 1-minimal – removing any further line would result in a syntax error.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>To ensure we do not remove code that actually would be necessary for normal behavior, let us add another check – one that checks for the <em>normal</em> functionality of <code>remove_html_markup()</code>. If this one fails (say, after the code has been tampered with too much), it raises an exception – but a <em>different</em> one from the original failure:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compile_and_test_html_markup</span><span class="p">(</span><span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">compile_and_run</span><span class="p">(</span><span class="n">lines</span> <span class="o">+</span>
        <span class="p">[</span>
            <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="sd">&#39;&#39;&#39;if remove_html_markup(&#39;&lt;foo&gt;bar&lt;/foo&gt;&#39;) != &#39;bar&#39;:\n&#39;&#39;&#39;</span><span class="p">,</span>
            <span class="sd">&#39;&#39;&#39;    raise RuntimeError(&quot;Missing functionality&quot;)\n&#39;&#39;&#39;</span><span class="p">,</span>
            <span class="sd">&#39;&#39;&#39;assert remove_html_markup(&#39;&quot;foo&quot;&#39;) == &#39;&quot;foo&quot;&#39;, &quot;My Test&quot;\n&#39;&#39;&#39;</span>
        <span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>On our "reduced" code, we now obtain a different exception.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">():</span>
    <span class="n">compile_and_test_html_markup</span><span class="p">(</span><span class="n">reduced_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/810405118.py&#34;, line 2, in &lt;module&gt;
    compile_and_test_html_markup(reduced_lines)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4067432722.py&#34;, line 2, in compile_and_test_html_markup
    compile_and_run(lines +
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2075409738.py&#34;, line 3, in compile_and_run
    exec(&#34;&#34;.join(lines), {&#39;__name__&#39;: &#39;&lt;string&gt;&#39;,
  File &#34;&lt;string&gt;&#34;, line 4, in &lt;module&gt;
RuntimeError: Missing functionality (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Such an outcome that is different from the original failure causes our <code>DeltaDebugger</code> not treating this as a failure, but rather as a <code>UNRESOLVED</code> outcome, indicating that the test cannot determine whether it passed or failed. The <code>ddmin</code> algorithm treats such unresolved outcomes as if they were passing; hence, the algorithm treats its minimization attempt as unsuccessful.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>How does this change things? When we reduce the <code>Assertions</code> source code with the extended assertions, we now get a different result:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">compile_and_test_html_markup</span><span class="p">(</span><span class="n">assertions_source_lines</span><span class="p">)</span>
<span class="n">reduced_assertions_source_lines</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()[</span><span class="s1">&#39;lines&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our result actually is the source code of <code>remove_html_markup()</code> – and <em>only</em> the source code. This is a success, as Delta Debugging has eliminated all the other parts of the <code>Assertions</code> source code; these neither contribute to the correct functioning of <code>remove_html_markup()</code>, nor to the failure at hand.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">reduced_assertions_source_lines</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>
    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c
    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>All in all, we have reduced the number of relevant lines in <code>Assertions</code> to about 3% of the original source code.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">reduced_assertions_source_lines</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">assertions_source_lines</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>0.025362318840579712
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The astute reader may notice that <code>remove_html_markup()</code>, as shown above, is slightly different from the original version in the <a href="Assertions.html">chapter on assertions</a>. Here's the original version for comparison:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_html_markup_source_lines</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsourcelines</span><span class="p">(</span><span class="n">Assertions</span><span class="o">.</span><span class="n">remove_html_markup</span><span class="p">)</span>
<span class="n">print_content</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">remove_html_markup_source_lines</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-white-fg"># postcondition</span>
    <span class="ansi-blue-fg">assert</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out <span class="ansi-magenta-fg">and</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="output_area">

<div class="output_html rendered_html output_subarea output_execute_result">

    <script>
    var bad_answers = new Map();

    function answer(quiz_id) {
        ans = 0;
        for (i = 1;; i++) {
            checkbox = document.getElementById(quiz_id + "-" + i.toString());
            if (!checkbox)
                break;
            if (checkbox.checked)
                ans |= (1 << i);
        }
        return ans;
    }
    function check_selection(quiz_id, correct_answer, multiple_choice, hint) {
        given_answer = answer(quiz_id);
        if (given_answer == correct_answer)
        {
            document.getElementById(quiz_id + "-submit").value = "Correct!";
            document.getElementById(quiz_id + "-hint").innerHTML = "";

            for (i = 1;; i++) {
                checkbox = document.getElementById(quiz_id + "-" + i.toString());
                label = document.getElementById(quiz_id + "-" + i.toString() + "-label")
                if (!checkbox)
                    break;

                if (checkbox.checked) {
                    label.style.fontWeight = "bold";
                }
                else {
                    label.style.textDecoration = "line-through";
                }
            }
        }
        else 
        {
            document.getElementById(quiz_id + "-submit").value = "Try again";

            if (!bad_answers.has(quiz_id)) {
                bad_answers.set(quiz_id, 1);
            }
            else {
                bad_answers.set(quiz_id, bad_answers.get(quiz_id) + 1);
            }

            if (bad_answers.get(quiz_id) >= 2 && hint.length > 0) {
                document.getElementById(quiz_id + "-hint").innerHTML = 
                    "&nbsp;&nbsp;(Hint: <code>" + hint + "</code>)";
            }

            if (!multiple_choice) {
                for (i = 1;; i++) {
                    checkbox = document.getElementById(quiz_id + "-" + i.toString());
                    label = document.getElementById(quiz_id + "-" + i.toString() + "-label")

                    if (!checkbox)
                        break;
                    if (checkbox.checked) {
                        label.style.textDecoration = "line-through";
                    }
                }
            }
        }
    }
    function clear_selection(quiz_id) {
        document.getElementById(quiz_id + "-submit").value = "Submit";
        document.getElementById(quiz_id + "-hint").innerHTML = "";
    }
    </script>

    <div class="quiz">
    <h3 class="quiz_title">Quiz</h3>
    <p>
    <div class="quiz_question">In the reduced version, what has changed?</div>
    </p>
    <p>
    <div class="quiz_options" title="Check all that apply.">

        <input type="checkbox" name="1d400d30-2c19-11ec-8cbd-acde48001122" id="1d400d30-2c19-11ec-8cbd-acde48001122-1" onclick="clear_selection('1d400d30-2c19-11ec-8cbd-acde48001122')">
        <label id="1d400d30-2c19-11ec-8cbd-acde48001122-1-label" for="1d400d30-2c19-11ec-8cbd-acde48001122-1">Comments are deleted</label><br>

        <input type="checkbox" name="1d400d30-2c19-11ec-8cbd-acde48001122" id="1d400d30-2c19-11ec-8cbd-acde48001122-2" onclick="clear_selection('1d400d30-2c19-11ec-8cbd-acde48001122')">
        <label id="1d400d30-2c19-11ec-8cbd-acde48001122-2-label" for="1d400d30-2c19-11ec-8cbd-acde48001122-2">Blank lines are deleted</label><br>

        <input type="checkbox" name="1d400d30-2c19-11ec-8cbd-acde48001122" id="1d400d30-2c19-11ec-8cbd-acde48001122-3" onclick="clear_selection('1d400d30-2c19-11ec-8cbd-acde48001122')">
        <label id="1d400d30-2c19-11ec-8cbd-acde48001122-3-label" for="1d400d30-2c19-11ec-8cbd-acde48001122-3">Initializations are deleted</label><br>

        <input type="checkbox" name="1d400d30-2c19-11ec-8cbd-acde48001122" id="1d400d30-2c19-11ec-8cbd-acde48001122-4" onclick="clear_selection('1d400d30-2c19-11ec-8cbd-acde48001122')">
        <label id="1d400d30-2c19-11ec-8cbd-acde48001122-4-label" for="1d400d30-2c19-11ec-8cbd-acde48001122-4">The assertion is deleted</label><br>

    </div>
    </p>
    <input id="1d400d30-2c19-11ec-8cbd-acde48001122-submit" type="submit" value="Submit" onclick="check_selection('1d400d30-2c19-11ec-8cbd-acde48001122', 22, 1, '[(1 ** 0 - -1 ** 0) ** n for n in range(0, 3)]')">
    <span class="quiz_hint" id="1d400d30-2c19-11ec-8cbd-acde48001122-hint"></span>
    </div>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Indeed, Delta Debugging has determined all these as being irrelevant for reproducing the failure – and consequently, has deleted them.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Reducing-Code-Characters">Reducing Code Characters<a class="anchor-link" href="#Reducing-Code-Characters">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can reduce the code further by removing individual <em>characters</em> rather than lines. To this end, we convert our (already reduced) <code>remove_html_markup()</code> code into a list of characters.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reduced_assertions_source_characters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">reduced_assertions_source_lines</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reduced_assertions_source_characters</span><span class="p">[:</span><span class="mi">30</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39; &#39;, &#39;r&#39;, &#39;e&#39;, &#39;m&#39;, &#39;o&#39;, &#39;v&#39;, &#39;e&#39;, &#39;_&#39;, &#39;h&#39;, &#39;t&#39;, &#39;m&#39;, &#39;l&#39;, &#39;_&#39;, &#39;m&#39;, &#39;a&#39;, &#39;r&#39;, &#39;k&#39;, &#39;u&#39;, &#39;p&#39;, &#39;(&#39;, &#39;s&#39;, &#39;)&#39;, &#39;:&#39;, &#39; &#39;, &#39; &#39;, &#39;#&#39;, &#39; &#39;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our <code>compile_and_test_html_markup()</code> works (and fails) as before: It still joins the given strings into one and executes them. (Remember that in Python, "characters" are simply strings of length one.)</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">compile_and_test_html_markup</span><span class="p">(</span><span class="n">reduced_assertions_source_characters</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/909985861.py&#34;, line 2, in &lt;module&gt;
    compile_and_test_html_markup(reduced_assertions_source_characters)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/4067432722.py&#34;, line 2, in compile_and_test_html_markup
    compile_and_run(lines +
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2075409738.py&#34;, line 3, in compile_and_run
    exec(&#34;&#34;.join(lines), {&#39;__name__&#39;: &#39;&lt;string&gt;&#39;,
  File &#34;&lt;string&gt;&#34;, line 17, in &lt;module&gt;
AssertionError: My Test (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let's see what Delta Debugging makes of that – and also, how long it takes. The <code>Timer</code> class gives us a simple means to measure time.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="Timer.html" class="import" target="_blank">Timer</a></span> <span class="kn">import</span> <span class="n">Timer</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">compile_and_test_html_markup</span><span class="p">(</span><span class="n">reduced_assertions_source_characters</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Here's the reduced result:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">Timer</span><span class="p">()</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
    <span class="n">further_reduced_assertions_source_characters</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()[</span><span class="s1">&#39;lines&#39;</span><span class="p">]</span>
<span class="n">print_content</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">further_reduced_assertions_source_characters</span><span class="p">),</span> <span class="s2">&quot;.py&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):
    tag=<span class="ansi-blue-fg">False</span>
    quote=<span class="ansi-blue-fg">False</span>
    out=<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>
    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c==<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:tag=<span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">if</span> c==<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:tag=<span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c==<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-magenta-fg">or</span> c==<span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-magenta-fg">and</span> g:<span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:out=out+c
    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>There's a number of observations we can make about this code.</p>
<ul>
<li>All superfluous blanks and even newlines have been removed.</li>
<li>As a curiosity, the initialization of <code>quote</code> and <code>out</code> to <code>""</code> is now merged into a single (semantics-preserving) statement.</li>
<li>The semantics and effect of <code>&lt;</code> and <code>&gt;</code> characters is preserved, as mandated by our <code>RuntimeError</code> check.</li>
<li>Double quotes still have the effect of not being included in the returned value: the remaining <code>quote</code> has no effect.</li>
</ul>
<p>Semantics-wise, this reduced variant still yields the "original" failure; the biggest semantic differences, though, are in the condition and code associated with double quotes – which actually also is the location of the defect to be fixed. This is how reducing code can also point to not only <em>necessary</em> locations, but also <em>defective</em> locations.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Mind you that reducing code is not cheap, and especially not if you remove by characters. It has taken <code>DeltaDebugger</code> several thousand tests to obtain the result above:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">tests</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>1278
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And to do so, it even required <em>several seconds</em>. This may be little for a human, but from a CPU standpoint, this is an enormous effort.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">elapsed_time</span><span class="p">()</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>0.4002148769999998
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Reducing-Syntax-Trees">Reducing Syntax Trees<a class="anchor-link" href="#Reducing-Syntax-Trees">&#182;</a></h3></div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When reducing code (or generally speaking, recursive structures), using a <em>syntactic</em> approach can be a much better alternative to the <em>line-by-line</em> or <em>character-by-character</em> approaches discussed above. The idea is that one represents the input as a <em>tree</em> (rather than a sequence of strings), in which a reducer would work on entire subtrees, deleting or reducing parts of the tree.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We illustrate this concept on <em>syntax trees</em> representing Python code. Python provides us with simple means to interactively convert code into syntax trees (and back again). So, in order to reduce code, we can</p>
<ol>
<li><em>parse</em> the program code into a syntax tree (called <em>abstract syntax tree</em> or <em>AST</em>);</li>
<li>reduce the syntax tree to a minimum, executing it to test reductions; and</li>
<li><em>unparse</em> the tree to obtain textual code again.</li>
</ol>
<p>Since transformations on the AST are much less likely to produce syntax errors, reducing ASTs is much more efficient than reducing program code as text.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In the <a href="Slicer.html">chapter on slicing</a>, we already have seen several examples on how to work with ASTs. In our context, an AST also offers additional possibilities for reducing. Notably, instead of just <em>deleting</em> code fragments, we can also <em>replace</em> them with simpler fragments. For instance, we can replace arithmetic expressions with constants, or conditional statements <code>if cond: body</code> with the associated body <code>body</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us illustrate how this works, again choosing <code>remove_html_markup()</code> as our ongoing example. One more time, we create a function with associated test.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_source</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">remove_html_markup</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">fun_source</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):  <span class="ansi-white-fg"># type: ignore</span>
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#34;</span>

    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> <span class="ansi-magenta-fg">not</span> quote:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag:
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c

    <span class="ansi-white-fg"># postcondition</span>
    <span class="ansi-blue-fg">assert</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out <span class="ansi-magenta-fg">and</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out

    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="From-Code-to-Syntax-Trees">From Code to Syntax Trees<a class="anchor-link" href="#From-Code-to-Syntax-Trees">&#182;</a></h4><p>Let us parse this piece of code into an AST. This is done by the <code>ast.parse()</code> function.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/ast.html" class="import" target="_blank">ast</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_tree</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fun_source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The parsed tree contains the function definition:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://github.com/uds-se/debuggingbook//tree/master/notebooks/shared/bookutils" class="import" target="_blank">bookutils</a></span> <span class="kn">import</span> <span class="n">show_ast</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_ast</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2948pt" height="692pt" viewBox="0.00 0.00 2948.00 692.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 688)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-688 2944,-688 2944,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="518.5" y="-663.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">FunctionDef</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="108" y="-590.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;remove_html_markup&quot;</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 367.17,-632.82 210,-612 206.89,-611.59 203.72,-611.15 200.53,-610.7"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="start" x="227" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arguments</text>
</g>
<!-- 0&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>0--2</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 427.32,-636.09 320,-612 317.07,-611.34 314.08,-610.61 311.07,-609.82"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="start" x="337.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>0--5</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 454.31,-618.51 396.81,-603.7"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="start" x="482.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>0--11</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 543.29,-627.19 526.66,-612.03"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="start" x="581.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;17 -->
<g id="edge17" class="edge">
<title>0--17</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 581,-627.19 593.25,-612.03"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="start" x="903" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">For</text>
</g>
<!-- 0&#45;&#45;23 -->
<g id="edge23" class="edge">
<title>0--23</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 806.28,-611.25 888.75,-599.04"/>
</g>
<!-- 121 -->
<g id="node122" class="node">
<title>121</title>
<text text-anchor="start" x="1558.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assert</text>
</g>
<!-- 0&#45;&#45;121 -->
<g id="edge121" class="edge">
<title>0--121</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 1374.17,-605.71 1550.39,-596.72"/>
</g>
<!-- 138 -->
<g id="node139" class="node">
<title>138</title>
<text text-anchor="start" x="2019.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 0&#45;&#45;138 -->
<g id="edge138" class="edge">
<title>0--138</title>
<path fill="none" stroke="black" d="M565,-647C565,-647 1154.51,-629.34 1626,-612 1769.32,-606.73 1940.19,-599.5 2011.33,-596.45"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="start" x="54" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>2--3</title>
<path fill="none" stroke="black" d="M218.83,-576.68C180.09,-562.98 126.09,-543.89 94.02,-532.55"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="27" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;s&quot;</text>
</g>
<!-- 3&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>3--4</title>
<path fill="none" stroke="black" d="M57.11,-503.7C50.91,-492.85 42.95,-478.92 36.77,-468.1"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="start" x="162" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 5&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>5--6</title>
<path fill="none" stroke="black" d="M338,-575C338,-575 251.79,-546.81 206.33,-531.94"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="start" x="269" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 5&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>5--9</title>
<path fill="none" stroke="black" d="M338,-575C338,-575 324.67,-555.19 314.46,-540.03"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="102" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 6&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>6--7</title>
<path fill="none" stroke="black" d="M171,-503C171,-503 144.72,-483.19 124.59,-468.03"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="179" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 6&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>6--8</title>
<path fill="none" stroke="black" d="M171,-503C171,-503 174.05,-483.19 176.38,-468.03"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="256" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 9&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>9--10</title>
<path fill="none" stroke="black" d="M291.38,-503.7C284.1,-492.85 274.74,-478.92 267.48,-468.1"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="start" x="404" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 11&#45;&#45;12 -->
<g id="edge12" class="edge">
<title>11--12</title>
<path fill="none" stroke="black" d="M499,-575C499,-575 469.29,-555.19 446.54,-540.03"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="start" x="474" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 11&#45;&#45;15 -->
<g id="edge15" class="edge">
<title>11--15</title>
<path fill="none" stroke="black" d="M499,-575C499,-575 502.43,-555.19 505.05,-540.03"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="341" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 12&#45;&#45;13 -->
<g id="edge13" class="edge">
<title>12--13</title>
<path fill="none" stroke="black" d="M414,-503C414,-503 386.19,-483.19 364.9,-468.03"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="426" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 12&#45;&#45;14 -->
<g id="edge14" class="edge">
<title>12--14</title>
<path fill="none" stroke="black" d="M414,-503C414,-503 418.57,-483.19 422.07,-468.03"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="503" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 15&#45;&#45;16 -->
<g id="edge16" class="edge">
<title>15--16</title>
<path fill="none" stroke="black" d="M506.76,-503.7C505.99,-492.85 504.99,-478.92 504.22,-468.1"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="start" x="590" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 17&#45;&#45;18 -->
<g id="edge18" class="edge">
<title>17--18</title>
<path fill="none" stroke="black" d="M617,-575C617,-575 613.19,-555.19 610.27,-540.03"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="start" x="687" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 17&#45;&#45;21 -->
<g id="edge21" class="edge">
<title>17--21</title>
<path fill="none" stroke="black" d="M617,-575C617,-575 656.62,-555.19 686.95,-540.03"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="580" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 18&#45;&#45;19 -->
<g id="edge19" class="edge">
<title>18--19</title>
<path fill="none" stroke="black" d="M609,-503C609,-503 597.95,-483.19 589.5,-468.03"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="657" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 18&#45;&#45;20 -->
<g id="edge20" class="edge">
<title>18--20</title>
<path fill="none" stroke="black" d="M609,-503C609,-503 627.28,-483.19 641.28,-468.03"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="732" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&quot;</text>
</g>
<!-- 21&#45;&#45;22 -->
<g id="edge22" class="edge">
<title>21--22</title>
<path fill="none" stroke="black" d="M723.72,-503.7C725.42,-492.85 727.61,-478.92 729.31,-468.1"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="start" x="862" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 23&#45;&#45;24 -->
<g id="edge24" class="edge">
<title>23--24</title>
<path fill="none" stroke="black" d="M924,-575C924,-575 906.86,-555.19 893.73,-540.03"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<text text-anchor="start" x="937" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 23&#45;&#45;27 -->
<g id="edge27" class="edge">
<title>23--27</title>
<path fill="none" stroke="black" d="M924,-575C924,-575 935.43,-555.19 944.18,-540.03"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<text text-anchor="start" x="1138.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 23&#45;&#45;30 -->
<g id="edge30" class="edge">
<title>23--30</title>
<path fill="none" stroke="black" d="M924,-575C924,-575 1060.11,-543.26 1119.66,-529.38"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="804" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 24&#45;&#45;25 -->
<g id="edge25" class="edge">
<title>24--25</title>
<path fill="none" stroke="black" d="M871,-503C871,-503 845.48,-483.19 825.94,-468.03"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="879" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 24&#45;&#45;26 -->
<g id="edge26" class="edge">
<title>24--26</title>
<path fill="none" stroke="black" d="M871,-503C871,-503 874.05,-483.19 876.38,-468.03"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<text text-anchor="middle" x="954" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;s&quot;</text>
</g>
<!-- 27&#45;&#45;28 -->
<g id="edge28" class="edge">
<title>27--28</title>
<path fill="none" stroke="black" d="M962,-503C962,-503 958.95,-483.19 956.62,-468.03"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<text text-anchor="middle" x="1026" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 27&#45;&#45;29 -->
<g id="edge29" class="edge">
<title>27--29</title>
<path fill="none" stroke="black" d="M962,-503C962,-503 986.38,-483.19 1005.04,-468.03"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<text text-anchor="start" x="1079.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 30&#45;&#45;31 -->
<g id="edge31" class="edge">
<title>30--31</title>
<path fill="none" stroke="black" d="M1156,-503C1156,-503 1136.57,-483.19 1121.7,-468.03"/>
</g>
<!-- 45 -->
<g id="node46" class="node">
<title>45</title>
<text text-anchor="start" x="1164.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 30&#45;&#45;45 -->
<g id="edge45" class="edge">
<title>30--45</title>
<path fill="none" stroke="black" d="M1156,-503C1156,-503 1168.95,-483.19 1178.87,-468.03"/>
</g>
<!-- 51 -->
<g id="node52" class="node">
<title>51</title>
<text text-anchor="start" x="1467.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 30&#45;&#45;51 -->
<g id="edge51" class="edge">
<title>30--51</title>
<path fill="none" stroke="black" d="M1156,-503C1156,-503 1371.85,-467.93 1448.99,-455.39"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<text text-anchor="middle" x="764" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 31&#45;&#45;32 -->
<g id="edge32" class="edge">
<title>31--32</title>
<path fill="none" stroke="black" d="M1071,-436C1071,-436 1066.21,-433.2 1062,-432 948.95,-399.81 912.67,-429.48 800,-396 797.08,-395.13 794.11,-394.06 791.18,-392.88"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<text text-anchor="start" x="817.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 31&#45;&#45;33 -->
<g id="edge33" class="edge">
<title>31--33</title>
<path fill="none" stroke="black" d="M1071,-436C1071,-436 1066.14,-433.42 1062,-432 1001.26,-411.2 928.27,-394.98 884.87,-386.22"/>
</g>
<!-- 40 -->
<g id="node41" class="node">
<title>40</title>
<text text-anchor="start" x="976.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 31&#45;&#45;40 -->
<g id="edge40" class="edge">
<title>31--40</title>
<path fill="none" stroke="black" d="M1071,-436C1071,-436 1044.65,-412.89 1025.5,-396.1"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<text text-anchor="start" x="671" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 33&#45;&#45;34 -->
<g id="edge34" class="edge">
<title>33--34</title>
<path fill="none" stroke="black" d="M832,-359C832,-359 770.91,-342.59 724,-324 721.17,-322.88 718.25,-321.64 715.36,-320.36"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<text text-anchor="middle" x="760" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 33&#45;&#45;37 -->
<g id="edge37" class="edge">
<title>33--37</title>
<path fill="none" stroke="black" d="M832,-359C832,-359 804.57,-339.19 783.58,-324.03"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<text text-anchor="start" x="813" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 33&#45;&#45;38 -->
<g id="edge38" class="edge">
<title>33--38</title>
<path fill="none" stroke="black" d="M832,-359C832,-359 837.71,-339.19 842.09,-324.03"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<text text-anchor="middle" x="652" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 34&#45;&#45;35 -->
<g id="edge35" class="edge">
<title>34--35</title>
<path fill="none" stroke="black" d="M688,-287C688,-287 674.29,-267.19 663.79,-252.03"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<text text-anchor="middle" x="724" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 34&#45;&#45;36 -->
<g id="edge36" class="edge">
<title>34--36</title>
<path fill="none" stroke="black" d="M688,-287C688,-287 701.71,-267.19 712.21,-252.03"/>
</g>
<!-- 39 -->
<g id="node40" class="node">
<title>39</title>
<text text-anchor="middle" x="847" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&lt;&quot;</text>
</g>
<!-- 38&#45;&#45;39 -->
<g id="edge39" class="edge">
<title>38--39</title>
<path fill="none" stroke="black" d="M847,-287.7C847,-276.85 847,-262.92 847,-252.1"/>
</g>
<!-- 41 -->
<g id="node42" class="node">
<title>41</title>
<text text-anchor="middle" x="934" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 40&#45;&#45;41 -->
<g id="edge41" class="edge">
<title>40--41</title>
<path fill="none" stroke="black" d="M998,-359C998,-359 973.62,-339.19 954.96,-324.03"/>
</g>
<!-- 42 -->
<g id="node43" class="node">
<title>42</title>
<text text-anchor="start" x="989" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 40&#45;&#45;42 -->
<g id="edge42" class="edge">
<title>40--42</title>
<path fill="none" stroke="black" d="M998,-359C998,-359 1001.05,-339.19 1003.38,-324.03"/>
</g>
<!-- 43 -->
<g id="node44" class="node">
<title>43</title>
<text text-anchor="middle" x="968" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 42&#45;&#45;43 -->
<g id="edge43" class="edge">
<title>42--43</title>
<path fill="none" stroke="black" d="M1007,-287C1007,-287 992.14,-267.19 980.77,-252.03"/>
</g>
<!-- 44 -->
<g id="node45" class="node">
<title>44</title>
<text text-anchor="middle" x="1051" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 42&#45;&#45;44 -->
<g id="edge44" class="edge">
<title>42--44</title>
<path fill="none" stroke="black" d="M1007,-287C1007,-287 1023.76,-267.19 1036.59,-252.03"/>
</g>
<!-- 46 -->
<g id="node47" class="node">
<title>46</title>
<text text-anchor="start" x="1129" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 45&#45;&#45;46 -->
<g id="edge46" class="edge">
<title>45--46</title>
<path fill="none" stroke="black" d="M1190,-431C1190,-431 1173.24,-411.19 1160.41,-396.03"/>
</g>
<!-- 49 -->
<g id="node50" class="node">
<title>49</title>
<text text-anchor="start" x="1199" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 45&#45;&#45;49 -->
<g id="edge49" class="edge">
<title>45--49</title>
<path fill="none" stroke="black" d="M1190,-431C1190,-431 1206.38,-411.19 1218.92,-396.03"/>
</g>
<!-- 47 -->
<g id="node48" class="node">
<title>47</title>
<text text-anchor="middle" x="1081" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 46&#45;&#45;47 -->
<g id="edge47" class="edge">
<title>46--47</title>
<path fill="none" stroke="black" d="M1141,-359C1141,-359 1118.14,-339.19 1100.65,-324.03"/>
</g>
<!-- 48 -->
<g id="node49" class="node">
<title>48</title>
<text text-anchor="middle" x="1158" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 46&#45;&#45;48 -->
<g id="edge48" class="edge">
<title>46--48</title>
<path fill="none" stroke="black" d="M1141,-359C1141,-359 1147.48,-339.19 1152.43,-324.03"/>
</g>
<!-- 50 -->
<g id="node51" class="node">
<title>50</title>
<text text-anchor="middle" x="1233" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">True</text>
</g>
<!-- 49&#45;&#45;50 -->
<g id="edge50" class="edge">
<title>49--50</title>
<path fill="none" stroke="black" d="M1233,-359.7C1233,-348.85 1233,-334.92 1233,-324.1"/>
</g>
<!-- 52 -->
<g id="node53" class="node">
<title>52</title>
<text text-anchor="start" x="1408.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 51&#45;&#45;52 -->
<g id="edge52" class="edge">
<title>51--52</title>
<path fill="none" stroke="black" d="M1491,-431C1491,-431 1469.29,-411.19 1452.66,-396.03"/>
</g>
<!-- 66 -->
<g id="node67" class="node">
<title>66</title>
<text text-anchor="start" x="1553.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 51&#45;&#45;66 -->
<g id="edge66" class="edge">
<title>51--66</title>
<path fill="none" stroke="black" d="M1491,-431C1491,-431 1524.52,-411.19 1550.19,-396.03"/>
</g>
<!-- 72 -->
<g id="node73" class="node">
<title>72</title>
<text text-anchor="start" x="1964.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 51&#45;&#45;72 -->
<g id="edge72" class="edge">
<title>51--72</title>
<path fill="none" stroke="black" d="M1491,-431C1491,-431 1843.74,-392.95 1945.7,-381.94"/>
</g>
<!-- 53 -->
<g id="node54" class="node">
<title>53</title>
<text text-anchor="middle" x="1305" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 52&#45;&#45;53 -->
<g id="edge53" class="edge">
<title>52--53</title>
<path fill="none" stroke="black" d="M1427,-359C1427,-359 1378.78,-340.59 1341,-324 1338.09,-322.72 1335.06,-321.35 1332.05,-319.97"/>
</g>
<!-- 54 -->
<g id="node55" class="node">
<title>54</title>
<text text-anchor="start" x="1358.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 52&#45;&#45;54 -->
<g id="edge54" class="edge">
<title>52--54</title>
<path fill="none" stroke="black" d="M1427,-359C1427,-359 1412.14,-339.19 1400.77,-324.03"/>
</g>
<!-- 61 -->
<g id="node62" class="node">
<title>61</title>
<text text-anchor="start" x="1451.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 52&#45;&#45;61 -->
<g id="edge61" class="edge">
<title>52--61</title>
<path fill="none" stroke="black" d="M1427,-359C1427,-359 1447.57,-339.19 1463.32,-324.03"/>
</g>
<!-- 55 -->
<g id="node56" class="node">
<title>55</title>
<text text-anchor="start" x="1146" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 54&#45;&#45;55 -->
<g id="edge55" class="edge">
<title>54--55</title>
<path fill="none" stroke="black" d="M1357,-287C1357,-287 1267.05,-275.28 1199,-252 1196.12,-251.02 1193.17,-249.87 1190.26,-248.64"/>
</g>
<!-- 58 -->
<g id="node59" class="node">
<title>58</title>
<text text-anchor="middle" x="1235" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 54&#45;&#45;58 -->
<g id="edge58" class="edge">
<title>54--58</title>
<path fill="none" stroke="black" d="M1357,-287C1357,-287 1308.78,-268.59 1271,-252 1268.09,-250.72 1265.06,-249.35 1262.05,-247.97"/>
</g>
<!-- 59 -->
<g id="node60" class="node">
<title>59</title>
<text text-anchor="start" x="1288" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 54&#45;&#45;59 -->
<g id="edge59" class="edge">
<title>54--59</title>
<path fill="none" stroke="black" d="M1357,-287C1357,-287 1343.67,-267.19 1333.46,-252.03"/>
</g>
<!-- 56 -->
<g id="node57" class="node">
<title>56</title>
<text text-anchor="middle" x="1127" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 55&#45;&#45;56 -->
<g id="edge56" class="edge">
<title>55--56</title>
<path fill="none" stroke="black" d="M1163,-215C1163,-215 1149.29,-195.19 1138.79,-180.03"/>
</g>
<!-- 57 -->
<g id="node58" class="node">
<title>57</title>
<text text-anchor="middle" x="1199" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 55&#45;&#45;57 -->
<g id="edge57" class="edge">
<title>55--57</title>
<path fill="none" stroke="black" d="M1163,-215C1163,-215 1176.71,-195.19 1187.21,-180.03"/>
</g>
<!-- 60 -->
<g id="node61" class="node">
<title>60</title>
<text text-anchor="middle" x="1322" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&gt;&quot;</text>
</g>
<!-- 59&#45;&#45;60 -->
<g id="edge60" class="edge">
<title>59--60</title>
<path fill="none" stroke="black" d="M1322,-215.7C1322,-204.85 1322,-190.92 1322,-180.1"/>
</g>
<!-- 62 -->
<g id="node63" class="node">
<title>62</title>
<text text-anchor="middle" x="1409" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 61&#45;&#45;62 -->
<g id="edge62" class="edge">
<title>61--62</title>
<path fill="none" stroke="black" d="M1473,-287C1473,-287 1448.62,-267.19 1429.96,-252.03"/>
</g>
<!-- 63 -->
<g id="node64" class="node">
<title>63</title>
<text text-anchor="start" x="1464" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 61&#45;&#45;63 -->
<g id="edge63" class="edge">
<title>61--63</title>
<path fill="none" stroke="black" d="M1473,-287C1473,-287 1476.05,-267.19 1478.38,-252.03"/>
</g>
<!-- 64 -->
<g id="node65" class="node">
<title>64</title>
<text text-anchor="middle" x="1439" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 63&#45;&#45;64 -->
<g id="edge64" class="edge">
<title>63--64</title>
<path fill="none" stroke="black" d="M1481,-215C1481,-215 1465,-195.19 1452.75,-180.03"/>
</g>
<!-- 65 -->
<g id="node66" class="node">
<title>65</title>
<text text-anchor="middle" x="1522" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 63&#45;&#45;65 -->
<g id="edge65" class="edge">
<title>63--65</title>
<path fill="none" stroke="black" d="M1481,-215C1481,-215 1496.62,-195.19 1508.58,-180.03"/>
</g>
<!-- 67 -->
<g id="node68" class="node">
<title>67</title>
<text text-anchor="start" x="1562" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 66&#45;&#45;67 -->
<g id="edge67" class="edge">
<title>66--67</title>
<path fill="none" stroke="black" d="M1589,-359C1589,-359 1585.19,-339.19 1582.27,-324.03"/>
</g>
<!-- 70 -->
<g id="node71" class="node">
<title>70</title>
<text text-anchor="start" x="1661" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 66&#45;&#45;70 -->
<g id="edge70" class="edge">
<title>66--70</title>
<path fill="none" stroke="black" d="M1589,-359C1589,-359 1629.38,-339.19 1660.29,-324.03"/>
</g>
<!-- 68 -->
<g id="node69" class="node">
<title>68</title>
<text text-anchor="middle" x="1556" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 67&#45;&#45;68 -->
<g id="edge68" class="edge">
<title>67--68</title>
<path fill="none" stroke="black" d="M1582,-287C1582,-287 1572.1,-267.19 1564.51,-252.03"/>
</g>
<!-- 69 -->
<g id="node70" class="node">
<title>69</title>
<text text-anchor="middle" x="1633" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 67&#45;&#45;69 -->
<g id="edge69" class="edge">
<title>67--69</title>
<path fill="none" stroke="black" d="M1582,-287C1582,-287 1601.43,-267.19 1616.3,-252.03"/>
</g>
<!-- 71 -->
<g id="node72" class="node">
<title>71</title>
<text text-anchor="middle" x="1710" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 70&#45;&#45;71 -->
<g id="edge71" class="edge">
<title>70--71</title>
<path fill="none" stroke="black" d="M1698.71,-287.7C1701.03,-276.85 1704.02,-262.92 1706.33,-252.1"/>
</g>
<!-- 73 -->
<g id="node74" class="node">
<title>73</title>
<text text-anchor="start" x="1880.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 72&#45;&#45;73 -->
<g id="edge73" class="edge">
<title>72--73</title>
<path fill="none" stroke="black" d="M1984,-359C1984,-359 1954.29,-339.19 1931.54,-324.03"/>
</g>
<!-- 94 -->
<g id="node95" class="node">
<title>94</title>
<text text-anchor="start" x="2041.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 72&#45;&#45;94 -->
<g id="edge94" class="edge">
<title>72--94</title>
<path fill="none" stroke="black" d="M1984,-359C1984,-359 2015.62,-339.19 2039.82,-324.03"/>
</g>
<!-- 103 -->
<g id="node104" class="node">
<title>103</title>
<text text-anchor="start" x="2137.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 72&#45;&#45;103 -->
<g id="edge103" class="edge">
<title>72--103</title>
<path fill="none" stroke="black" d="M1984,-359C1984,-359 2054.84,-343.88 2109,-324 2112.19,-322.83 2115.48,-321.5 2118.72,-320.12"/>
</g>
<!-- 74 -->
<g id="node75" class="node">
<title>74</title>
<text text-anchor="middle" x="1785" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Or</text>
</g>
<!-- 73&#45;&#45;74 -->
<g id="edge74" class="edge">
<title>73--74</title>
<path fill="none" stroke="black" d="M1900,-287C1900,-287 1855.92,-267.98 1821,-252 1818.11,-250.68 1815.09,-249.28 1812.09,-247.88"/>
</g>
<!-- 75 -->
<g id="node76" class="node">
<title>75</title>
<text text-anchor="start" x="1838.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 73&#45;&#45;75 -->
<g id="edge75" class="edge">
<title>73--75</title>
<path fill="none" stroke="black" d="M1900,-287C1900,-287 1887.81,-267.19 1878.48,-252.03"/>
</g>
<!-- 82 -->
<g id="node83" class="node">
<title>82</title>
<text text-anchor="start" x="1931.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 73&#45;&#45;82 -->
<g id="edge82" class="edge">
<title>73--82</title>
<path fill="none" stroke="black" d="M1900,-287C1900,-287 1921.71,-267.19 1938.34,-252.03"/>
</g>
<!-- 76 -->
<g id="node77" class="node">
<title>76</title>
<text text-anchor="start" x="1594" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 75&#45;&#45;76 -->
<g id="edge76" class="edge">
<title>75--76</title>
<path fill="none" stroke="black" d="M1830,-216C1830,-216 1725.74,-205.89 1647,-180 1644.11,-179.05 1641.15,-177.92 1638.23,-176.71"/>
</g>
<!-- 79 -->
<g id="node80" class="node">
<title>79</title>
<text text-anchor="middle" x="1683" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 75&#45;&#45;79 -->
<g id="edge79" class="edge">
<title>75--79</title>
<path fill="none" stroke="black" d="M1830,-216C1830,-216 1767.21,-199.11 1719,-180 1716.17,-178.88 1713.25,-177.64 1710.36,-176.36"/>
</g>
<!-- 80 -->
<g id="node81" class="node">
<title>80</title>
<text text-anchor="start" x="1736" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 75&#45;&#45;80 -->
<g id="edge80" class="edge">
<title>75--80</title>
<path fill="none" stroke="black" d="M1830,-216C1830,-216 1806.85,-195.55 1789.31,-180.06"/>
</g>
<!-- 77 -->
<g id="node78" class="node">
<title>77</title>
<text text-anchor="middle" x="1581" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 76&#45;&#45;77 -->
<g id="edge77" class="edge">
<title>76--77</title>
<path fill="none" stroke="black" d="M1612,-143C1612,-143 1600.19,-123.19 1591.15,-108.03"/>
</g>
<!-- 78 -->
<g id="node79" class="node">
<title>78</title>
<text text-anchor="middle" x="1653" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 76&#45;&#45;78 -->
<g id="edge78" class="edge">
<title>76--78</title>
<path fill="none" stroke="black" d="M1612,-143C1612,-143 1627.62,-123.19 1639.58,-108.03"/>
</g>
<!-- 81 -->
<g id="node82" class="node">
<title>81</title>
<text text-anchor="middle" x="1738" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&quot;&quot;</text>
</g>
<!-- 80&#45;&#45;81 -->
<g id="edge81" class="edge">
<title>80--81</title>
<path fill="none" stroke="black" d="M1762.09,-143.7C1757.13,-132.85 1750.76,-118.92 1745.82,-108.1"/>
</g>
<!-- 83 -->
<g id="node84" class="node">
<title>83</title>
<text text-anchor="middle" x="1857" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 82&#45;&#45;83 -->
<g id="edge83" class="edge">
<title>82--83</title>
<path fill="none" stroke="black" d="M1954,-215C1954,-215 1912.72,-192.87 1884.02,-177.48"/>
</g>
<!-- 84 -->
<g id="node85" class="node">
<title>84</title>
<text text-anchor="start" x="1910.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 82&#45;&#45;84 -->
<g id="edge84" class="edge">
<title>82--84</title>
<path fill="none" stroke="black" d="M1954,-215C1954,-215 1948.67,-195.19 1944.58,-180.03"/>
</g>
<!-- 91 -->
<g id="node92" class="node">
<title>91</title>
<text text-anchor="start" x="2006" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 82&#45;&#45;91 -->
<g id="edge91" class="edge">
<title>82--91</title>
<path fill="none" stroke="black" d="M1954,-215C1954,-215 1980.28,-195.19 2000.41,-180.03"/>
</g>
<!-- 85 -->
<g id="node86" class="node">
<title>85</title>
<text text-anchor="start" x="1793" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 84&#45;&#45;85 -->
<g id="edge85" class="edge">
<title>84--85</title>
<path fill="none" stroke="black" d="M1931,-143C1931,-143 1883.37,-124.51 1846,-108 1843.09,-106.72 1840.07,-105.34 1837.06,-103.96"/>
</g>
<!-- 88 -->
<g id="node89" class="node">
<title>88</title>
<text text-anchor="middle" x="1882" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 84&#45;&#45;88 -->
<g id="edge88" class="edge">
<title>84--88</title>
<path fill="none" stroke="black" d="M1931,-143C1931,-143 1912.33,-123.19 1898.04,-108.03"/>
</g>
<!-- 89 -->
<g id="node90" class="node">
<title>89</title>
<text text-anchor="start" x="1935" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 84&#45;&#45;89 -->
<g id="edge89" class="edge">
<title>84--89</title>
<path fill="none" stroke="black" d="M1931,-143C1931,-143 1945.47,-123.19 1956.56,-108.03"/>
</g>
<!-- 86 -->
<g id="node87" class="node">
<title>86</title>
<text text-anchor="middle" x="1774" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 85&#45;&#45;86 -->
<g id="edge86" class="edge">
<title>85--86</title>
<path fill="none" stroke="black" d="M1810,-71C1810,-71 1796.29,-51.19 1785.79,-36.03"/>
</g>
<!-- 87 -->
<g id="node88" class="node">
<title>87</title>
<text text-anchor="middle" x="1846" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 85&#45;&#45;87 -->
<g id="edge87" class="edge">
<title>85--87</title>
<path fill="none" stroke="black" d="M1810,-71C1810,-71 1823.71,-51.19 1834.21,-36.03"/>
</g>
<!-- 90 -->
<g id="node91" class="node">
<title>90</title>
<text text-anchor="middle" x="1969" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;'&quot;</text>
</g>
<!-- 89&#45;&#45;90 -->
<g id="edge90" class="edge">
<title>89--90</title>
<path fill="none" stroke="black" d="M1969,-71.7C1969,-60.85 1969,-46.92 1969,-36.1"/>
</g>
<!-- 92 -->
<g id="node93" class="node">
<title>92</title>
<text text-anchor="middle" x="2059" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 91&#45;&#45;92 -->
<g id="edge92" class="edge">
<title>91--92</title>
<path fill="none" stroke="black" d="M2039,-143C2039,-143 2046.62,-123.19 2052.45,-108.03"/>
</g>
<!-- 93 -->
<g id="node94" class="node">
<title>93</title>
<text text-anchor="middle" x="2134" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 91&#45;&#45;93 -->
<g id="edge93" class="edge">
<title>91--93</title>
<path fill="none" stroke="black" d="M2039,-143C2039,-143 2078.7,-121.27 2106.78,-105.9"/>
</g>
<!-- 95 -->
<g id="node96" class="node">
<title>95</title>
<text text-anchor="start" x="2089" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 94&#45;&#45;95 -->
<g id="edge95" class="edge">
<title>94--95</title>
<path fill="none" stroke="black" d="M2088,-287C2088,-287 2094.86,-267.19 2100.11,-252.03"/>
</g>
<!-- 98 -->
<g id="node99" class="node">
<title>98</title>
<text text-anchor="start" x="2236.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 94&#45;&#45;98 -->
<g id="edge98" class="edge">
<title>94--98</title>
<path fill="none" stroke="black" d="M2088,-287C2088,-287 2176,-261.29 2228.25,-246.03"/>
</g>
<!-- 96 -->
<g id="node97" class="node">
<title>96</title>
<text text-anchor="middle" x="2106" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 95&#45;&#45;96 -->
<g id="edge96" class="edge">
<title>95--96</title>
<path fill="none" stroke="black" d="M2114,-215C2114,-215 2110.95,-195.19 2108.62,-180.03"/>
</g>
<!-- 97 -->
<g id="node98" class="node">
<title>97</title>
<text text-anchor="middle" x="2191" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 95&#45;&#45;97 -->
<g id="edge97" class="edge">
<title>95--97</title>
<path fill="none" stroke="black" d="M2114,-215C2114,-215 2143.33,-195.19 2165.79,-180.03"/>
</g>
<!-- 99 -->
<g id="node100" class="node">
<title>99</title>
<text text-anchor="middle" x="2266" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 98&#45;&#45;99 -->
<g id="edge99" class="edge">
<title>98--99</title>
<path fill="none" stroke="black" d="M2274,-215C2274,-215 2270.95,-195.19 2268.62,-180.03"/>
</g>
<!-- 100 -->
<g id="node101" class="node">
<title>100</title>
<text text-anchor="start" x="2321" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 98&#45;&#45;100 -->
<g id="edge100" class="edge">
<title>98--100</title>
<path fill="none" stroke="black" d="M2274,-215C2274,-215 2298.38,-195.19 2317.04,-180.03"/>
</g>
<!-- 101 -->
<g id="node102" class="node">
<title>101</title>
<text text-anchor="middle" x="2255" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 100&#45;&#45;101 -->
<g id="edge101" class="edge">
<title>100--101</title>
<path fill="none" stroke="black" d="M2330,-143C2330,-143 2301.43,-123.19 2279.56,-108.03"/>
</g>
<!-- 102 -->
<g id="node103" class="node">
<title>102</title>
<text text-anchor="middle" x="2338" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 100&#45;&#45;102 -->
<g id="edge102" class="edge">
<title>100--102</title>
<path fill="none" stroke="black" d="M2330,-143C2330,-143 2333.05,-123.19 2335.38,-108.03"/>
</g>
<!-- 104 -->
<g id="node105" class="node">
<title>104</title>
<text text-anchor="start" x="2380.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 103&#45;&#45;104 -->
<g id="edge104" class="edge">
<title>103--104</title>
<path fill="none" stroke="black" d="M2173,-299C2173,-299 2176.64,-291.34 2182,-288 2198.09,-277.99 2311.74,-254.43 2372.27,-242.38"/>
</g>
<!-- 109 -->
<g id="node110" class="node">
<title>109</title>
<text text-anchor="start" x="2575.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 103&#45;&#45;109 -->
<g id="edge109" class="edge">
<title>103--109</title>
<path fill="none" stroke="black" d="M2173,-299C2173,-299 2176.47,-291.06 2182,-288 2190.46,-283.32 2469.62,-250.35 2567.5,-238.9"/>
</g>
<!-- 105 -->
<g id="node106" class="node">
<title>105</title>
<text text-anchor="middle" x="2410" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 104&#45;&#45;105 -->
<g id="edge105" class="edge">
<title>104--105</title>
<path fill="none" stroke="black" d="M2418,-215C2418,-215 2414.95,-195.19 2412.62,-180.03"/>
</g>
<!-- 106 -->
<g id="node107" class="node">
<title>106</title>
<text text-anchor="start" x="2465" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 104&#45;&#45;106 -->
<g id="edge106" class="edge">
<title>104--106</title>
<path fill="none" stroke="black" d="M2418,-215C2418,-215 2442.38,-195.19 2461.04,-180.03"/>
</g>
<!-- 107 -->
<g id="node108" class="node">
<title>107</title>
<text text-anchor="middle" x="2413" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 106&#45;&#45;107 -->
<g id="edge107" class="edge">
<title>106--107</title>
<path fill="none" stroke="black" d="M2476,-143C2476,-143 2452,-123.19 2433.63,-108.03"/>
</g>
<!-- 108 -->
<g id="node109" class="node">
<title>108</title>
<text text-anchor="middle" x="2488" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 106&#45;&#45;108 -->
<g id="edge108" class="edge">
<title>106--108</title>
<path fill="none" stroke="black" d="M2476,-143C2476,-143 2480.57,-123.19 2484.07,-108.03"/>
</g>
<!-- 110 -->
<g id="node111" class="node">
<title>110</title>
<text text-anchor="start" x="2584" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 109&#45;&#45;110 -->
<g id="edge110" class="edge">
<title>109--110</title>
<path fill="none" stroke="black" d="M2612,-215C2612,-215 2607.81,-195.19 2604.6,-180.03"/>
</g>
<!-- 113 -->
<g id="node114" class="node">
<title>113</title>
<text text-anchor="start" x="2729.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BinOp</text>
</g>
<!-- 109&#45;&#45;113 -->
<g id="edge113" class="edge">
<title>109--113</title>
<path fill="none" stroke="black" d="M2612,-215C2612,-215 2680.34,-189.43 2721.18,-174.16"/>
</g>
<!-- 111 -->
<g id="node112" class="node">
<title>111</title>
<text text-anchor="middle" x="2563" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 110&#45;&#45;111 -->
<g id="edge111" class="edge">
<title>110--111</title>
<path fill="none" stroke="black" d="M2601,-143C2601,-143 2586.53,-123.19 2575.44,-108.03"/>
</g>
<!-- 112 -->
<g id="node113" class="node">
<title>112</title>
<text text-anchor="middle" x="2640" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 110&#45;&#45;112 -->
<g id="edge112" class="edge">
<title>110--112</title>
<path fill="none" stroke="black" d="M2601,-143C2601,-143 2615.86,-123.19 2627.23,-108.03"/>
</g>
<!-- 114 -->
<g id="node115" class="node">
<title>114</title>
<text text-anchor="start" x="2698" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 113&#45;&#45;114 -->
<g id="edge114" class="edge">
<title>113--114</title>
<path fill="none" stroke="black" d="M2757,-143C2757,-143 2741,-123.19 2728.75,-108.03"/>
</g>
<!-- 117 -->
<g id="node118" class="node">
<title>117</title>
<text text-anchor="middle" x="2787" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Add</text>
</g>
<!-- 113&#45;&#45;117 -->
<g id="edge117" class="edge">
<title>113--117</title>
<path fill="none" stroke="black" d="M2757,-143C2757,-143 2768.43,-123.19 2777.18,-108.03"/>
</g>
<!-- 118 -->
<g id="node119" class="node">
<title>118</title>
<text text-anchor="start" x="2842" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 113&#45;&#45;118 -->
<g id="edge118" class="edge">
<title>113--118</title>
<path fill="none" stroke="black" d="M2757,-143C2757,-143 2801.72,-120.2 2831.93,-104.8"/>
</g>
<!-- 115 -->
<g id="node116" class="node">
<title>115</title>
<text text-anchor="middle" x="2658" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 114&#45;&#45;115 -->
<g id="edge115" class="edge">
<title>114--115</title>
<path fill="none" stroke="black" d="M2711,-71C2711,-71 2690.81,-51.19 2675.35,-36.03"/>
</g>
<!-- 116 -->
<g id="node117" class="node">
<title>116</title>
<text text-anchor="middle" x="2733" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 114&#45;&#45;116 -->
<g id="edge116" class="edge">
<title>114--116</title>
<path fill="none" stroke="black" d="M2711,-71C2711,-71 2719.38,-51.19 2725.8,-36.03"/>
</g>
<!-- 119 -->
<g id="node120" class="node">
<title>119</title>
<text text-anchor="middle" x="2841" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 118&#45;&#45;119 -->
<g id="edge119" class="edge">
<title>118--119</title>
<path fill="none" stroke="black" d="M2863,-71C2863,-71 2854.62,-51.19 2848.2,-36.03"/>
</g>
<!-- 120 -->
<g id="node121" class="node">
<title>120</title>
<text text-anchor="middle" x="2913" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 118&#45;&#45;120 -->
<g id="edge120" class="edge">
<title>118--120</title>
<path fill="none" stroke="black" d="M2863,-71C2863,-71 2882.05,-51.19 2896.63,-36.03"/>
</g>
<!-- 122 -->
<g id="node123" class="node">
<title>122</title>
<text text-anchor="start" x="2181.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 121&#45;&#45;122 -->
<g id="edge122" class="edge">
<title>121--122</title>
<path fill="none" stroke="black" d="M1617.94,-589.19C1726.61,-576.98 2065.23,-538.93 2173.41,-526.77"/>
</g>
<!-- 123 -->
<g id="node124" class="node">
<title>123</title>
<text text-anchor="middle" x="2165" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 122&#45;&#45;123 -->
<g id="edge123" class="edge">
<title>122--123</title>
<path fill="none" stroke="black" d="M2215,-503C2215,-503 2195.95,-483.19 2181.37,-468.03"/>
</g>
<!-- 124 -->
<g id="node125" class="node">
<title>124</title>
<text text-anchor="start" x="2218.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 122&#45;&#45;124 -->
<g id="edge124" class="edge">
<title>122--124</title>
<path fill="none" stroke="black" d="M2215,-503C2215,-503 2227.57,-483.19 2237.19,-468.03"/>
</g>
<!-- 131 -->
<g id="node132" class="node">
<title>131</title>
<text text-anchor="start" x="2380.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 122&#45;&#45;131 -->
<g id="edge131" class="edge">
<title>122--131</title>
<path fill="none" stroke="black" d="M2215,-503C2215,-503 2315.74,-476.14 2372.4,-461.03"/>
</g>
<!-- 125 -->
<g id="node126" class="node">
<title>125</title>
<text text-anchor="start" x="2124" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 124&#45;&#45;125 -->
<g id="edge125" class="edge">
<title>124--125</title>
<path fill="none" stroke="black" d="M2248,-431C2248,-431 2213.72,-411.19 2187.47,-396.03"/>
</g>
<!-- 127 -->
<g id="node128" class="node">
<title>127</title>
<text text-anchor="middle" x="2248" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">NotIn</text>
</g>
<!-- 124&#45;&#45;127 -->
<g id="edge127" class="edge">
<title>124--127</title>
<path fill="none" stroke="black" d="M2248,-431C2248,-431 2248,-411.19 2248,-396.03"/>
</g>
<!-- 128 -->
<g id="node129" class="node">
<title>128</title>
<text text-anchor="start" x="2306" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 124&#45;&#45;128 -->
<g id="edge128" class="edge">
<title>124--128</title>
<path fill="none" stroke="black" d="M2248,-431C2248,-431 2276.57,-411.19 2298.44,-396.03"/>
</g>
<!-- 126 -->
<g id="node127" class="node">
<title>126</title>
<text text-anchor="middle" x="2218" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&lt;&quot;</text>
</g>
<!-- 125&#45;&#45;126 -->
<g id="edge126" class="edge">
<title>125--126</title>
<path fill="none" stroke="black" d="M2172.83,-359.7C2182.13,-348.85 2194.07,-334.92 2203.34,-324.1"/>
</g>
<!-- 129 -->
<g id="node130" class="node">
<title>129</title>
<text text-anchor="middle" x="2293" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 128&#45;&#45;129 -->
<g id="edge129" class="edge">
<title>128--129</title>
<path fill="none" stroke="black" d="M2324,-359C2324,-359 2312.19,-339.19 2303.15,-324.03"/>
</g>
<!-- 130 -->
<g id="node131" class="node">
<title>130</title>
<text text-anchor="middle" x="2368" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 128&#45;&#45;130 -->
<g id="edge130" class="edge">
<title>128--130</title>
<path fill="none" stroke="black" d="M2324,-359C2324,-359 2340.76,-339.19 2353.59,-324.03"/>
</g>
<!-- 132 -->
<g id="node133" class="node">
<title>132</title>
<text text-anchor="start" x="2376" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 131&#45;&#45;132 -->
<g id="edge132" class="edge">
<title>131--132</title>
<path fill="none" stroke="black" d="M2425,-431C2425,-431 2419.29,-411.19 2414.91,-396.03"/>
</g>
<!-- 134 -->
<g id="node135" class="node">
<title>134</title>
<text text-anchor="middle" x="2500" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">NotIn</text>
</g>
<!-- 131&#45;&#45;134 -->
<g id="edge134" class="edge">
<title>131--134</title>
<path fill="none" stroke="black" d="M2425,-431C2425,-431 2453.57,-411.19 2475.44,-396.03"/>
</g>
<!-- 135 -->
<g id="node136" class="node">
<title>135</title>
<text text-anchor="start" x="2558" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 131&#45;&#45;135 -->
<g id="edge135" class="edge">
<title>131--135</title>
<path fill="none" stroke="black" d="M2425,-431C2425,-431 2489.58,-415.14 2539,-396 2541.84,-394.9 2544.76,-393.68 2547.66,-392.41"/>
</g>
<!-- 133 -->
<g id="node134" class="node">
<title>133</title>
<text text-anchor="middle" x="2440" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&gt;&quot;</text>
</g>
<!-- 132&#45;&#45;133 -->
<g id="edge133" class="edge">
<title>132--133</title>
<path fill="none" stroke="black" d="M2417.42,-359.7C2422.07,-348.85 2428.04,-334.92 2432.67,-324.1"/>
</g>
<!-- 136 -->
<g id="node137" class="node">
<title>136</title>
<text text-anchor="middle" x="2530" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 135&#45;&#45;136 -->
<g id="edge136" class="edge">
<title>135--136</title>
<path fill="none" stroke="black" d="M2574,-359C2574,-359 2557.24,-339.19 2544.41,-324.03"/>
</g>
<!-- 137 -->
<g id="node138" class="node">
<title>137</title>
<text text-anchor="middle" x="2605" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 135&#45;&#45;137 -->
<g id="edge137" class="edge">
<title>135--137</title>
<path fill="none" stroke="black" d="M2574,-359C2574,-359 2585.81,-339.19 2594.85,-324.03"/>
</g>
<!-- 139 -->
<g id="node140" class="node">
<title>139</title>
<text text-anchor="start" x="2478" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 138&#45;&#45;139 -->
<g id="edge139" class="edge">
<title>138--139</title>
<path fill="none" stroke="black" d="M2078.82,-587.74C2164.67,-574.38 2389.73,-539.38 2467.83,-527.23"/>
</g>
<!-- 140 -->
<g id="node141" class="node">
<title>140</title>
<text text-anchor="middle" x="2495" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 139&#45;&#45;140 -->
<g id="edge140" class="edge">
<title>139--140</title>
<path fill="none" stroke="black" d="M2503,-503C2503,-503 2499.95,-483.19 2497.62,-468.03"/>
</g>
<!-- 141 -->
<g id="node142" class="node">
<title>141</title>
<text text-anchor="middle" x="2570" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 139&#45;&#45;141 -->
<g id="edge141" class="edge">
<title>139--141</title>
<path fill="none" stroke="black" d="M2503,-503C2503,-503 2528.52,-483.19 2548.06,-468.03"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us add some tests to this, using the same scheme:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_source</span> <span class="o">=</span> <span class="p">(</span>
    <span class="sd">&#39;&#39;&#39;if remove_html_markup(&#39;&lt;foo&gt;bar&lt;/foo&gt;&#39;) != &#39;bar&#39;:\n&#39;&#39;&#39;</span> <span class="o">+</span>
    <span class="sd">&#39;&#39;&#39;    raise RuntimeError(&quot;Missing functionality&quot;)\n&#39;&#39;&#39;</span> <span class="o">+</span>
    <span class="sd">&#39;&#39;&#39;assert remove_html_markup(&#39;&quot;foo&quot;&#39;) == &#39;&quot;foo&quot;&#39;, &quot;My Test&quot;&#39;&#39;&#39;</span>
<span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_tree</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">test_source</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">test_tree</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">if</span> remove_html_markup(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;foo&gt;bar&lt;/foo&gt;</span><span class="ansi-yellow-fg">&#39;</span>) != <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">bar</span><span class="ansi-yellow-fg">&#39;</span>:
    <span class="ansi-blue-fg">raise</span> <span class="ansi-cyan-fg">RuntimeError</span>(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">Missing functionality</span><span class="ansi-yellow-fg">&#39;</span>)
<span class="ansi-blue-fg">assert</span> remove_html_markup(<span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">foo</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span>) == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">foo</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span>, <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">My Test</span><span class="ansi-yellow-fg">&#39;</span>
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We can merge the function definition tree and the test tree into a single one:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn"><a href="https://docs.python.org/3/library/copy.html" class="import" target="_blank">copy</a></span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_test_tree</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">)</span>
<span class="n">fun_test_tree</span><span class="o">.</span><span class="n">body</span> <span class="o">+=</span> <span class="n">test_tree</span><span class="o">.</span><span class="n">body</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Such a tree can be compiled into a code object, using Python's <code>compile()</code> function:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_test_code</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">fun_test_tree</span><span class="p">,</span> <span class="s1">&#39;&lt;string&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>and the resulting code object can be executed directly, using the Python <code>exec()</code> function. We see that our test fails as expected.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">fun_test_code</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/1290587190.py&#34;, line 2, in &lt;module&gt;
    exec(fun_test_code, {}, {})
  File &#34;&lt;string&gt;&#34;, line 3, in &lt;module&gt;
AssertionError: My Test (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Traversing-Syntax-Trees">Traversing Syntax Trees<a class="anchor-link" href="#Traversing-Syntax-Trees">&#182;</a></h4><p>Our goal is now to reduce this tree (or at least the subtree with the function definition) to a minimum. 
To this end, we manipulate the AST through the <code>ast</code> Python module. The <a href="http://docs.python.org/3/library/ast">official Python <code>ast</code> reference</a> is complete, but a bit brief; the documentation <a href="https://greentreesnakes.readthedocs.io/en/latest/">"Green Tree Snakes - the missing Python AST docs"</a> provides an excellent introduction.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The two means for exploring and changing ASTs are the classes <code>NodeVisitor</code> and <code>NodeTransformer</code>, respectively. We start with creating a list of all nodes in the tree, using a <code>NodeVisitor</code> subclass.</p>
<p>Its <code>visit()</code> method is called for every node in the tree, which we achieve by having it return <code>self.generic_visit()</code> for the current node. It saves all visited nodes in the <code>_all_nodes</code> attribute.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn"><a href="https://docs.python.org/3/library/ast.html" class="import" target="_blank">ast</a></span> <span class="kn">import</span> <span class="n">NodeTransformer</span><span class="p">,</span> <span class="n">NodeVisitor</span><span class="p">,</span> <span class="n">AST</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeCollector</span><span class="p">(</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Collect all nodes in an AST.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_all_nodes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AST</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">generic_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_all_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AST</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all nodes in tree.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_all_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_nodes</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is how our <code>NodeCollector()</code> class produces a list of all nodes:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_nodes</span> <span class="o">=</span> <span class="n">NodeCollector</span><span class="p">()</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">fun_nodes</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>107
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_nodes</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>[&lt;ast.Module at 0x106e04760&gt;,
 &lt;ast.FunctionDef at 0x106e04400&gt;,
 &lt;ast.arguments at 0x106e04f10&gt;,
 &lt;ast.arg at 0x1070c0520&gt;,
 &lt;ast.Assign at 0x1070c01c0&gt;,
 &lt;ast.Name at 0x1070c02e0&gt;,
 &lt;ast.Store at 0x10447d6a0&gt;,
 &lt;ast.Constant at 0x1070c0fa0&gt;,
 &lt;ast.Assign at 0x1070c0f70&gt;,
 &lt;ast.Name at 0x1070c0f10&gt;,
 &lt;ast.Store at 0x10447d6a0&gt;,
 &lt;ast.Constant at 0x1070c0f40&gt;,
 &lt;ast.Assign at 0x1070c04c0&gt;,
 &lt;ast.Name at 0x1070c04f0&gt;,
 &lt;ast.Store at 0x10447d6a0&gt;,
 &lt;ast.Constant at 0x1070c0e80&gt;,
 &lt;ast.For at 0x1070c0ee0&gt;,
 &lt;ast.Name at 0x1070c08e0&gt;,
 &lt;ast.Store at 0x10447d6a0&gt;,
 &lt;ast.Name at 0x1070c0820&gt;,
 &lt;ast.Load at 0x10447d640&gt;,
 &lt;ast.If at 0x1070c09a0&gt;,
 &lt;ast.BoolOp at 0x1070c0df0&gt;,
 &lt;ast.And at 0x10447d790&gt;,
 &lt;ast.Compare at 0x1070c0670&gt;,
 &lt;ast.Name at 0x1070c06a0&gt;,
 &lt;ast.Load at 0x10447d640&gt;,
 &lt;ast.Eq at 0x10447df70&gt;,
 &lt;ast.Constant at 0x1070c0eb0&gt;,
 &lt;ast.UnaryOp at 0x1070c09d0&gt;]
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Such a list of nodes is what we can feed into Delta Debugging in order to reduce it. The idea is that with every test, we take the tree and for each node in the tree, we check whether it is still in the list – if not, we remove it. Thus, by reducing the list of nodes, we simultaneously reduce the tree as well.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Deleting-Nodes">Deleting Nodes<a class="anchor-link" href="#Deleting-Nodes">&#182;</a></h4><p>In our next step, we write some code that, given such a list of nodes, <em>prunes</em> the tree such that <em>only</em> elements in the list are still contained. To this end, we proceed in four steps:</p>
<ol>
<li>We traverse the original AST, <em>marking</em> all nodes as "to be deleted".</li>
<li>We traverse the given list of nodes, clearing their markers.</li>
<li>We copy the original tree (including the markers) into a new tree – the one to be reduced.</li>
<li>We traverse the new tree, now deleting all marked nodes.</li>
</ol>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Why do we go through such an extra effort? The reason is that our list of nodes contains references into the <em>original</em> tree – a tree that needs to stay unchanged such that we can reuse it for later. The new tree (the copy) has the same nodes, but at different addresses, so our original references cannot be used anymore. Markers, however, just like any other attributes, are safely copied from the original into the new tree.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>NodeMarker()</code> visitor marks all nodes in a tree:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeMarker</span><span class="p">(</span><span class="n">NodeVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="n">node</span><span class="o">.</span><span class="n">marked</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The <code>NodeReducer()</code> transformer reduces all marked nodes. If a method <code>visit_&lt;node class&gt;()</code> is defined, it will be invoked; otherwise, <code>visit_Node()</code> is invoked, which <em>deletes</em> the node (and its subtree) by returning <code>None</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeReducer</span><span class="p">(</span><span class="n">NodeTransformer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;visit_&#39;</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">visitor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">visit_Node</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">visitor</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="c1"># Can&#39;t remove modules</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">visit_Node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AST</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Default visitor for all nodes&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">marked</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># delete it</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Our function <code>copy_and_reduce()</code> puts these pieces together:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">copy_and_reduce</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">AST</span><span class="p">,</span> <span class="n">keep_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AST</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Copy tree, reducing all nodes that are not in keep_list.&quot;&quot;&quot;</span>

    <span class="c1"># Mark all nodes except those in keep_list</span>
    <span class="n">NodeMarker</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">keep_list</span><span class="p">:</span>
        <span class="c1"># print(&quot;Clearing&quot;, node)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">marked</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Copy tree and delete marked nodes</span>
    <span class="n">new_tree</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="n">NodeReducer</span><span class="p">()</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">new_tree</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_tree</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us apply this in practice. We take the first assignment in our tree...</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&lt;ast.Assign at 0x1070c01c0&gt;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>... whose subtree happens to be the assignment to <code>tag</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">fun_nodes</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;tag = False&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We keep all nodes <em>except</em> for this one.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">keep_list</span> <span class="o">=</span> <span class="n">fun_nodes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">del</span> <span class="n">keep_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us now create a copy of the tree in which the assignment is missing:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_fun_tree</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">copy_and_reduce</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">,</span> <span class="n">keep_list</span><span class="p">))</span>
<span class="n">show_ast</span><span class="p">(</span><span class="n">new_fun_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2717pt" height="692pt" viewBox="0.00 0.00 2717.00 692.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 688)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-688 2713,-688 2713,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="410.5" y="-663.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">FunctionDef</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="105" y="-590.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;remove_html_markup&quot;</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M459,-647C459,-647 318.78,-629.07 207,-612 203.89,-611.53 200.74,-611.04 197.55,-610.54"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="start" x="224" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arguments</text>
</g>
<!-- 0&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>0--2</title>
<path fill="none" stroke="black" d="M459,-647C459,-647 379.63,-629.38 317,-612 314.11,-611.2 311.14,-610.35 308.16,-609.48"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="start" x="334.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>0--5</title>
<path fill="none" stroke="black" d="M459,-647C459,-647 421.29,-627.19 392.42,-612.03"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="start" x="431.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>0--11</title>
<path fill="none" stroke="black" d="M459,-647C459,-647 458.24,-627.19 457.65,-612.03"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="start" x="672" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">For</text>
</g>
<!-- 0&#45;&#45;17 -->
<g id="edge17" class="edge">
<title>0--17</title>
<path fill="none" stroke="black" d="M459,-647C459,-647 597.63,-615.1 657.74,-601.27"/>
</g>
<!-- 115 -->
<g id="node116" class="node">
<title>115</title>
<text text-anchor="start" x="1327.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assert</text>
</g>
<!-- 0&#45;&#45;115 -->
<g id="edge115" class="edge">
<title>0--115</title>
<path fill="none" stroke="black" d="M459,-647C459,-647 1156.52,-606.43 1319.32,-596.96"/>
</g>
<!-- 132 -->
<g id="node133" class="node">
<title>132</title>
<text text-anchor="start" x="1788.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 0&#45;&#45;132 -->
<g id="edge132" class="edge">
<title>0--132</title>
<path fill="none" stroke="black" d="M459,-647C459,-647 979.03,-628.22 1395,-612 1538.31,-606.41 1709.18,-599.36 1780.33,-596.4"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="start" x="62" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>2--3</title>
<path fill="none" stroke="black" d="M216.25,-575.88C180.46,-562.48 131.91,-544.3 102.06,-533.13"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="27" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;s&quot;</text>
</g>
<!-- 3&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>3--4</title>
<path fill="none" stroke="black" d="M63.13,-503.7C55.69,-492.85 46.14,-478.92 38.73,-468.1"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="start" x="178" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 5&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>5--6</title>
<path fill="none" stroke="black" d="M337,-575C337,-575 263.24,-547.99 222.04,-532.9"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="start" x="271" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 5&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>5--9</title>
<path fill="none" stroke="black" d="M337,-575C337,-575 324.81,-555.19 315.48,-540.03"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="110" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 6&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>6--7</title>
<path fill="none" stroke="black" d="M187,-503C187,-503 157.67,-483.19 135.21,-468.03"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="195" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 6&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>6--8</title>
<path fill="none" stroke="black" d="M187,-503C187,-503 190.05,-483.19 192.38,-468.03"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="272" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 9&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>9--10</title>
<path fill="none" stroke="black" d="M296.84,-503.7C291.73,-492.85 285.16,-478.92 280.06,-468.1"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="start" x="397" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 11&#45;&#45;12 -->
<g id="edge12" class="edge">
<title>11--12</title>
<path fill="none" stroke="black" d="M457,-575C457,-575 440.62,-555.19 428.08,-540.03"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="start" x="467" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 11&#45;&#45;15 -->
<g id="edge15" class="edge">
<title>11--15</title>
<path fill="none" stroke="black" d="M457,-575C457,-575 473.76,-555.19 486.59,-540.03"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="349" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 12&#45;&#45;13 -->
<g id="edge13" class="edge">
<title>12--13</title>
<path fill="none" stroke="black" d="M409,-503C409,-503 386.14,-483.19 368.65,-468.03"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="426" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 12&#45;&#45;14 -->
<g id="edge14" class="edge">
<title>12--14</title>
<path fill="none" stroke="black" d="M409,-503C409,-503 415.48,-483.19 420.43,-468.03"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="501" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&quot;</text>
</g>
<!-- 15&#45;&#45;16 -->
<g id="edge16" class="edge">
<title>15--16</title>
<path fill="none" stroke="black" d="M501,-503.7C501,-492.85 501,-478.92 501,-468.1"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="start" x="631" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 17&#45;&#45;18 -->
<g id="edge18" class="edge">
<title>17--18</title>
<path fill="none" stroke="black" d="M693,-575C693,-575 675.86,-555.19 662.73,-540.03"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="start" x="706" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 17&#45;&#45;21 -->
<g id="edge21" class="edge">
<title>17--21</title>
<path fill="none" stroke="black" d="M693,-575C693,-575 704.43,-555.19 713.18,-540.03"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="start" x="907.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 17&#45;&#45;24 -->
<g id="edge24" class="edge">
<title>17--24</title>
<path fill="none" stroke="black" d="M693,-575C693,-575 829.11,-543.26 888.66,-529.38"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="573" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 18&#45;&#45;19 -->
<g id="edge19" class="edge">
<title>18--19</title>
<path fill="none" stroke="black" d="M640,-503C640,-503 614.48,-483.19 594.94,-468.03"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="648" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 18&#45;&#45;20 -->
<g id="edge20" class="edge">
<title>18--20</title>
<path fill="none" stroke="black" d="M640,-503C640,-503 643.05,-483.19 645.38,-468.03"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="723" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;s&quot;</text>
</g>
<!-- 21&#45;&#45;22 -->
<g id="edge22" class="edge">
<title>21--22</title>
<path fill="none" stroke="black" d="M731,-503C731,-503 727.95,-483.19 725.62,-468.03"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="middle" x="795" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 21&#45;&#45;23 -->
<g id="edge23" class="edge">
<title>21--23</title>
<path fill="none" stroke="black" d="M731,-503C731,-503 755.38,-483.19 774.04,-468.03"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="start" x="848.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 24&#45;&#45;25 -->
<g id="edge25" class="edge">
<title>24--25</title>
<path fill="none" stroke="black" d="M925,-503C925,-503 905.57,-483.19 890.7,-468.03"/>
</g>
<!-- 39 -->
<g id="node40" class="node">
<title>39</title>
<text text-anchor="start" x="933.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 24&#45;&#45;39 -->
<g id="edge39" class="edge">
<title>24--39</title>
<path fill="none" stroke="black" d="M925,-503C925,-503 937.95,-483.19 947.87,-468.03"/>
</g>
<!-- 45 -->
<g id="node46" class="node">
<title>45</title>
<text text-anchor="start" x="1251.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 24&#45;&#45;45 -->
<g id="edge45" class="edge">
<title>24--45</title>
<path fill="none" stroke="black" d="M925,-503C925,-503 1153.12,-467.59 1232.87,-455.21"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="533" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 25&#45;&#45;26 -->
<g id="edge26" class="edge">
<title>25--26</title>
<path fill="none" stroke="black" d="M840,-436C840,-436 835.21,-433.2 831,-432 717.95,-399.81 681.67,-429.48 569,-396 566.08,-395.13 563.11,-394.06 560.18,-392.88"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<text text-anchor="start" x="586.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 25&#45;&#45;27 -->
<g id="edge27" class="edge">
<title>25--27</title>
<path fill="none" stroke="black" d="M840,-436C840,-436 835.14,-433.42 831,-432 770.26,-411.2 697.27,-394.98 653.87,-386.22"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<text text-anchor="start" x="745.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 25&#45;&#45;34 -->
<g id="edge34" class="edge">
<title>25--34</title>
<path fill="none" stroke="black" d="M840,-436C840,-436 813.65,-412.89 794.5,-396.1"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<text text-anchor="start" x="440" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 27&#45;&#45;28 -->
<g id="edge28" class="edge">
<title>27--28</title>
<path fill="none" stroke="black" d="M601,-359C601,-359 539.91,-342.59 493,-324 490.17,-322.88 487.25,-321.64 484.36,-320.36"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<text text-anchor="middle" x="529" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 27&#45;&#45;31 -->
<g id="edge31" class="edge">
<title>27--31</title>
<path fill="none" stroke="black" d="M601,-359C601,-359 573.57,-339.19 552.58,-324.03"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<text text-anchor="start" x="582" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 27&#45;&#45;32 -->
<g id="edge32" class="edge">
<title>27--32</title>
<path fill="none" stroke="black" d="M601,-359C601,-359 606.71,-339.19 611.09,-324.03"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<text text-anchor="middle" x="421" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 28&#45;&#45;29 -->
<g id="edge29" class="edge">
<title>28--29</title>
<path fill="none" stroke="black" d="M457,-287C457,-287 443.29,-267.19 432.79,-252.03"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<text text-anchor="middle" x="493" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 28&#45;&#45;30 -->
<g id="edge30" class="edge">
<title>28--30</title>
<path fill="none" stroke="black" d="M457,-287C457,-287 470.71,-267.19 481.21,-252.03"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<text text-anchor="middle" x="616" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&lt;&quot;</text>
</g>
<!-- 32&#45;&#45;33 -->
<g id="edge33" class="edge">
<title>32--33</title>
<path fill="none" stroke="black" d="M616,-287.7C616,-276.85 616,-262.92 616,-252.1"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<text text-anchor="middle" x="703" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 34&#45;&#45;35 -->
<g id="edge35" class="edge">
<title>34--35</title>
<path fill="none" stroke="black" d="M767,-359C767,-359 742.62,-339.19 723.96,-324.03"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<text text-anchor="start" x="758" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 34&#45;&#45;36 -->
<g id="edge36" class="edge">
<title>34--36</title>
<path fill="none" stroke="black" d="M767,-359C767,-359 770.05,-339.19 772.38,-324.03"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<text text-anchor="middle" x="737" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 36&#45;&#45;37 -->
<g id="edge37" class="edge">
<title>36--37</title>
<path fill="none" stroke="black" d="M776,-287C776,-287 761.14,-267.19 749.77,-252.03"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<text text-anchor="middle" x="820" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 36&#45;&#45;38 -->
<g id="edge38" class="edge">
<title>36--38</title>
<path fill="none" stroke="black" d="M776,-287C776,-287 792.76,-267.19 805.59,-252.03"/>
</g>
<!-- 40 -->
<g id="node41" class="node">
<title>40</title>
<text text-anchor="start" x="898" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 39&#45;&#45;40 -->
<g id="edge40" class="edge">
<title>39--40</title>
<path fill="none" stroke="black" d="M959,-431C959,-431 942.24,-411.19 929.41,-396.03"/>
</g>
<!-- 43 -->
<g id="node44" class="node">
<title>43</title>
<text text-anchor="start" x="968" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 39&#45;&#45;43 -->
<g id="edge43" class="edge">
<title>39--43</title>
<path fill="none" stroke="black" d="M959,-431C959,-431 975.38,-411.19 987.92,-396.03"/>
</g>
<!-- 41 -->
<g id="node42" class="node">
<title>41</title>
<text text-anchor="middle" x="850" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 40&#45;&#45;41 -->
<g id="edge41" class="edge">
<title>40--41</title>
<path fill="none" stroke="black" d="M910,-359C910,-359 887.14,-339.19 869.65,-324.03"/>
</g>
<!-- 42 -->
<g id="node43" class="node">
<title>42</title>
<text text-anchor="middle" x="927" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 40&#45;&#45;42 -->
<g id="edge42" class="edge">
<title>40--42</title>
<path fill="none" stroke="black" d="M910,-359C910,-359 916.48,-339.19 921.43,-324.03"/>
</g>
<!-- 44 -->
<g id="node45" class="node">
<title>44</title>
<text text-anchor="middle" x="1002" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">True</text>
</g>
<!-- 43&#45;&#45;44 -->
<g id="edge44" class="edge">
<title>43--44</title>
<path fill="none" stroke="black" d="M1002,-359.7C1002,-348.85 1002,-334.92 1002,-324.1"/>
</g>
<!-- 46 -->
<g id="node47" class="node">
<title>46</title>
<text text-anchor="start" x="1177.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 45&#45;&#45;46 -->
<g id="edge46" class="edge">
<title>45--46</title>
<path fill="none" stroke="black" d="M1274,-431C1274,-431 1246.95,-411.19 1226.25,-396.03"/>
</g>
<!-- 60 -->
<g id="node61" class="node">
<title>60</title>
<text text-anchor="start" x="1336.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 45&#45;&#45;60 -->
<g id="edge60" class="edge">
<title>45--60</title>
<path fill="none" stroke="black" d="M1274,-431C1274,-431 1307.52,-411.19 1333.19,-396.03"/>
</g>
<!-- 66 -->
<g id="node67" class="node">
<title>66</title>
<text text-anchor="start" x="1733.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 45&#45;&#45;66 -->
<g id="edge66" class="edge">
<title>45--66</title>
<path fill="none" stroke="black" d="M1274,-431C1274,-431 1614.93,-393.12 1714.82,-382.02"/>
</g>
<!-- 47 -->
<g id="node48" class="node">
<title>47</title>
<text text-anchor="middle" x="1074" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 46&#45;&#45;47 -->
<g id="edge47" class="edge">
<title>46--47</title>
<path fill="none" stroke="black" d="M1196,-359C1196,-359 1147.78,-340.59 1110,-324 1107.09,-322.72 1104.06,-321.35 1101.05,-319.97"/>
</g>
<!-- 48 -->
<g id="node49" class="node">
<title>48</title>
<text text-anchor="start" x="1127.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 46&#45;&#45;48 -->
<g id="edge48" class="edge">
<title>46--48</title>
<path fill="none" stroke="black" d="M1196,-359C1196,-359 1181.14,-339.19 1169.77,-324.03"/>
</g>
<!-- 55 -->
<g id="node56" class="node">
<title>55</title>
<text text-anchor="start" x="1220.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 46&#45;&#45;55 -->
<g id="edge55" class="edge">
<title>46--55</title>
<path fill="none" stroke="black" d="M1196,-359C1196,-359 1216.57,-339.19 1232.32,-324.03"/>
</g>
<!-- 49 -->
<g id="node50" class="node">
<title>49</title>
<text text-anchor="start" x="915" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 48&#45;&#45;49 -->
<g id="edge49" class="edge">
<title>48--49</title>
<path fill="none" stroke="black" d="M1126,-287C1126,-287 1036.05,-275.28 968,-252 965.12,-251.02 962.17,-249.87 959.26,-248.64"/>
</g>
<!-- 52 -->
<g id="node53" class="node">
<title>52</title>
<text text-anchor="middle" x="1004" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 48&#45;&#45;52 -->
<g id="edge52" class="edge">
<title>48--52</title>
<path fill="none" stroke="black" d="M1126,-287C1126,-287 1077.78,-268.59 1040,-252 1037.09,-250.72 1034.06,-249.35 1031.05,-247.97"/>
</g>
<!-- 53 -->
<g id="node54" class="node">
<title>53</title>
<text text-anchor="start" x="1057" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 48&#45;&#45;53 -->
<g id="edge53" class="edge">
<title>48--53</title>
<path fill="none" stroke="black" d="M1126,-287C1126,-287 1112.67,-267.19 1102.46,-252.03"/>
</g>
<!-- 50 -->
<g id="node51" class="node">
<title>50</title>
<text text-anchor="middle" x="896" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 49&#45;&#45;50 -->
<g id="edge50" class="edge">
<title>49--50</title>
<path fill="none" stroke="black" d="M932,-215C932,-215 918.29,-195.19 907.79,-180.03"/>
</g>
<!-- 51 -->
<g id="node52" class="node">
<title>51</title>
<text text-anchor="middle" x="968" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 49&#45;&#45;51 -->
<g id="edge51" class="edge">
<title>49--51</title>
<path fill="none" stroke="black" d="M932,-215C932,-215 945.71,-195.19 956.21,-180.03"/>
</g>
<!-- 54 -->
<g id="node55" class="node">
<title>54</title>
<text text-anchor="middle" x="1091" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&gt;&quot;</text>
</g>
<!-- 53&#45;&#45;54 -->
<g id="edge54" class="edge">
<title>53--54</title>
<path fill="none" stroke="black" d="M1091,-215.7C1091,-204.85 1091,-190.92 1091,-180.1"/>
</g>
<!-- 56 -->
<g id="node57" class="node">
<title>56</title>
<text text-anchor="middle" x="1178" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 55&#45;&#45;56 -->
<g id="edge56" class="edge">
<title>55--56</title>
<path fill="none" stroke="black" d="M1242,-287C1242,-287 1217.62,-267.19 1198.96,-252.03"/>
</g>
<!-- 57 -->
<g id="node58" class="node">
<title>57</title>
<text text-anchor="start" x="1233" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 55&#45;&#45;57 -->
<g id="edge57" class="edge">
<title>55--57</title>
<path fill="none" stroke="black" d="M1242,-287C1242,-287 1245.05,-267.19 1247.38,-252.03"/>
</g>
<!-- 58 -->
<g id="node59" class="node">
<title>58</title>
<text text-anchor="middle" x="1208" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 57&#45;&#45;58 -->
<g id="edge58" class="edge">
<title>57--58</title>
<path fill="none" stroke="black" d="M1250,-215C1250,-215 1234,-195.19 1221.75,-180.03"/>
</g>
<!-- 59 -->
<g id="node60" class="node">
<title>59</title>
<text text-anchor="middle" x="1291" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 57&#45;&#45;59 -->
<g id="edge59" class="edge">
<title>57--59</title>
<path fill="none" stroke="black" d="M1250,-215C1250,-215 1265.62,-195.19 1277.58,-180.03"/>
</g>
<!-- 61 -->
<g id="node62" class="node">
<title>61</title>
<text text-anchor="start" x="1345" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 60&#45;&#45;61 -->
<g id="edge61" class="edge">
<title>60--61</title>
<path fill="none" stroke="black" d="M1372,-359C1372,-359 1368.19,-339.19 1365.27,-324.03"/>
</g>
<!-- 64 -->
<g id="node65" class="node">
<title>64</title>
<text text-anchor="start" x="1430" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 60&#45;&#45;64 -->
<g id="edge64" class="edge">
<title>60--64</title>
<path fill="none" stroke="black" d="M1372,-359C1372,-359 1407.04,-339.19 1433.88,-324.03"/>
</g>
<!-- 62 -->
<g id="node63" class="node">
<title>62</title>
<text text-anchor="middle" x="1325" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 61&#45;&#45;62 -->
<g id="edge62" class="edge">
<title>61--62</title>
<path fill="none" stroke="black" d="M1362,-287C1362,-287 1347.91,-267.19 1337.12,-252.03"/>
</g>
<!-- 63 -->
<g id="node64" class="node">
<title>63</title>
<text text-anchor="middle" x="1402" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 61&#45;&#45;63 -->
<g id="edge63" class="edge">
<title>61--63</title>
<path fill="none" stroke="black" d="M1362,-287C1362,-287 1377.24,-267.19 1388.9,-252.03"/>
</g>
<!-- 65 -->
<g id="node66" class="node">
<title>65</title>
<text text-anchor="middle" x="1479" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 64&#45;&#45;65 -->
<g id="edge65" class="edge">
<title>64--65</title>
<path fill="none" stroke="black" d="M1467.71,-287.7C1470.03,-276.85 1473.02,-262.92 1475.33,-252.1"/>
</g>
<!-- 67 -->
<g id="node68" class="node">
<title>67</title>
<text text-anchor="start" x="1649.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 66&#45;&#45;67 -->
<g id="edge67" class="edge">
<title>66--67</title>
<path fill="none" stroke="black" d="M1753,-359C1753,-359 1723.29,-339.19 1700.54,-324.03"/>
</g>
<!-- 88 -->
<g id="node89" class="node">
<title>88</title>
<text text-anchor="start" x="1810.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 66&#45;&#45;88 -->
<g id="edge88" class="edge">
<title>66--88</title>
<path fill="none" stroke="black" d="M1753,-359C1753,-359 1784.62,-339.19 1808.82,-324.03"/>
</g>
<!-- 97 -->
<g id="node98" class="node">
<title>97</title>
<text text-anchor="start" x="1906.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 66&#45;&#45;97 -->
<g id="edge97" class="edge">
<title>66--97</title>
<path fill="none" stroke="black" d="M1753,-359C1753,-359 1823.84,-343.88 1878,-324 1881.19,-322.83 1884.48,-321.5 1887.72,-320.12"/>
</g>
<!-- 68 -->
<g id="node69" class="node">
<title>68</title>
<text text-anchor="middle" x="1554" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Or</text>
</g>
<!-- 67&#45;&#45;68 -->
<g id="edge68" class="edge">
<title>67--68</title>
<path fill="none" stroke="black" d="M1669,-287C1669,-287 1624.92,-267.98 1590,-252 1587.11,-250.68 1584.09,-249.28 1581.09,-247.88"/>
</g>
<!-- 69 -->
<g id="node70" class="node">
<title>69</title>
<text text-anchor="start" x="1607.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 67&#45;&#45;69 -->
<g id="edge69" class="edge">
<title>67--69</title>
<path fill="none" stroke="black" d="M1669,-287C1669,-287 1656.81,-267.19 1647.48,-252.03"/>
</g>
<!-- 76 -->
<g id="node77" class="node">
<title>76</title>
<text text-anchor="start" x="1700.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 67&#45;&#45;76 -->
<g id="edge76" class="edge">
<title>67--76</title>
<path fill="none" stroke="black" d="M1669,-287C1669,-287 1690.71,-267.19 1707.34,-252.03"/>
</g>
<!-- 70 -->
<g id="node71" class="node">
<title>70</title>
<text text-anchor="start" x="1363" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 69&#45;&#45;70 -->
<g id="edge70" class="edge">
<title>69--70</title>
<path fill="none" stroke="black" d="M1599,-216C1599,-216 1494.74,-205.89 1416,-180 1413.11,-179.05 1410.15,-177.92 1407.23,-176.71"/>
</g>
<!-- 73 -->
<g id="node74" class="node">
<title>73</title>
<text text-anchor="middle" x="1452" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 69&#45;&#45;73 -->
<g id="edge73" class="edge">
<title>69--73</title>
<path fill="none" stroke="black" d="M1599,-216C1599,-216 1536.21,-199.11 1488,-180 1485.17,-178.88 1482.25,-177.64 1479.36,-176.36"/>
</g>
<!-- 74 -->
<g id="node75" class="node">
<title>74</title>
<text text-anchor="start" x="1505" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 69&#45;&#45;74 -->
<g id="edge74" class="edge">
<title>69--74</title>
<path fill="none" stroke="black" d="M1599,-216C1599,-216 1575.85,-195.55 1558.31,-180.06"/>
</g>
<!-- 71 -->
<g id="node72" class="node">
<title>71</title>
<text text-anchor="middle" x="1321" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 70&#45;&#45;71 -->
<g id="edge71" class="edge">
<title>70--71</title>
<path fill="none" stroke="black" d="M1375,-143C1375,-143 1354.43,-123.19 1338.68,-108.03"/>
</g>
<!-- 72 -->
<g id="node73" class="node">
<title>72</title>
<text text-anchor="middle" x="1393" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 70&#45;&#45;72 -->
<g id="edge72" class="edge">
<title>70--72</title>
<path fill="none" stroke="black" d="M1375,-143C1375,-143 1381.86,-123.19 1387.11,-108.03"/>
</g>
<!-- 75 -->
<g id="node76" class="node">
<title>75</title>
<text text-anchor="middle" x="1508" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&quot;&quot;</text>
</g>
<!-- 74&#45;&#45;75 -->
<g id="edge75" class="edge">
<title>74--75</title>
<path fill="none" stroke="black" d="M1531.34,-143.7C1526.53,-132.85 1520.36,-118.92 1515.57,-108.1"/>
</g>
<!-- 77 -->
<g id="node78" class="node">
<title>77</title>
<text text-anchor="middle" x="1626" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 76&#45;&#45;77 -->
<g id="edge77" class="edge">
<title>76--77</title>
<path fill="none" stroke="black" d="M1723,-215C1723,-215 1681.72,-192.87 1653.02,-177.48"/>
</g>
<!-- 78 -->
<g id="node79" class="node">
<title>78</title>
<text text-anchor="start" x="1679.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 76&#45;&#45;78 -->
<g id="edge78" class="edge">
<title>76--78</title>
<path fill="none" stroke="black" d="M1723,-215C1723,-215 1717.67,-195.19 1713.58,-180.03"/>
</g>
<!-- 85 -->
<g id="node86" class="node">
<title>85</title>
<text text-anchor="start" x="1775" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 76&#45;&#45;85 -->
<g id="edge85" class="edge">
<title>76--85</title>
<path fill="none" stroke="black" d="M1723,-215C1723,-215 1749.28,-195.19 1769.41,-180.03"/>
</g>
<!-- 79 -->
<g id="node80" class="node">
<title>79</title>
<text text-anchor="start" x="1563" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 78&#45;&#45;79 -->
<g id="edge79" class="edge">
<title>78--79</title>
<path fill="none" stroke="black" d="M1700,-143C1700,-143 1652.96,-124.42 1616,-108 1613.09,-106.71 1610.07,-105.33 1607.06,-103.95"/>
</g>
<!-- 82 -->
<g id="node83" class="node">
<title>82</title>
<text text-anchor="middle" x="1652" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 78&#45;&#45;82 -->
<g id="edge82" class="edge">
<title>78--82</title>
<path fill="none" stroke="black" d="M1700,-143C1700,-143 1681.72,-123.19 1667.72,-108.03"/>
</g>
<!-- 83 -->
<g id="node84" class="node">
<title>83</title>
<text text-anchor="start" x="1705" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 78&#45;&#45;83 -->
<g id="edge83" class="edge">
<title>78--83</title>
<path fill="none" stroke="black" d="M1700,-143C1700,-143 1714.86,-123.19 1726.23,-108.03"/>
</g>
<!-- 80 -->
<g id="node81" class="node">
<title>80</title>
<text text-anchor="middle" x="1544" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 79&#45;&#45;80 -->
<g id="edge80" class="edge">
<title>79--80</title>
<path fill="none" stroke="black" d="M1580,-71C1580,-71 1566.29,-51.19 1555.79,-36.03"/>
</g>
<!-- 81 -->
<g id="node82" class="node">
<title>81</title>
<text text-anchor="middle" x="1616" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 79&#45;&#45;81 -->
<g id="edge81" class="edge">
<title>79--81</title>
<path fill="none" stroke="black" d="M1580,-71C1580,-71 1593.71,-51.19 1604.21,-36.03"/>
</g>
<!-- 84 -->
<g id="node85" class="node">
<title>84</title>
<text text-anchor="middle" x="1739" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;'&quot;</text>
</g>
<!-- 83&#45;&#45;84 -->
<g id="edge84" class="edge">
<title>83--84</title>
<path fill="none" stroke="black" d="M1739,-71.7C1739,-60.85 1739,-46.92 1739,-36.1"/>
</g>
<!-- 86 -->
<g id="node87" class="node">
<title>86</title>
<text text-anchor="middle" x="1829" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 85&#45;&#45;86 -->
<g id="edge86" class="edge">
<title>85--86</title>
<path fill="none" stroke="black" d="M1809,-143C1809,-143 1816.62,-123.19 1822.45,-108.03"/>
</g>
<!-- 87 -->
<g id="node88" class="node">
<title>87</title>
<text text-anchor="middle" x="1904" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 85&#45;&#45;87 -->
<g id="edge87" class="edge">
<title>85--87</title>
<path fill="none" stroke="black" d="M1809,-143C1809,-143 1848.7,-121.27 1876.78,-105.9"/>
</g>
<!-- 89 -->
<g id="node90" class="node">
<title>89</title>
<text text-anchor="start" x="1858" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 88&#45;&#45;89 -->
<g id="edge89" class="edge">
<title>88--89</title>
<path fill="none" stroke="black" d="M1857,-287C1857,-287 1863.86,-267.19 1869.11,-252.03"/>
</g>
<!-- 92 -->
<g id="node93" class="node">
<title>92</title>
<text text-anchor="start" x="2005.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 88&#45;&#45;92 -->
<g id="edge92" class="edge">
<title>88--92</title>
<path fill="none" stroke="black" d="M1857,-287C1857,-287 1945,-261.29 1997.25,-246.03"/>
</g>
<!-- 90 -->
<g id="node91" class="node">
<title>90</title>
<text text-anchor="middle" x="1875" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 89&#45;&#45;90 -->
<g id="edge90" class="edge">
<title>89--90</title>
<path fill="none" stroke="black" d="M1883,-215C1883,-215 1879.95,-195.19 1877.62,-180.03"/>
</g>
<!-- 91 -->
<g id="node92" class="node">
<title>91</title>
<text text-anchor="middle" x="1960" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 89&#45;&#45;91 -->
<g id="edge91" class="edge">
<title>89--91</title>
<path fill="none" stroke="black" d="M1883,-215C1883,-215 1912.33,-195.19 1934.79,-180.03"/>
</g>
<!-- 93 -->
<g id="node94" class="node">
<title>93</title>
<text text-anchor="middle" x="2035" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 92&#45;&#45;93 -->
<g id="edge93" class="edge">
<title>92--93</title>
<path fill="none" stroke="black" d="M2043,-215C2043,-215 2039.95,-195.19 2037.62,-180.03"/>
</g>
<!-- 94 -->
<g id="node95" class="node">
<title>94</title>
<text text-anchor="start" x="2090" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 92&#45;&#45;94 -->
<g id="edge94" class="edge">
<title>92--94</title>
<path fill="none" stroke="black" d="M2043,-215C2043,-215 2067.38,-195.19 2086.04,-180.03"/>
</g>
<!-- 95 -->
<g id="node96" class="node">
<title>95</title>
<text text-anchor="middle" x="2024" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 94&#45;&#45;95 -->
<g id="edge95" class="edge">
<title>94--95</title>
<path fill="none" stroke="black" d="M2099,-143C2099,-143 2070.43,-123.19 2048.56,-108.03"/>
</g>
<!-- 96 -->
<g id="node97" class="node">
<title>96</title>
<text text-anchor="middle" x="2107" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 94&#45;&#45;96 -->
<g id="edge96" class="edge">
<title>94--96</title>
<path fill="none" stroke="black" d="M2099,-143C2099,-143 2102.05,-123.19 2104.38,-108.03"/>
</g>
<!-- 98 -->
<g id="node99" class="node">
<title>98</title>
<text text-anchor="start" x="2149.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 97&#45;&#45;98 -->
<g id="edge98" class="edge">
<title>97--98</title>
<path fill="none" stroke="black" d="M1942,-299C1942,-299 1945.64,-291.34 1951,-288 1967.09,-277.99 2080.74,-254.43 2141.27,-242.38"/>
</g>
<!-- 103 -->
<g id="node104" class="node">
<title>103</title>
<text text-anchor="start" x="2344.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 97&#45;&#45;103 -->
<g id="edge103" class="edge">
<title>97--103</title>
<path fill="none" stroke="black" d="M1942,-299C1942,-299 1945.47,-291.06 1951,-288 1959.46,-283.32 2238.62,-250.35 2336.5,-238.9"/>
</g>
<!-- 99 -->
<g id="node100" class="node">
<title>99</title>
<text text-anchor="middle" x="2179" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 98&#45;&#45;99 -->
<g id="edge99" class="edge">
<title>98--99</title>
<path fill="none" stroke="black" d="M2187,-215C2187,-215 2183.95,-195.19 2181.62,-180.03"/>
</g>
<!-- 100 -->
<g id="node101" class="node">
<title>100</title>
<text text-anchor="start" x="2234" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 98&#45;&#45;100 -->
<g id="edge100" class="edge">
<title>98--100</title>
<path fill="none" stroke="black" d="M2187,-215C2187,-215 2211.38,-195.19 2230.04,-180.03"/>
</g>
<!-- 101 -->
<g id="node102" class="node">
<title>101</title>
<text text-anchor="middle" x="2182" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 100&#45;&#45;101 -->
<g id="edge101" class="edge">
<title>100--101</title>
<path fill="none" stroke="black" d="M2245,-143C2245,-143 2221,-123.19 2202.63,-108.03"/>
</g>
<!-- 102 -->
<g id="node103" class="node">
<title>102</title>
<text text-anchor="middle" x="2257" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 100&#45;&#45;102 -->
<g id="edge102" class="edge">
<title>100--102</title>
<path fill="none" stroke="black" d="M2245,-143C2245,-143 2249.57,-123.19 2253.07,-108.03"/>
</g>
<!-- 104 -->
<g id="node105" class="node">
<title>104</title>
<text text-anchor="start" x="2353" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 103&#45;&#45;104 -->
<g id="edge104" class="edge">
<title>103--104</title>
<path fill="none" stroke="black" d="M2381,-215C2381,-215 2376.81,-195.19 2373.6,-180.03"/>
</g>
<!-- 107 -->
<g id="node108" class="node">
<title>107</title>
<text text-anchor="start" x="2498.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BinOp</text>
</g>
<!-- 103&#45;&#45;107 -->
<g id="edge107" class="edge">
<title>103--107</title>
<path fill="none" stroke="black" d="M2381,-215C2381,-215 2449.34,-189.43 2490.18,-174.16"/>
</g>
<!-- 105 -->
<g id="node106" class="node">
<title>105</title>
<text text-anchor="middle" x="2332" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 104&#45;&#45;105 -->
<g id="edge105" class="edge">
<title>104--105</title>
<path fill="none" stroke="black" d="M2370,-143C2370,-143 2355.53,-123.19 2344.44,-108.03"/>
</g>
<!-- 106 -->
<g id="node107" class="node">
<title>106</title>
<text text-anchor="middle" x="2409" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 104&#45;&#45;106 -->
<g id="edge106" class="edge">
<title>104--106</title>
<path fill="none" stroke="black" d="M2370,-143C2370,-143 2384.86,-123.19 2396.23,-108.03"/>
</g>
<!-- 108 -->
<g id="node109" class="node">
<title>108</title>
<text text-anchor="start" x="2467" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 107&#45;&#45;108 -->
<g id="edge108" class="edge">
<title>107--108</title>
<path fill="none" stroke="black" d="M2526,-143C2526,-143 2510,-123.19 2497.75,-108.03"/>
</g>
<!-- 111 -->
<g id="node112" class="node">
<title>111</title>
<text text-anchor="middle" x="2556" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Add</text>
</g>
<!-- 107&#45;&#45;111 -->
<g id="edge111" class="edge">
<title>107--111</title>
<path fill="none" stroke="black" d="M2526,-143C2526,-143 2537.43,-123.19 2546.18,-108.03"/>
</g>
<!-- 112 -->
<g id="node113" class="node">
<title>112</title>
<text text-anchor="start" x="2611" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 107&#45;&#45;112 -->
<g id="edge112" class="edge">
<title>107--112</title>
<path fill="none" stroke="black" d="M2526,-143C2526,-143 2570.72,-120.2 2600.93,-104.8"/>
</g>
<!-- 109 -->
<g id="node110" class="node">
<title>109</title>
<text text-anchor="middle" x="2427" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 108&#45;&#45;109 -->
<g id="edge109" class="edge">
<title>108--109</title>
<path fill="none" stroke="black" d="M2480,-71C2480,-71 2459.81,-51.19 2444.35,-36.03"/>
</g>
<!-- 110 -->
<g id="node111" class="node">
<title>110</title>
<text text-anchor="middle" x="2502" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 108&#45;&#45;110 -->
<g id="edge110" class="edge">
<title>108--110</title>
<path fill="none" stroke="black" d="M2480,-71C2480,-71 2488.38,-51.19 2494.8,-36.03"/>
</g>
<!-- 113 -->
<g id="node114" class="node">
<title>113</title>
<text text-anchor="middle" x="2610" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 112&#45;&#45;113 -->
<g id="edge113" class="edge">
<title>112--113</title>
<path fill="none" stroke="black" d="M2632,-71C2632,-71 2623.62,-51.19 2617.2,-36.03"/>
</g>
<!-- 114 -->
<g id="node115" class="node">
<title>114</title>
<text text-anchor="middle" x="2682" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 112&#45;&#45;114 -->
<g id="edge114" class="edge">
<title>112--114</title>
<path fill="none" stroke="black" d="M2632,-71C2632,-71 2651.05,-51.19 2665.63,-36.03"/>
</g>
<!-- 116 -->
<g id="node117" class="node">
<title>116</title>
<text text-anchor="start" x="1950.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 115&#45;&#45;116 -->
<g id="edge116" class="edge">
<title>115--116</title>
<path fill="none" stroke="black" d="M1386.94,-589.19C1495.61,-576.98 1834.23,-538.93 1942.41,-526.77"/>
</g>
<!-- 117 -->
<g id="node118" class="node">
<title>117</title>
<text text-anchor="middle" x="1934" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 116&#45;&#45;117 -->
<g id="edge117" class="edge">
<title>116--117</title>
<path fill="none" stroke="black" d="M1984,-503C1984,-503 1964.95,-483.19 1950.37,-468.03"/>
</g>
<!-- 118 -->
<g id="node119" class="node">
<title>118</title>
<text text-anchor="start" x="1987.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 116&#45;&#45;118 -->
<g id="edge118" class="edge">
<title>116--118</title>
<path fill="none" stroke="black" d="M1984,-503C1984,-503 1996.57,-483.19 2006.19,-468.03"/>
</g>
<!-- 125 -->
<g id="node126" class="node">
<title>125</title>
<text text-anchor="start" x="2149.5" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 116&#45;&#45;125 -->
<g id="edge125" class="edge">
<title>116--125</title>
<path fill="none" stroke="black" d="M1984,-503C1984,-503 2084.74,-476.14 2141.4,-461.03"/>
</g>
<!-- 119 -->
<g id="node120" class="node">
<title>119</title>
<text text-anchor="start" x="1893" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 118&#45;&#45;119 -->
<g id="edge119" class="edge">
<title>118--119</title>
<path fill="none" stroke="black" d="M2017,-431C2017,-431 1982.72,-411.19 1956.47,-396.03"/>
</g>
<!-- 121 -->
<g id="node122" class="node">
<title>121</title>
<text text-anchor="middle" x="2017" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">NotIn</text>
</g>
<!-- 118&#45;&#45;121 -->
<g id="edge121" class="edge">
<title>118--121</title>
<path fill="none" stroke="black" d="M2017,-431C2017,-431 2017,-411.19 2017,-396.03"/>
</g>
<!-- 122 -->
<g id="node123" class="node">
<title>122</title>
<text text-anchor="start" x="2075" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 118&#45;&#45;122 -->
<g id="edge122" class="edge">
<title>118--122</title>
<path fill="none" stroke="black" d="M2017,-431C2017,-431 2045.57,-411.19 2067.44,-396.03"/>
</g>
<!-- 120 -->
<g id="node121" class="node">
<title>120</title>
<text text-anchor="middle" x="1987" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&lt;&quot;</text>
</g>
<!-- 119&#45;&#45;120 -->
<g id="edge120" class="edge">
<title>119--120</title>
<path fill="none" stroke="black" d="M1941.83,-359.7C1951.13,-348.85 1963.07,-334.92 1972.34,-324.1"/>
</g>
<!-- 123 -->
<g id="node124" class="node">
<title>123</title>
<text text-anchor="middle" x="2062" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 122&#45;&#45;123 -->
<g id="edge123" class="edge">
<title>122--123</title>
<path fill="none" stroke="black" d="M2093,-359C2093,-359 2081.19,-339.19 2072.15,-324.03"/>
</g>
<!-- 124 -->
<g id="node125" class="node">
<title>124</title>
<text text-anchor="middle" x="2137" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 122&#45;&#45;124 -->
<g id="edge124" class="edge">
<title>122--124</title>
<path fill="none" stroke="black" d="M2093,-359C2093,-359 2109.76,-339.19 2122.59,-324.03"/>
</g>
<!-- 126 -->
<g id="node127" class="node">
<title>126</title>
<text text-anchor="start" x="2145" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 125&#45;&#45;126 -->
<g id="edge126" class="edge">
<title>125--126</title>
<path fill="none" stroke="black" d="M2194,-431C2194,-431 2188.29,-411.19 2183.91,-396.03"/>
</g>
<!-- 128 -->
<g id="node129" class="node">
<title>128</title>
<text text-anchor="middle" x="2269" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">NotIn</text>
</g>
<!-- 125&#45;&#45;128 -->
<g id="edge128" class="edge">
<title>125--128</title>
<path fill="none" stroke="black" d="M2194,-431C2194,-431 2222.57,-411.19 2244.44,-396.03"/>
</g>
<!-- 129 -->
<g id="node130" class="node">
<title>129</title>
<text text-anchor="start" x="2327" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 125&#45;&#45;129 -->
<g id="edge129" class="edge">
<title>125--129</title>
<path fill="none" stroke="black" d="M2194,-431C2194,-431 2258.58,-415.14 2308,-396 2310.84,-394.9 2313.76,-393.68 2316.66,-392.41"/>
</g>
<!-- 127 -->
<g id="node128" class="node">
<title>127</title>
<text text-anchor="middle" x="2209" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&gt;&quot;</text>
</g>
<!-- 126&#45;&#45;127 -->
<g id="edge127" class="edge">
<title>126--127</title>
<path fill="none" stroke="black" d="M2186.42,-359.7C2191.07,-348.85 2197.04,-334.92 2201.67,-324.1"/>
</g>
<!-- 130 -->
<g id="node131" class="node">
<title>130</title>
<text text-anchor="middle" x="2299" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 129&#45;&#45;130 -->
<g id="edge130" class="edge">
<title>129--130</title>
<path fill="none" stroke="black" d="M2343,-359C2343,-359 2326.24,-339.19 2313.41,-324.03"/>
</g>
<!-- 131 -->
<g id="node132" class="node">
<title>131</title>
<text text-anchor="middle" x="2374" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 129&#45;&#45;131 -->
<g id="edge131" class="edge">
<title>129--131</title>
<path fill="none" stroke="black" d="M2343,-359C2343,-359 2354.81,-339.19 2363.85,-324.03"/>
</g>
<!-- 133 -->
<g id="node134" class="node">
<title>133</title>
<text text-anchor="start" x="2247" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 132&#45;&#45;133 -->
<g id="edge133" class="edge">
<title>132--133</title>
<path fill="none" stroke="black" d="M1847.82,-587.74C1933.67,-574.38 2158.73,-539.38 2236.83,-527.23"/>
</g>
<!-- 134 -->
<g id="node135" class="node">
<title>134</title>
<text text-anchor="middle" x="2264" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 133&#45;&#45;134 -->
<g id="edge134" class="edge">
<title>133--134</title>
<path fill="none" stroke="black" d="M2272,-503C2272,-503 2268.95,-483.19 2266.62,-468.03"/>
</g>
<!-- 135 -->
<g id="node136" class="node">
<title>135</title>
<text text-anchor="middle" x="2339" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 133&#45;&#45;135 -->
<g id="edge135" class="edge">
<title>133--135</title>
<path fill="none" stroke="black" d="M2272,-503C2272,-503 2297.52,-483.19 2317.06,-468.03"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The new tree no longer contains the initial assignment to <code>tag</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">new_fun_tree</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#39;</span>
    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> (<span class="ansi-magenta-fg">not</span> quote):
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> (<span class="ansi-magenta-fg">not</span> quote):
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> (c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag):
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c
    <span class="ansi-blue-fg">assert</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out <span class="ansi-magenta-fg">and</span> <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">not</span> <span class="ansi-magenta-fg">in</span> out
    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we add our tests and then execute this code, we get an error, as <code>tag</code> is now no longer initialized:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_fun_tree</span><span class="o">.</span><span class="n">body</span> <span class="o">+=</span> <span class="n">test_tree</span><span class="o">.</span><span class="n">body</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fun_code</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">new_fun_tree</span><span class="p">,</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">UnboundLocalError</span><span class="p">):</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">fun_code</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2411822553.py&#34;, line 2, in &lt;module&gt;
    exec(fun_code, {}, {})
  File &#34;&lt;string&gt;&#34;, line 3, in &lt;module&gt;
  File &#34;&lt;string&gt;&#34;, line 13, in remove_html_markup
UnboundLocalError: local variable &#39;tag&#39; referenced before assignment (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we have <em>no</em> node in the keep list, the whole tree gets deleted:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">empty_tree</span> <span class="o">=</span> <span class="n">copy_and_reduce</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">empty_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>&#39;&#39;
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Reducing-Trees">Reducing Trees<a class="anchor-link" href="#Reducing-Trees">&#182;</a></h4><p>We can put all these steps together in a single function. <code>compile_and_test_ast()</code> takes a tree and a list of nodes, reduces the tree to those nodes in the list, and then compiles and runs the reduced AST.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compile_and_test_ast</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">keep_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AST</span><span class="p">],</span> 
                         <span class="n">test_tree</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">new_tree</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">copy_and_reduce</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">keep_list</span><span class="p">))</span>
    <span class="c1"># print(ast.unparse(new_tree))</span>

    <span class="k">if</span> <span class="n">test_tree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_tree</span><span class="o">.</span><span class="n">body</span> <span class="o">+=</span> <span class="n">test_tree</span><span class="o">.</span><span class="n">body</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">code_object</span> <span class="o">=</span> <span class="nb">compile</span><span class="p">(</span><span class="n">new_tree</span><span class="p">,</span> <span class="s1">&#39;&lt;string&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Cannot compile&quot;</span><span class="p">)</span>

    <span class="n">exec</span><span class="p">(</span><span class="n">code_object</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{})</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExpectError</span><span class="p">(</span><span class="ne">AssertionError</span><span class="p">):</span>
    <span class="n">compile_and_test_ast</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">,</span> <span class="n">fun_nodes</span><span class="p">,</span> <span class="n">test_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Traceback (most recent call last):
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/2588008834.py&#34;, line 2, in &lt;module&gt;
    compile_and_test_ast(fun_tree, fun_nodes, test_tree)
  File &#34;/var/folders/n2/xd9445p97rb3xh7m1dfx8_4h0006ts/T/ipykernel_56034/1107678207.py&#34;, line 14, in compile_and_test_ast
    exec(code_object, {}, {})
  File &#34;&lt;string&gt;&#34;, line 3, in &lt;module&gt;
AssertionError: My Test (expected)
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>When we run our delta debugger on the AST, this is the list of remaining nodes we obtain:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">compile_and_test_ast</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">,</span> <span class="n">fun_nodes</span><span class="p">,</span> <span class="n">test_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reduced_nodes</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()[</span><span class="s1">&#39;keep_list&#39;</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">reduced_nodes</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>57
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is the associated tree:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reduced_fun_tree</span> <span class="o">=</span> <span class="n">copy_and_reduce</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">,</span> <span class="n">reduced_nodes</span><span class="p">)</span>
<span class="n">show_ast</span><span class="p">(</span><span class="n">reduced_fun_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_image output_svg output_subarea ">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="3174pt" height="692pt" viewBox="0.00 0.00 3173.50 692.00">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 688)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-688 3169.5,-688 3169.5,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<text text-anchor="start" x="446" y="-663.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">FunctionDef</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<text text-anchor="middle" x="92.5" y="-590.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;remove_html_markup&quot;</text>
</g>
<!-- 0&#45;&#45;1 -->
<g id="edge1" class="edge">
<title>0--1</title>
<path fill="none" stroke="black" d="M492.5,-647C492.5,-647 326.53,-630.74 194.5,-612 191.39,-611.56 188.23,-611.1 185.04,-610.62"/>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<text text-anchor="start" x="211.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arguments</text>
</g>
<!-- 0&#45;&#45;2 -->
<g id="edge2" class="edge">
<title>0--2</title>
<path fill="none" stroke="black" d="M492.5,-647C492.5,-647 387.02,-632.36 304.5,-612 301.59,-611.28 298.6,-610.5 295.6,-609.67"/>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<text text-anchor="start" x="322" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;5 -->
<g id="edge5" class="edge">
<title>0--5</title>
<path fill="none" stroke="black" d="M492.5,-647C492.5,-647 423.96,-622.42 381.13,-607.06"/>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<text text-anchor="start" x="467" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;11 -->
<g id="edge11" class="edge">
<title>0--11</title>
<path fill="none" stroke="black" d="M492.5,-647C492.5,-647 492.5,-627.19 492.5,-612.03"/>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<text text-anchor="start" x="611" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 0&#45;&#45;17 -->
<g id="edge17" class="edge">
<title>0--17</title>
<path fill="none" stroke="black" d="M492.5,-647C492.5,-647 560.18,-622.56 602.74,-607.19"/>
</g>
<!-- 23 -->
<g id="node24" class="node">
<title>23</title>
<text text-anchor="start" x="922.5" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">For</text>
</g>
<!-- 0&#45;&#45;23 -->
<g id="edge23" class="edge">
<title>0--23</title>
<path fill="none" stroke="black" d="M492.5,-647C492.5,-647 812.27,-609.46 908.46,-598.17"/>
</g>
<!-- 121 -->
<g id="node122" class="node">
<title>121</title>
<text text-anchor="start" x="1277" y="-591.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Return</text>
</g>
<!-- 0&#45;&#45;121 -->
<g id="edge121" class="edge">
<title>0--121</title>
<path fill="none" stroke="black" d="M492.5,-647C492.5,-647 1116.12,-606.97 1268.98,-597.15"/>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<text text-anchor="start" x="73.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">arg</text>
</g>
<!-- 2&#45;&#45;3 -->
<g id="edge3" class="edge">
<title>2--3</title>
<path fill="none" stroke="black" d="M209.63,-575.88C179.84,-563.09 139.92,-545.94 113.72,-534.69"/>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<text text-anchor="middle" x="46.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;s&quot;</text>
</g>
<!-- 3&#45;&#45;4 -->
<g id="edge4" class="edge">
<title>3--4</title>
<path fill="none" stroke="black" d="M76.61,-503.7C70.41,-492.85 62.45,-478.92 56.27,-468.1"/>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<text text-anchor="start" x="181.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 5&#45;&#45;6 -->
<g id="edge6" class="edge">
<title>5--6</title>
<path fill="none" stroke="black" d="M330.5,-575C330.5,-575 264.15,-548.86 225.53,-533.65"/>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<text text-anchor="start" x="283.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 5&#45;&#45;9 -->
<g id="edge9" class="edge">
<title>5--9</title>
<path fill="none" stroke="black" d="M330.5,-575C330.5,-575 325.55,-555.19 321.76,-540.03"/>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<text text-anchor="middle" x="121.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 6&#45;&#45;7 -->
<g id="edge7" class="edge">
<title>6--7</title>
<path fill="none" stroke="black" d="M190.5,-503C190.5,-503 164.22,-483.19 144.09,-468.03"/>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<text text-anchor="middle" x="198.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 6&#45;&#45;8 -->
<g id="edge8" class="edge">
<title>6--8</title>
<path fill="none" stroke="black" d="M190.5,-503C190.5,-503 193.55,-483.19 195.88,-468.03"/>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<text text-anchor="middle" x="275.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 9&#45;&#45;10 -->
<g id="edge10" class="edge">
<title>9--10</title>
<path fill="none" stroke="black" d="M307.12,-503.7C300.61,-492.85 292.25,-478.92 285.76,-468.1"/>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<text text-anchor="start" x="418.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 11&#45;&#45;12 -->
<g id="edge12" class="edge">
<title>11--12</title>
<path fill="none" stroke="black" d="M489.5,-575C489.5,-575 468.93,-555.19 453.18,-540.03"/>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<text text-anchor="start" x="488.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 11&#45;&#45;15 -->
<g id="edge15" class="edge">
<title>11--15</title>
<path fill="none" stroke="black" d="M489.5,-575C489.5,-575 502.07,-555.19 511.69,-540.03"/>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<text text-anchor="middle" x="360.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 12&#45;&#45;13 -->
<g id="edge13" class="edge">
<title>12--13</title>
<path fill="none" stroke="black" d="M429.5,-503C429.5,-503 403.22,-483.19 383.09,-468.03"/>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<text text-anchor="middle" x="445.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 12&#45;&#45;14 -->
<g id="edge14" class="edge">
<title>12--14</title>
<path fill="none" stroke="black" d="M429.5,-503C429.5,-503 435.59,-483.19 440.26,-468.03"/>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<text text-anchor="middle" x="522.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 15&#45;&#45;16 -->
<g id="edge16" class="edge">
<title>15--16</title>
<path fill="none" stroke="black" d="M522.5,-503.7C522.5,-492.85 522.5,-478.92 522.5,-468.1"/>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<text text-anchor="start" x="619.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 17&#45;&#45;18 -->
<g id="edge18" class="edge">
<title>17--18</title>
<path fill="none" stroke="black" d="M645.5,-575C645.5,-575 642.07,-555.19 639.45,-540.03"/>
</g>
<!-- 21 -->
<g id="node22" class="node">
<title>21</title>
<text text-anchor="start" x="703.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 17&#45;&#45;21 -->
<g id="edge21" class="edge">
<title>17--21</title>
<path fill="none" stroke="black" d="M645.5,-575C645.5,-575 680.54,-555.19 707.38,-540.03"/>
</g>
<!-- 19 -->
<g id="node20" class="node">
<title>19</title>
<text text-anchor="middle" x="599.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 18&#45;&#45;19 -->
<g id="edge19" class="edge">
<title>18--19</title>
<path fill="none" stroke="black" d="M636.5,-503C636.5,-503 622.41,-483.19 611.62,-468.03"/>
</g>
<!-- 20 -->
<g id="node21" class="node">
<title>20</title>
<text text-anchor="middle" x="676.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 18&#45;&#45;20 -->
<g id="edge20" class="edge">
<title>18--20</title>
<path fill="none" stroke="black" d="M636.5,-503C636.5,-503 651.74,-483.19 663.4,-468.03"/>
</g>
<!-- 22 -->
<g id="node23" class="node">
<title>22</title>
<text text-anchor="middle" x="751.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&quot;</text>
</g>
<!-- 21&#45;&#45;22 -->
<g id="edge22" class="edge">
<title>21--22</title>
<path fill="none" stroke="black" d="M740.96,-503.7C743.13,-492.85 745.92,-478.92 748.08,-468.1"/>
</g>
<!-- 24 -->
<g id="node25" class="node">
<title>24</title>
<text text-anchor="start" x="881.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 23&#45;&#45;24 -->
<g id="edge24" class="edge">
<title>23--24</title>
<path fill="none" stroke="black" d="M944.5,-575C944.5,-575 926.98,-555.19 913.56,-540.03"/>
</g>
<!-- 27 -->
<g id="node28" class="node">
<title>27</title>
<text text-anchor="start" x="956.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 23&#45;&#45;27 -->
<g id="edge27" class="edge">
<title>23--27</title>
<path fill="none" stroke="black" d="M944.5,-575C944.5,-575 955.55,-555.19 964,-540.03"/>
</g>
<!-- 30 -->
<g id="node31" class="node">
<title>30</title>
<text text-anchor="start" x="1172" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 23&#45;&#45;30 -->
<g id="edge30" class="edge">
<title>23--30</title>
<path fill="none" stroke="black" d="M944.5,-575C944.5,-575 1091.44,-542.62 1153.43,-528.97"/>
</g>
<!-- 25 -->
<g id="node26" class="node">
<title>25</title>
<text text-anchor="middle" x="823.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 24&#45;&#45;25 -->
<g id="edge25" class="edge">
<title>24--25</title>
<path fill="none" stroke="black" d="M890.5,-503C890.5,-503 864.98,-483.19 845.44,-468.03"/>
</g>
<!-- 26 -->
<g id="node27" class="node">
<title>26</title>
<text text-anchor="middle" x="898.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 24&#45;&#45;26 -->
<g id="edge26" class="edge">
<title>24--26</title>
<path fill="none" stroke="black" d="M890.5,-503C890.5,-503 893.55,-483.19 895.88,-468.03"/>
</g>
<!-- 28 -->
<g id="node29" class="node">
<title>28</title>
<text text-anchor="middle" x="973.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;s&quot;</text>
</g>
<!-- 27&#45;&#45;28 -->
<g id="edge28" class="edge">
<title>27--28</title>
<path fill="none" stroke="black" d="M981.5,-503C981.5,-503 978.45,-483.19 976.12,-468.03"/>
</g>
<!-- 29 -->
<g id="node30" class="node">
<title>29</title>
<text text-anchor="middle" x="1045.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 27&#45;&#45;29 -->
<g id="edge29" class="edge">
<title>27--29</title>
<path fill="none" stroke="black" d="M981.5,-503C981.5,-503 1005.88,-483.19 1024.54,-468.03"/>
</g>
<!-- 31 -->
<g id="node32" class="node">
<title>31</title>
<text text-anchor="start" x="1099" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 30&#45;&#45;31 -->
<g id="edge31" class="edge">
<title>30--31</title>
<path fill="none" stroke="black" d="M1190.5,-503C1190.5,-503 1165.36,-483.19 1146.11,-468.03"/>
</g>
<!-- 45 -->
<g id="node46" class="node">
<title>45</title>
<text text-anchor="start" x="1211" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 30&#45;&#45;45 -->
<g id="edge45" class="edge">
<title>30--45</title>
<path fill="none" stroke="black" d="M1190.5,-503C1190.5,-503 1208.02,-483.19 1221.44,-468.03"/>
</g>
<!-- 51 -->
<g id="node52" class="node">
<title>51</title>
<text text-anchor="start" x="1491" y="-447.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 30&#45;&#45;51 -->
<g id="edge51" class="edge">
<title>30--51</title>
<path fill="none" stroke="black" d="M1190.5,-503C1190.5,-503 1396.95,-468.26 1472.35,-455.57"/>
</g>
<!-- 32 -->
<g id="node33" class="node">
<title>32</title>
<text text-anchor="middle" x="875.5" y="-374.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 31&#45;&#45;32 -->
<g id="edge32" class="edge">
<title>31--32</title>
<path fill="none" stroke="black" d="M1103.5,-431C1103.5,-431 994.09,-422.52 911.5,-396 908.6,-395.07 905.64,-393.96 902.72,-392.75"/>
</g>
<!-- 33 -->
<g id="node34" class="node">
<title>33</title>
<text text-anchor="start" x="929" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 31&#45;&#45;33 -->
<g id="edge33" class="edge">
<title>31--33</title>
<path fill="none" stroke="black" d="M1103.5,-431C1103.5,-431 1039.18,-407.93 996.22,-392.53"/>
</g>
<!-- 40 -->
<g id="node41" class="node">
<title>40</title>
<text text-anchor="start" x="1088" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 31&#45;&#45;40 -->
<g id="edge40" class="edge">
<title>31--40</title>
<path fill="none" stroke="black" d="M1103.5,-431C1103.5,-431 1108.83,-411.19 1112.92,-396.03"/>
</g>
<!-- 34 -->
<g id="node35" class="node">
<title>34</title>
<text text-anchor="start" x="782.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 33&#45;&#45;34 -->
<g id="edge34" class="edge">
<title>33--34</title>
<path fill="none" stroke="black" d="M943.5,-359C943.5,-359 882.41,-342.59 835.5,-324 832.67,-322.88 829.75,-321.64 826.86,-320.36"/>
</g>
<!-- 37 -->
<g id="node38" class="node">
<title>37</title>
<text text-anchor="middle" x="871.5" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 33&#45;&#45;37 -->
<g id="edge37" class="edge">
<title>33--37</title>
<path fill="none" stroke="black" d="M943.5,-359C943.5,-359 916.07,-339.19 895.08,-324.03"/>
</g>
<!-- 38 -->
<g id="node39" class="node">
<title>38</title>
<text text-anchor="start" x="924.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 33&#45;&#45;38 -->
<g id="edge38" class="edge">
<title>33--38</title>
<path fill="none" stroke="black" d="M943.5,-359C943.5,-359 949.21,-339.19 953.59,-324.03"/>
</g>
<!-- 35 -->
<g id="node36" class="node">
<title>35</title>
<text text-anchor="middle" x="763.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 34&#45;&#45;35 -->
<g id="edge35" class="edge">
<title>34--35</title>
<path fill="none" stroke="black" d="M799.5,-287C799.5,-287 785.79,-267.19 775.29,-252.03"/>
</g>
<!-- 36 -->
<g id="node37" class="node">
<title>36</title>
<text text-anchor="middle" x="835.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 34&#45;&#45;36 -->
<g id="edge36" class="edge">
<title>34--36</title>
<path fill="none" stroke="black" d="M799.5,-287C799.5,-287 813.21,-267.19 823.71,-252.03"/>
</g>
<!-- 39 -->
<g id="node40" class="node">
<title>39</title>
<text text-anchor="middle" x="958.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&lt;&quot;</text>
</g>
<!-- 38&#45;&#45;39 -->
<g id="edge39" class="edge">
<title>38--39</title>
<path fill="none" stroke="black" d="M958.5,-287.7C958.5,-276.85 958.5,-262.92 958.5,-252.1"/>
</g>
<!-- 41 -->
<g id="node42" class="node">
<title>41</title>
<text text-anchor="middle" x="1045.5" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 40&#45;&#45;41 -->
<g id="edge41" class="edge">
<title>40--41</title>
<path fill="none" stroke="black" d="M1109.5,-359C1109.5,-359 1085.12,-339.19 1066.46,-324.03"/>
</g>
<!-- 42 -->
<g id="node43" class="node">
<title>42</title>
<text text-anchor="start" x="1100.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 40&#45;&#45;42 -->
<g id="edge42" class="edge">
<title>40--42</title>
<path fill="none" stroke="black" d="M1109.5,-359C1109.5,-359 1112.55,-339.19 1114.88,-324.03"/>
</g>
<!-- 43 -->
<g id="node44" class="node">
<title>43</title>
<text text-anchor="middle" x="1079.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 42&#45;&#45;43 -->
<g id="edge43" class="edge">
<title>42--43</title>
<path fill="none" stroke="black" d="M1118.5,-287C1118.5,-287 1103.64,-267.19 1092.27,-252.03"/>
</g>
<!-- 44 -->
<g id="node45" class="node">
<title>44</title>
<text text-anchor="middle" x="1162.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 42&#45;&#45;44 -->
<g id="edge44" class="edge">
<title>42--44</title>
<path fill="none" stroke="black" d="M1118.5,-287C1118.5,-287 1135.26,-267.19 1148.09,-252.03"/>
</g>
<!-- 46 -->
<g id="node47" class="node">
<title>46</title>
<text text-anchor="start" x="1219.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 45&#45;&#45;46 -->
<g id="edge46" class="edge">
<title>45--46</title>
<path fill="none" stroke="black" d="M1245.5,-431C1245.5,-431 1242.07,-411.19 1239.45,-396.03"/>
</g>
<!-- 49 -->
<g id="node50" class="node">
<title>49</title>
<text text-anchor="start" x="1303.5" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 45&#45;&#45;49 -->
<g id="edge49" class="edge">
<title>45--49</title>
<path fill="none" stroke="black" d="M1245.5,-431C1245.5,-431 1280.54,-411.19 1307.38,-396.03"/>
</g>
<!-- 47 -->
<g id="node48" class="node">
<title>47</title>
<text text-anchor="middle" x="1192.5" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 46&#45;&#45;47 -->
<g id="edge47" class="edge">
<title>46--47</title>
<path fill="none" stroke="black" d="M1235.5,-359C1235.5,-359 1219.12,-339.19 1206.58,-324.03"/>
</g>
<!-- 48 -->
<g id="node49" class="node">
<title>48</title>
<text text-anchor="middle" x="1269.5" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 46&#45;&#45;48 -->
<g id="edge48" class="edge">
<title>46--48</title>
<path fill="none" stroke="black" d="M1235.5,-359C1235.5,-359 1248.45,-339.19 1258.37,-324.03"/>
</g>
<!-- 50 -->
<g id="node51" class="node">
<title>50</title>
<text text-anchor="middle" x="1344.5" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">True</text>
</g>
<!-- 49&#45;&#45;50 -->
<g id="edge50" class="edge">
<title>49--50</title>
<path fill="none" stroke="black" d="M1339.23,-359.7C1340.32,-348.85 1341.71,-334.92 1342.79,-324.1"/>
</g>
<!-- 52 -->
<g id="node53" class="node">
<title>52</title>
<text text-anchor="start" x="1474" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 51&#45;&#45;52 -->
<g id="edge52" class="edge">
<title>51--52</title>
<path fill="none" stroke="black" d="M1525.5,-431C1525.5,-431 1515.6,-411.19 1508.01,-396.03"/>
</g>
<!-- 66 -->
<g id="node67" class="node">
<title>66</title>
<text text-anchor="start" x="1725" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 51&#45;&#45;66 -->
<g id="edge66" class="edge">
<title>51--66</title>
<path fill="none" stroke="black" d="M1525.5,-431C1525.5,-431 1654.05,-401.29 1716.82,-386.78"/>
</g>
<!-- 72 -->
<g id="node73" class="node">
<title>72</title>
<text text-anchor="start" x="2268" y="-375.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 51&#45;&#45;72 -->
<g id="edge72" class="edge">
<title>51--72</title>
<path fill="none" stroke="black" d="M1525.5,-431C1525.5,-431 2114.69,-390.2 2249.33,-380.88"/>
</g>
<!-- 53 -->
<g id="node54" class="node">
<title>53</title>
<text text-anchor="middle" x="1416.5" y="-302.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 52&#45;&#45;53 -->
<g id="edge53" class="edge">
<title>52--53</title>
<path fill="none" stroke="black" d="M1499.5,-359C1499.5,-359 1467.88,-339.19 1443.68,-324.03"/>
</g>
<!-- 54 -->
<g id="node55" class="node">
<title>54</title>
<text text-anchor="start" x="1470" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 52&#45;&#45;54 -->
<g id="edge54" class="edge">
<title>52--54</title>
<path fill="none" stroke="black" d="M1499.5,-359C1499.5,-359 1499.5,-339.19 1499.5,-324.03"/>
</g>
<!-- 61 -->
<g id="node62" class="node">
<title>61</title>
<text text-anchor="start" x="1563" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 52&#45;&#45;61 -->
<g id="edge61" class="edge">
<title>52--61</title>
<path fill="none" stroke="black" d="M1499.5,-359C1499.5,-359 1534.93,-339.19 1562.05,-324.03"/>
</g>
<!-- 55 -->
<g id="node56" class="node">
<title>55</title>
<text text-anchor="start" x="1323.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 54&#45;&#45;55 -->
<g id="edge55" class="edge">
<title>54--55</title>
<path fill="none" stroke="black" d="M1484.5,-287C1484.5,-287 1423.41,-270.59 1376.5,-252 1373.67,-250.88 1370.75,-249.64 1367.86,-248.36"/>
</g>
<!-- 58 -->
<g id="node59" class="node">
<title>58</title>
<text text-anchor="middle" x="1412.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 54&#45;&#45;58 -->
<g id="edge58" class="edge">
<title>54--58</title>
<path fill="none" stroke="black" d="M1484.5,-287C1484.5,-287 1457.07,-267.19 1436.08,-252.03"/>
</g>
<!-- 59 -->
<g id="node60" class="node">
<title>59</title>
<text text-anchor="start" x="1465.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 54&#45;&#45;59 -->
<g id="edge59" class="edge">
<title>54--59</title>
<path fill="none" stroke="black" d="M1484.5,-287C1484.5,-287 1490.21,-267.19 1494.59,-252.03"/>
</g>
<!-- 56 -->
<g id="node57" class="node">
<title>56</title>
<text text-anchor="middle" x="1304.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 55&#45;&#45;56 -->
<g id="edge56" class="edge">
<title>55--56</title>
<path fill="none" stroke="black" d="M1340.5,-215C1340.5,-215 1326.79,-195.19 1316.29,-180.03"/>
</g>
<!-- 57 -->
<g id="node58" class="node">
<title>57</title>
<text text-anchor="middle" x="1376.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 55&#45;&#45;57 -->
<g id="edge57" class="edge">
<title>55--57</title>
<path fill="none" stroke="black" d="M1340.5,-215C1340.5,-215 1354.21,-195.19 1364.71,-180.03"/>
</g>
<!-- 60 -->
<g id="node61" class="node">
<title>60</title>
<text text-anchor="middle" x="1499.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&gt;&quot;</text>
</g>
<!-- 59&#45;&#45;60 -->
<g id="edge60" class="edge">
<title>59--60</title>
<path fill="none" stroke="black" d="M1499.5,-215.7C1499.5,-204.85 1499.5,-190.92 1499.5,-180.1"/>
</g>
<!-- 62 -->
<g id="node63" class="node">
<title>62</title>
<text text-anchor="middle" x="1586.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 61&#45;&#45;62 -->
<g id="edge62" class="edge">
<title>61--62</title>
<path fill="none" stroke="black" d="M1598.5,-287C1598.5,-287 1593.93,-267.19 1590.43,-252.03"/>
</g>
<!-- 63 -->
<g id="node64" class="node">
<title>63</title>
<text text-anchor="start" x="1641.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 61&#45;&#45;63 -->
<g id="edge63" class="edge">
<title>61--63</title>
<path fill="none" stroke="black" d="M1598.5,-287C1598.5,-287 1621.36,-267.19 1638.85,-252.03"/>
</g>
<!-- 64 -->
<g id="node65" class="node">
<title>64</title>
<text text-anchor="middle" x="1647.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 63&#45;&#45;64 -->
<g id="edge64" class="edge">
<title>63--64</title>
<path fill="none" stroke="black" d="M1664.5,-215C1664.5,-215 1658.02,-195.19 1653.07,-180.03"/>
</g>
<!-- 65 -->
<g id="node66" class="node">
<title>65</title>
<text text-anchor="middle" x="1730.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 63&#45;&#45;65 -->
<g id="edge65" class="edge">
<title>63--65</title>
<path fill="none" stroke="black" d="M1664.5,-215C1664.5,-215 1689.64,-195.19 1708.89,-180.03"/>
</g>
<!-- 67 -->
<g id="node68" class="node">
<title>67</title>
<text text-anchor="start" x="1733.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 66&#45;&#45;67 -->
<g id="edge67" class="edge">
<title>66--67</title>
<path fill="none" stroke="black" d="M1760.5,-359C1760.5,-359 1756.69,-339.19 1753.77,-324.03"/>
</g>
<!-- 70 -->
<g id="node71" class="node">
<title>70</title>
<text text-anchor="start" x="1836.5" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 66&#45;&#45;70 -->
<g id="edge70" class="edge">
<title>66--70</title>
<path fill="none" stroke="black" d="M1760.5,-359C1760.5,-359 1802.4,-339.19 1834.48,-324.03"/>
</g>
<!-- 68 -->
<g id="node69" class="node">
<title>68</title>
<text text-anchor="middle" x="1733.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 67&#45;&#45;68 -->
<g id="edge68" class="edge">
<title>67--68</title>
<path fill="none" stroke="black" d="M1754.5,-287C1754.5,-287 1746.5,-267.19 1740.38,-252.03"/>
</g>
<!-- 69 -->
<g id="node70" class="node">
<title>69</title>
<text text-anchor="middle" x="1810.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 67&#45;&#45;69 -->
<g id="edge69" class="edge">
<title>67--69</title>
<path fill="none" stroke="black" d="M1754.5,-287C1754.5,-287 1775.83,-267.19 1792.16,-252.03"/>
</g>
<!-- 71 -->
<g id="node72" class="node">
<title>71</title>
<text text-anchor="middle" x="1887.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">False</text>
</g>
<!-- 70&#45;&#45;71 -->
<g id="edge71" class="edge">
<title>70--71</title>
<path fill="none" stroke="black" d="M1874.7,-287.7C1877.34,-276.85 1880.72,-262.92 1883.35,-252.1"/>
</g>
<!-- 73 -->
<g id="node74" class="node">
<title>73</title>
<text text-anchor="start" x="2075" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 72&#45;&#45;73 -->
<g id="edge73" class="edge">
<title>72--73</title>
<path fill="none" stroke="black" d="M2289.5,-359C2289.5,-359 2188.65,-331.25 2134.29,-316.3"/>
</g>
<!-- 94 -->
<g id="node95" class="node">
<title>94</title>
<text text-anchor="start" x="2345" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 72&#45;&#45;94 -->
<g id="edge94" class="edge">
<title>72--94</title>
<path fill="none" stroke="black" d="M2289.5,-359C2289.5,-359 2320.35,-339.19 2343.98,-324.03"/>
</g>
<!-- 103 -->
<g id="node104" class="node">
<title>103</title>
<text text-anchor="start" x="2666" y="-303.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">If</text>
</g>
<!-- 72&#45;&#45;103 -->
<g id="edge103" class="edge">
<title>72--103</title>
<path fill="none" stroke="black" d="M2289.5,-359C2289.5,-359 2559.79,-322.49 2647.43,-310.66"/>
</g>
<!-- 74 -->
<g id="node75" class="node">
<title>74</title>
<text text-anchor="middle" x="1962.5" y="-230.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Or</text>
</g>
<!-- 73&#45;&#45;74 -->
<g id="edge74" class="edge">
<title>73--74</title>
<path fill="none" stroke="black" d="M2092.5,-287C2092.5,-287 2040.26,-269.01 1999.5,-252 1996.37,-250.69 1993.11,-249.28 1989.88,-247.84"/>
</g>
<!-- 75 -->
<g id="node76" class="node">
<title>75</title>
<text text-anchor="start" x="2016" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 73&#45;&#45;75 -->
<g id="edge75" class="edge">
<title>73--75</title>
<path fill="none" stroke="black" d="M2092.5,-287C2092.5,-287 2074.6,-267.19 2060.89,-252.03"/>
</g>
<!-- 82 -->
<g id="node83" class="node">
<title>82</title>
<text text-anchor="start" x="2130" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BoolOp</text>
</g>
<!-- 73&#45;&#45;82 -->
<g id="edge82" class="edge">
<title>73--82</title>
<path fill="none" stroke="black" d="M2092.5,-287C2092.5,-287 2116.5,-267.19 2134.87,-252.03"/>
</g>
<!-- 76 -->
<g id="node77" class="node">
<title>76</title>
<text text-anchor="start" x="1819.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 75&#45;&#45;76 -->
<g id="edge76" class="edge">
<title>75--76</title>
<path fill="none" stroke="black" d="M2018.5,-215C2018.5,-215 1935.45,-202.14 1872.5,-180 1869.63,-178.99 1866.68,-177.83 1863.77,-176.59"/>
</g>
<!-- 79 -->
<g id="node80" class="node">
<title>79</title>
<text text-anchor="middle" x="1908.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 75&#45;&#45;79 -->
<g id="edge79" class="edge">
<title>75--79</title>
<path fill="none" stroke="black" d="M2018.5,-215C2018.5,-215 1968.27,-191.25 1935.69,-175.85"/>
</g>
<!-- 80 -->
<g id="node81" class="node">
<title>80</title>
<text text-anchor="start" x="1961.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 75&#45;&#45;80 -->
<g id="edge80" class="edge">
<title>75--80</title>
<path fill="none" stroke="black" d="M2018.5,-215C2018.5,-215 2009.74,-195.19 2003.03,-180.03"/>
</g>
<!-- 77 -->
<g id="node78" class="node">
<title>77</title>
<text text-anchor="middle" x="1800.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 76&#45;&#45;77 -->
<g id="edge77" class="edge">
<title>76--77</title>
<path fill="none" stroke="black" d="M1836.5,-143C1836.5,-143 1822.79,-123.19 1812.29,-108.03"/>
</g>
<!-- 78 -->
<g id="node79" class="node">
<title>78</title>
<text text-anchor="middle" x="1872.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 76&#45;&#45;78 -->
<g id="edge78" class="edge">
<title>76--78</title>
<path fill="none" stroke="black" d="M1836.5,-143C1836.5,-143 1850.21,-123.19 1860.71,-108.03"/>
</g>
<!-- 81 -->
<g id="node82" class="node">
<title>81</title>
<text text-anchor="middle" x="1988.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;&quot;&quot;</text>
</g>
<!-- 80&#45;&#45;81 -->
<g id="edge81" class="edge">
<title>80--81</title>
<path fill="none" stroke="black" d="M1993.77,-143.7C1992.68,-132.85 1991.29,-118.92 1990.21,-108.1"/>
</g>
<!-- 83 -->
<g id="node84" class="node">
<title>83</title>
<text text-anchor="middle" x="2082.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">And</text>
</g>
<!-- 82&#45;&#45;83 -->
<g id="edge83" class="edge">
<title>82--83</title>
<path fill="none" stroke="black" d="M2157.5,-215C2157.5,-215 2128.93,-195.19 2107.06,-180.03"/>
</g>
<!-- 84 -->
<g id="node85" class="node">
<title>84</title>
<text text-anchor="start" x="2136" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Compare</text>
</g>
<!-- 82&#45;&#45;84 -->
<g id="edge84" class="edge">
<title>82--84</title>
<path fill="none" stroke="black" d="M2157.5,-215C2157.5,-215 2160.55,-195.19 2162.88,-180.03"/>
</g>
<!-- 91 -->
<g id="node92" class="node">
<title>91</title>
<text text-anchor="start" x="2231.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 82&#45;&#45;91 -->
<g id="edge91" class="edge">
<title>82--91</title>
<path fill="none" stroke="black" d="M2157.5,-215C2157.5,-215 2194.39,-193.92 2221.2,-178.6"/>
</g>
<!-- 85 -->
<g id="node86" class="node">
<title>85</title>
<text text-anchor="start" x="2043.5" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 84&#45;&#45;85 -->
<g id="edge85" class="edge">
<title>84--85</title>
<path fill="none" stroke="black" d="M2160.5,-143C2160.5,-143 2117.18,-120.47 2087.56,-105.07"/>
</g>
<!-- 88 -->
<g id="node89" class="node">
<title>88</title>
<text text-anchor="middle" x="2132.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Eq</text>
</g>
<!-- 84&#45;&#45;88 -->
<g id="edge88" class="edge">
<title>84--88</title>
<path fill="none" stroke="black" d="M2160.5,-143C2160.5,-143 2149.83,-123.19 2141.67,-108.03"/>
</g>
<!-- 89 -->
<g id="node90" class="node">
<title>89</title>
<text text-anchor="start" x="2185.5" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Constant</text>
</g>
<!-- 84&#45;&#45;89 -->
<g id="edge89" class="edge">
<title>84--89</title>
<path fill="none" stroke="black" d="M2160.5,-143C2160.5,-143 2182.97,-123.19 2200.18,-108.03"/>
</g>
<!-- 86 -->
<g id="node87" class="node">
<title>86</title>
<text text-anchor="middle" x="2024.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 85&#45;&#45;86 -->
<g id="edge86" class="edge">
<title>85--86</title>
<path fill="none" stroke="black" d="M2060.5,-71C2060.5,-71 2046.79,-51.19 2036.29,-36.03"/>
</g>
<!-- 87 -->
<g id="node88" class="node">
<title>87</title>
<text text-anchor="middle" x="2096.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 85&#45;&#45;87 -->
<g id="edge87" class="edge">
<title>85--87</title>
<path fill="none" stroke="black" d="M2060.5,-71C2060.5,-71 2074.21,-51.19 2084.71,-36.03"/>
</g>
<!-- 90 -->
<g id="node91" class="node">
<title>90</title>
<text text-anchor="middle" x="2219.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;'&quot;</text>
</g>
<!-- 89&#45;&#45;90 -->
<g id="edge90" class="edge">
<title>89--90</title>
<path fill="none" stroke="black" d="M2219.5,-71.7C2219.5,-60.85 2219.5,-46.92 2219.5,-36.1"/>
</g>
<!-- 92 -->
<g id="node93" class="node">
<title>92</title>
<text text-anchor="middle" x="2309.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 91&#45;&#45;92 -->
<g id="edge92" class="edge">
<title>91--92</title>
<path fill="none" stroke="black" d="M2271.5,-143C2271.5,-143 2285.97,-123.19 2297.06,-108.03"/>
</g>
<!-- 93 -->
<g id="node94" class="node">
<title>93</title>
<text text-anchor="middle" x="2384.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 91&#45;&#45;93 -->
<g id="edge93" class="edge">
<title>91--93</title>
<path fill="none" stroke="black" d="M2271.5,-143C2271.5,-143 2314.39,-123.8 2348.5,-108 2351.38,-106.66 2354.4,-105.26 2357.39,-103.85"/>
</g>
<!-- 95 -->
<g id="node96" class="node">
<title>95</title>
<text text-anchor="start" x="2353.5" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 94&#45;&#45;95 -->
<g id="edge95" class="edge">
<title>94--95</title>
<path fill="none" stroke="black" d="M2380.5,-287C2380.5,-287 2376.69,-267.19 2373.77,-252.03"/>
</g>
<!-- 98 -->
<g id="node99" class="node">
<title>98</title>
<text text-anchor="start" x="2462" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 94&#45;&#45;98 -->
<g id="edge98" class="edge">
<title>94--98</title>
<path fill="none" stroke="black" d="M2380.5,-287C2380.5,-287 2422.78,-267.19 2455.15,-252.03"/>
</g>
<!-- 96 -->
<g id="node97" class="node">
<title>96</title>
<text text-anchor="middle" x="2331.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 95&#45;&#45;96 -->
<g id="edge96" class="edge">
<title>95--96</title>
<path fill="none" stroke="black" d="M2371.5,-215C2371.5,-215 2356.26,-195.19 2344.6,-180.03"/>
</g>
<!-- 97 -->
<g id="node98" class="node">
<title>97</title>
<text text-anchor="middle" x="2416.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 95&#45;&#45;97 -->
<g id="edge97" class="edge">
<title>95--97</title>
<path fill="none" stroke="black" d="M2371.5,-215C2371.5,-215 2388.64,-195.19 2401.77,-180.03"/>
</g>
<!-- 99 -->
<g id="node100" class="node">
<title>99</title>
<text text-anchor="middle" x="2491.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 98&#45;&#45;99 -->
<g id="edge99" class="edge">
<title>98--99</title>
<path fill="none" stroke="black" d="M2499.5,-215C2499.5,-215 2496.45,-195.19 2494.12,-180.03"/>
</g>
<!-- 100 -->
<g id="node101" class="node">
<title>100</title>
<text text-anchor="start" x="2546.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 98&#45;&#45;100 -->
<g id="edge100" class="edge">
<title>98--100</title>
<path fill="none" stroke="black" d="M2499.5,-215C2499.5,-215 2523.88,-195.19 2542.54,-180.03"/>
</g>
<!-- 101 -->
<g id="node102" class="node">
<title>101</title>
<text text-anchor="middle" x="2480.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;quote&quot;</text>
</g>
<!-- 100&#45;&#45;101 -->
<g id="edge101" class="edge">
<title>100--101</title>
<path fill="none" stroke="black" d="M2555.5,-143C2555.5,-143 2526.93,-123.19 2505.06,-108.03"/>
</g>
<!-- 102 -->
<g id="node103" class="node">
<title>102</title>
<text text-anchor="middle" x="2563.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 100&#45;&#45;102 -->
<g id="edge102" class="edge">
<title>100--102</title>
<path fill="none" stroke="black" d="M2555.5,-143C2555.5,-143 2558.55,-123.19 2560.88,-108.03"/>
</g>
<!-- 104 -->
<g id="node105" class="node">
<title>104</title>
<text text-anchor="start" x="2645" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">UnaryOp</text>
</g>
<!-- 103&#45;&#45;104 -->
<g id="edge104" class="edge">
<title>103--104</title>
<path fill="none" stroke="black" d="M2685.5,-287C2685.5,-287 2681.31,-267.19 2678.1,-252.03"/>
</g>
<!-- 109 -->
<g id="node110" class="node">
<title>109</title>
<text text-anchor="start" x="2801" y="-231.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Assign</text>
</g>
<!-- 103&#45;&#45;109 -->
<g id="edge109" class="edge">
<title>103--109</title>
<path fill="none" stroke="black" d="M2685.5,-287C2685.5,-287 2751.01,-262.84 2792.73,-247.46"/>
</g>
<!-- 105 -->
<g id="node106" class="node">
<title>105</title>
<text text-anchor="middle" x="2638.5" y="-158.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Not</text>
</g>
<!-- 104&#45;&#45;105 -->
<g id="edge105" class="edge">
<title>104--105</title>
<path fill="none" stroke="black" d="M2674.5,-215C2674.5,-215 2660.79,-195.19 2650.29,-180.03"/>
</g>
<!-- 106 -->
<g id="node107" class="node">
<title>106</title>
<text text-anchor="start" x="2693.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 104&#45;&#45;106 -->
<g id="edge106" class="edge">
<title>104--106</title>
<path fill="none" stroke="black" d="M2674.5,-215C2674.5,-215 2688.21,-195.19 2698.71,-180.03"/>
</g>
<!-- 107 -->
<g id="node108" class="node">
<title>107</title>
<text text-anchor="middle" x="2638.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;tag&quot;</text>
</g>
<!-- 106&#45;&#45;107 -->
<g id="edge107" class="edge">
<title>106--107</title>
<path fill="none" stroke="black" d="M2703.5,-143C2703.5,-143 2678.74,-123.19 2659.78,-108.03"/>
</g>
<!-- 108 -->
<g id="node109" class="node">
<title>108</title>
<text text-anchor="middle" x="2713.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 106&#45;&#45;108 -->
<g id="edge108" class="edge">
<title>106--108</title>
<path fill="none" stroke="black" d="M2703.5,-143C2703.5,-143 2707.31,-123.19 2710.23,-108.03"/>
</g>
<!-- 110 -->
<g id="node111" class="node">
<title>110</title>
<text text-anchor="start" x="2809.5" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 109&#45;&#45;110 -->
<g id="edge110" class="edge">
<title>109--110</title>
<path fill="none" stroke="black" d="M2837.5,-215C2837.5,-215 2833.31,-195.19 2830.1,-180.03"/>
</g>
<!-- 113 -->
<g id="node114" class="node">
<title>113</title>
<text text-anchor="start" x="2955" y="-159.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">BinOp</text>
</g>
<!-- 109&#45;&#45;113 -->
<g id="edge113" class="edge">
<title>109--113</title>
<path fill="none" stroke="black" d="M2837.5,-215C2837.5,-215 2905.84,-189.43 2946.68,-174.16"/>
</g>
<!-- 111 -->
<g id="node112" class="node">
<title>111</title>
<text text-anchor="middle" x="2788.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 110&#45;&#45;111 -->
<g id="edge111" class="edge">
<title>110--111</title>
<path fill="none" stroke="black" d="M2826.5,-143C2826.5,-143 2812.03,-123.19 2800.94,-108.03"/>
</g>
<!-- 112 -->
<g id="node113" class="node">
<title>112</title>
<text text-anchor="middle" x="2865.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Store</text>
</g>
<!-- 110&#45;&#45;112 -->
<g id="edge112" class="edge">
<title>110--112</title>
<path fill="none" stroke="black" d="M2826.5,-143C2826.5,-143 2841.36,-123.19 2852.73,-108.03"/>
</g>
<!-- 114 -->
<g id="node115" class="node">
<title>114</title>
<text text-anchor="start" x="2923.5" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 113&#45;&#45;114 -->
<g id="edge114" class="edge">
<title>113--114</title>
<path fill="none" stroke="black" d="M2982.5,-143C2982.5,-143 2966.5,-123.19 2954.25,-108.03"/>
</g>
<!-- 117 -->
<g id="node118" class="node">
<title>117</title>
<text text-anchor="middle" x="3012.5" y="-86.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Add</text>
</g>
<!-- 113&#45;&#45;117 -->
<g id="edge117" class="edge">
<title>113--117</title>
<path fill="none" stroke="black" d="M2982.5,-143C2982.5,-143 2993.93,-123.19 3002.68,-108.03"/>
</g>
<!-- 118 -->
<g id="node119" class="node">
<title>118</title>
<text text-anchor="start" x="3067.5" y="-87.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 113&#45;&#45;118 -->
<g id="edge118" class="edge">
<title>113--118</title>
<path fill="none" stroke="black" d="M2982.5,-143C2982.5,-143 3027.22,-120.2 3057.43,-104.8"/>
</g>
<!-- 115 -->
<g id="node116" class="node">
<title>115</title>
<text text-anchor="middle" x="2883.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 114&#45;&#45;115 -->
<g id="edge115" class="edge">
<title>114--115</title>
<path fill="none" stroke="black" d="M2936.5,-71C2936.5,-71 2916.31,-51.19 2900.85,-36.03"/>
</g>
<!-- 116 -->
<g id="node117" class="node">
<title>116</title>
<text text-anchor="middle" x="2958.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 114&#45;&#45;116 -->
<g id="edge116" class="edge">
<title>114--116</title>
<path fill="none" stroke="black" d="M2936.5,-71C2936.5,-71 2944.88,-51.19 2951.3,-36.03"/>
</g>
<!-- 119 -->
<g id="node120" class="node">
<title>119</title>
<text text-anchor="middle" x="3066.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;c&quot;</text>
</g>
<!-- 118&#45;&#45;119 -->
<g id="edge119" class="edge">
<title>118--119</title>
<path fill="none" stroke="black" d="M3088.5,-71C3088.5,-71 3080.12,-51.19 3073.7,-36.03"/>
</g>
<!-- 120 -->
<g id="node121" class="node">
<title>120</title>
<text text-anchor="middle" x="3138.5" y="-14.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 118&#45;&#45;120 -->
<g id="edge120" class="edge">
<title>118--120</title>
<path fill="none" stroke="black" d="M3088.5,-71C3088.5,-71 3107.55,-51.19 3122.13,-36.03"/>
</g>
<!-- 122 -->
<g id="node123" class="node">
<title>122</title>
<text text-anchor="start" x="1557.5" y="-519.3" font-family="Courier,monospace" font-weight="bold" font-size="14.00" fill="#004080">Name</text>
</g>
<!-- 121&#45;&#45;122 -->
<g id="edge122" class="edge">
<title>121--122</title>
<path fill="none" stroke="black" d="M1336.13,-584.35C1390.71,-570.3 1497.5,-542.82 1547.49,-529.95"/>
</g>
<!-- 123 -->
<g id="node124" class="node">
<title>123</title>
<text text-anchor="middle" x="1574.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">&quot;out&quot;</text>
</g>
<!-- 122&#45;&#45;123 -->
<g id="edge123" class="edge">
<title>122--123</title>
<path fill="none" stroke="black" d="M1582.5,-503C1582.5,-503 1579.45,-483.19 1577.12,-468.03"/>
</g>
<!-- 124 -->
<g id="node125" class="node">
<title>124</title>
<text text-anchor="middle" x="1649.5" y="-446.3" font-family="Courier,monospace" font-size="14.00" fill="#008040">Load</text>
</g>
<!-- 122&#45;&#45;124 -->
<g id="edge124" class="edge">
<title>122--124</title>
<path fill="none" stroke="black" d="M1582.5,-503C1582.5,-503 1608.02,-483.19 1627.56,-468.03"/>
</g>
</g>
</svg>

</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And this is its textual representation:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_content</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">reduced_fun_tree</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):
    tag = <span class="ansi-blue-fg">False</span>
    quote = <span class="ansi-blue-fg">False</span>
    out = <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#39;</span>
    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> (<span class="ansi-magenta-fg">not</span> quote):
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">and</span> (<span class="ansi-magenta-fg">not</span> quote):
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span> <span class="ansi-magenta-fg">or</span> (c == <span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span> <span class="ansi-magenta-fg">and</span> tag):
            quote = <span class="ansi-magenta-fg">not</span> quote
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c
    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">tests</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_text output_subarea output_execute_result">
<pre>310
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>We see that some code was deleted – notably the assertion at the end – but otherwise, our deletion strategy was not particularly effective. This is because in Python, one cannot simply delete the single statement in a controlled body – this raises a syntax error. One would have to replace it with <code>pass</code> (or some other statement with no effect) to stay syntactically valid. Still, the syntax-based reduction would still single out <code>remove_html_markup()</code> from the <code>Assertions</code> source code – and do so even faster, as it would apply on one definition (rather than one line) after another.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h4 id="Transforming-Nodes">Transforming Nodes<a class="anchor-link" href="#Transforming-Nodes">&#182;</a></h4><p>To further boost our syntactic reduction strategy, we implement a set of additional reduction operators. First, as already discussed, we do not simply delete an assignment, but we replace it with a <code>pass</code> statement. To obtain the tree for <code>pass</code>, we simply parse it and access the subtree.</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeReducer</span><span class="p">(</span><span class="n">NodeReducer</span><span class="p">):</span>
    <span class="n">PASS_TREE</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;pass&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">visit_Assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Assign</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">marked</span><span class="p">:</span>
            <span class="c1"># Replace by pass</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">PASS_TREE</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>In a similar vein, we can replace comparison operators with <code>False</code>:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeReducer</span><span class="p">(</span><span class="n">NodeReducer</span><span class="p">):</span>
    <span class="n">FALSE_TREE</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;False&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">visit_Compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">Compare</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">marked</span><span class="p">:</span>
            <span class="c1"># Replace by False</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">FALSE_TREE</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>If we have a Boolean operator, we attempt to replace it with its left operand:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeReducer</span><span class="p">(</span><span class="n">NodeReducer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_BoolOp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">BoolOp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AST</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">marked</span><span class="p">:</span>
            <span class="c1"># Replace by left operator</span>
            <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>And if we find an <code>If</code> clause, we attempt to replace it by its body:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NodeReducer</span><span class="p">(</span><span class="n">NodeReducer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">visit_If</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">AST</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">ast</span><span class="o">.</span><span class="n">stmt</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">marked</span><span class="p">:</span>
            <span class="c1"># Replace by body</span>
            <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">body</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Let us try to reduce our code with these additional reducers enabled:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">DeltaDebugger</span><span class="p">()</span> <span class="k">as</span> <span class="n">dd</span><span class="p">:</span>
    <span class="n">compile_and_test_ast</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">,</span> <span class="n">fun_nodes</span><span class="p">,</span> <span class="n">test_tree</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This is the reduced code we get. We see that all references to <code>quote</code> have gone, as has the handling of single quotes – none of this is relevant for the failure:</p>
</div>
</div>
</div>
</div>

<div class="input_code">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reduced_nodes</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">min_args</span><span class="p">()[</span><span class="s1">&#39;keep_list&#39;</span><span class="p">]</span>
<span class="n">reduced_fun_tree</span> <span class="o">=</span> <span class="n">copy_and_reduce</span><span class="p">(</span><span class="n">fun_tree</span><span class="p">,</span> <span class="n">reduced_nodes</span><span class="p">)</span>
<span class="n">print_content</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">unparse</span><span class="p">(</span><span class="n">reduced_fun_tree</span><span class="p">),</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div></div>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-fg">def</span> <span class="ansi-green-fg">remove_html_markup</span>(s):
    tag = <span class="ansi-blue-fg">False</span>
    <span class="ansi-blue-fg">pass</span>
    out = <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#39;</span>
    <span class="ansi-blue-fg">for</span> c <span class="ansi-magenta-fg">in</span> s:
        <span class="ansi-blue-fg">if</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&lt;</span><span class="ansi-yellow-fg">&#39;</span>:
            tag = <span class="ansi-blue-fg">True</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&gt;</span><span class="ansi-yellow-fg">&#39;</span>:
            tag = <span class="ansi-blue-fg">False</span>
        <span class="ansi-blue-fg">elif</span> c == <span class="ansi-yellow-fg">&#39;</span><span class="ansi-yellow-fg">&#34;</span><span class="ansi-yellow-fg">&#39;</span>:
            <span class="ansi-blue-fg">pass</span>
        <span class="ansi-blue-fg">elif</span> <span class="ansi-magenta-fg">not</span> tag:
            out = out + c
    <span class="ansi-blue-fg">return</span> out
</pre>
</div>

</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>Again, the best insights come from comparing this reduced version to the original implementation – and we learn that the problem is not related to the <code>quote</code> variable, or to the handling of single quotes; the problem is simply that when the input contains double quotes, these are not added to the final string.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>With our reduction code, however, we only touch the surface of what could actually be possible. So far, we implement exactly one reduction per node – but of course, there are many alternatives an expression or statement could be reduced to. We will explore some of these in the <a href="#Exercises">exercises</a>, below; also be sure to check out the <a href="#Background">background</a> on code reduction.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Lessons-Learned">Lessons Learned<a class="anchor-link" href="#Lessons-Learned">&#182;</a></h2><ul>
<li>Reducing failure-inducing inputs to a minimum is helpful for testing and debugging.</li>
<li><em>Delta debugging</em> is a simple and robust algorithm to easily reduce inputs of test cases, as well as their code.</li>
<li>Precisely specifying failure conditions helps avoiding false diagnoses.</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Next-Steps">Next Steps<a class="anchor-link" href="#Next-Steps">&#182;</a></h2><p>Our next chapter focuses on <a href="ChangeDebugger.html">finding <em>failure-inducing code changes</em></a>, using delta debugging and version control systems.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Background">Background<a class="anchor-link" href="#Background">&#182;</a></h2><p>The "lexical" delta debugging algorithm discussed here – both in its simplifying <code>ddmin</code> as well as in its general <code>dd</code> form – stem from [<a href="https://doi.org/10.1109/32.988498">Zeller <em>et al</em>, 2002</a>]; actually, <code>ddmin</code> is the exact Python implementation as used by Zeller in 2002. The <code>ddmax</code> variant was first evaluated in [<a href="https://publications.cispa.saarland/3060/">Kirschner <em>et al</em>, 2020</a>]. This chapter is the first to show how both <code>ddmin</code> and <code>ddmax</code> can be implemented as small variations of <code>dd</code>.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The idea of systematically reducing inputs has been discovered a number of times, although not as  automatic and generic as delta debugging. [<a href="https://www.microsoft.com/en-us/research/publication/massive-stochastic-testing-of-sql/">Slutz <em>et al</em>, 1998</a>], for instance, discusses systematic reduction of SQL statements for SQL databases; the general process as manual work is well described by [Kernighan <em>et al</em>, 1999].</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>The deficits of delta debugging as it comes to syntactically complex inputs were first discussed in <em>compiler testing</em>, and <em>reducing tree inputs</em> rather than string inputs was quickly discovered as an alternative.  <em>Hierarchical Delta Debugging</em> (<em>HDD</em>) [<a href="https://doi.org/10.1145/1134285.1134307">Misherghi <em>et al</em>, 2006</a>] applies delta debugging on subtrees of a parse tree, systematically reducing a parse tree to a minimum.  <em>Generalized Tree Reduction</em> [<a href="http://dl.acm.org/citation.cfm?id=3155562.3155669">Herfert <em>et al</em>, 2017</a>] generalizes this idea to apply arbitrary <em>patterns</em> such as replacing a term by a compatible term in a subtree.  Using <em>grammars</em> to reduce inputs was first implemented in the <em>Perses</em> tool [<a href="https://doi.org/10.1145/3180155.3180236">Sun <em>et al</em>, 2018</a>]. <a href="https://www.fuzzingbook.org/html/Reducer.html#Grammar-Based-Input-Reduction">A Python implementation of grammar-based input reduction</a> is part of "The Fuzzing Book".</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>While applying delta debugging to code lines does a decent job, <em>syntactic</em> and especially <em>language-specific</em> approaches can do a much better job for the programming language at hand:</p>
<ul>
<li><p><em>C-Reduce</em> [<a href="https://doi.org/10.1145/2254064.2254104">Regehr <em>et al</em>, 2012</a>] is a reducer specifically targeting the reduction of programming languages.  Besides reductions in the style of delta debugging or tree transformations, C-Reduce comes with more than 30 source-to-source transformations that replace aggregates by scalars, remove function parameters at a definition and all call sites, change functions to return <code>void</code> and deleting all <code>return</code> statements, and many more.  While specifically instantiated for the C language (and used for testing C compilers), these principles extend to arbitrary programming languages following an ALGOL-like syntax.</p>
</li>
<li><p>Kalhauge and Palsberg [<a href="https://doi.org/10.1145/3338906.3338956">Kalhauge <em>et al</em>, 2019</a>] introduce <em>binary reduction of dependency graphs</em>, a general solution for reducing arbitrary inputs with dependencies. Their <em>J-Reduce</em> tool specifically targets Java programs, and again is much faster than delta debugging and achieves a higher reduction rate.</p>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><p>This <a href="https://www.drmaciver.com/2019/01/notes-on-test-case-reduction/">blog post</a> by David McIver contains lots of insights on how to apply reduction in practice, in particular multiple runs with different abstraction levels.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h2 id="Exercises">Exercises<a class="anchor-link" href="#Exercises">&#182;</a></h2><p>How to best reduce inputs is still an underdeveloped field of research, with lots of opportunities.</p>
</div>
</div>
</div>
</div>

<div class="input_markdown">
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><h3 id="Exercise-1:-Advanced-Syntactic-Code-Reduction">Exercise 1: Advanced Syntactic Code Reduction<a class="anchor-link" href="#Exercise-1:-Advanced-Syntactic-Code-Reduction">&#182;</a></h3><p>Extend the code in <a href="#Transforming-Nodes">"Transforming Nodes"</a> such that <em>multiple</em> reduction possibilities for a node are being considered. For instance:</p>
<ul>
<li>Replace a <code>BoolOp</code> node by <code>True</code>.</li>
<li>Replace a <code>BoolOp</code> node by <code>False</code>.</li>
<li>Replace a <code>BoolOp</code> node by its left operand.</li>
<li>Replace a <code>BoolOp</code> node by its right operand.</li>
</ul>
<p>or:</p>
<ul>
<li>Replace an <code>If</code> node by its "then" body.</li>
<li>Replace an <code>If</code> node by its "else" body.</li>
</ul>
<p>or:</p>
<ul>
<li>Replace all instances of a variable by a constant.</li>
</ul>
<p>or:</p>
<ul>
<li>Replace expressions by a constant.</li>
</ul>
<p>Have a look at the <a href="http://docs.python.org/3/library/ast">official Python <code>ast</code> reference</a> for a list of nodes (and some ideas on what to replace them by). The documentation <a href="https://greentreesnakes.readthedocs.io/en/latest/">"Green Tree Snakes - the missing Python AST docs"</a> provides an excellent introduction on visitors and transformers. Make copious use of AST visualization and tests to ensure your syntax trees are still correct.</p>
<p>Strategy-wise, you should first create a list of <em>possible</em> reductions; and then pass to Delta Debugging a "keep list" of reductions that should <em>not</em> be applied. When Delta Debugging minimizes this list, it will apply as many reductions as possible.</p>

    
<p><div class="solution_link"><a href="https://mybinder.org/v2/gh/uds-se/debuggingbook/master?filepath=docs/beta/notebooks/DeltaDebugger.ipynb#Exercises" target=_blank>Use the notebook</a> to work on the exercises and see solutions.</div></p>
</div>
</div>
</div>
</div>

        
<p class="imprint">
<img style="float:right" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Creative Commons License">
The content of this project is licensed under the
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target=_blank>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
The source code that is part of the content, as well as the source code used to format and display that content is licensed under the <a href="https://github.com/uds-se/debuggingbook/blob/master/LICENSE.md#mit-license">MIT License</a>.
<a href="https://github.com/uds-se/debuggingbook/commits/master/notebooks/DeltaDebugger.ipynb" target=_blank)>Last change: 2021-10-13 13:04:07+02:00</a> &bull; 
<a href="#citation" id="cite" onclick="revealCitation()">Cite</a> &bull;
<a href="https://cispa.de/en/impressum" target=_blank>Imprint</a>
</p>

<script>
function revealCitation() {
    var c = document.getElementById("citation");
    c.style.display = "block";
}
</script>

<div id="citation" class="citation" style="display: none;">
<a name="citation"></a>
<h2>How to Cite this Work</h2>
<p>
Andreas Zeller: "<a href="https://www.debuggingbook.org/beta/html/DeltaDebugger.html">Reducing Failure-Inducing Inputs</a>".  In Andreas Zeller, "<a href="https://www.debuggingbook.org/beta/">The Debugging Book</a>", <a href="https://www.debuggingbook.org/beta/html/DeltaDebugger.html">https://www.debuggingbook.org/beta/html/DeltaDebugger.html</a>.  Retrieved 2021-10-13 13:04:07+02:00.
</p>
<pre>
@incollection{debuggingbook2021:DeltaDebugger,
    author = {Andreas Zeller},
    booktitle = {The Debugging Book},
    title = {Reducing Failure-Inducing Inputs},
    year = {2021},
    publisher = {CISPA Helmholtz Center for Information Security},
    howpublished = {\url{https://www.debuggingbook.org/beta/html/DeltaDebugger.html}},
    note = {Retrieved 2021-10-13 13:04:07+02:00},
    url = {https://www.debuggingbook.org/beta/html/DeltaDebugger.html},
    urldate = {2021-10-13 13:04:07+02:00}
}
</pre>
</div>

      </div>
    </div>
    </article>

 </body>

</html>